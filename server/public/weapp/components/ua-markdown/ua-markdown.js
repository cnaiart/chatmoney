"use strict";const e=require("../../common/vendor.js"),t=require("./lib/markdown-it.min.js"),l=require("../../hooks/useCopy.js"),n=require("./customLink/index.js");Math||s();const s=()=>"../../uni_modules/mp-html/components/mp-html/mp-html.js",r={__name:"ua-markdown",props:{content:String,showLine:{type:[Boolean,String],default:!0}},emits:["click-link"],setup(s,{emit:r}){const o=s,a=[],i=t.mt({html:!0,breaks:!0,typographer:!0,linkify:!0,lineNumbers:!0,highlight:function(t,l){let n="";try{n=e.common.highlightAuto(t).value}catch(c){n=i.utils.escapeHtml(t)}let s=n.split(/\n/).slice(0,-1).map(((e,t)=>""==e?"":'<li><span class="line-num" data-line="'+(t+1)+'"></span>'+e+"</li>")).join("");s=o.showLine?'<ol style="padding: 0px 30px;">'+s+"</ol>":'<ol style="padding: 0px 7px;list-style:none;">'+s+"</ol>",a.push(t);let r='<div class="markdown-wrap">';return r+='<div class="copy-line" style="text-align: right;font-size: 12px; margin-bottom: -10px;border-radius: 5px 5px 0 0;">',r+=`${l}<a class="code-copy-btn" code-data-index="${a.length-1}">复制代码</a>`,r+="</div>",r+=`<pre class="hljs" style="padding:10px 8px;margin:5px 0;overflow: auto;display: block;border-radius: 5px;"><code>${s}</code></pre>`,r+="</div>",r}});i.use(e.markdownItKatex),i.use(n.customLinkPlugin);const c=e=>{if(!e)return;let t="";if((e=(e=e.replace(/<br>|<br\/>|<br \/>/g,"\n")).replace(/&nbsp;/g," ")).split("```").length%2){let l=e;"\n"!=l[l.length-1]&&(l+="\n"),t=i.render(l)}else t=i.render(e);return t=t.replace(/<table/g,'<table class="table"'),t=t.replace(/<tr/g,'<tr class="tr"'),t=t.replace(/<th>/g,'<th class="th">'),t=t.replace(/<td/g,'<td class="td"'),t=t.replace(/<hr>|<hr\/>|<hr \/>/g,'<hr class="hr">'),t},p=e=>{const{"code-data-index":t,class:n,innerText:s}=e;switch(n){case"code-copy-btn":{const{copy:e}=l.useCopy();console.log(a[t]),e(a[t]);break}case"markdown-custom-link":r("click-link",s)}};return(t,l)=>({a:e.o(p),b:e.p({selectable:!0,scrollTable:!0,content:c(s.content)})})}};wx.createComponent(r);
