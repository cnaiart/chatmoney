"use strict";const e=require("../../../common/vendor.js"),t=require("../../../hooks/useCopy.js"),u=require("../../../stores/user.js"),s=require("../../../api/draw.js"),a=require("../../../api/square.js"),r=require("../../../enums/appEnums.js");if(require("../../../api/user.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../enums/constantEnums.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../utils/auth.js"),require("../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-loading")+e.resolveComponent("u-image")+e.resolveComponent("u-icon")+e.resolveComponent("u-button")+e.resolveComponent("page-status"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-loading/u-loading.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+o+(()=>"../../../components/page-status/page-status.js"))();const o=()=>"../../components/draw-poster/draw-poster.js",i=e.defineComponent({__name:"draw_detail",setup(o){const i={1:"文生图",2:"图生图",3:"选中放大",4:"选中变换"},{copy:n}=t.useCopy(),l=e.useRoute(),p=e.useRouter(),m=u.useUserStore(),c=e.ref(r.PageStatusEnum.LOADING),v=e.ref({id:-1,task_id:"",prompt:"",prompt_en:"",prompt_desc:"",prompt_other:"",status:3,image:"",image_base:"",thumbnail:"",model:"",image_url:"",image_id:-1,scale:"",able_actions:null,fail_reason:"",negative_prompt:"",version:"",style:"",engine:"",quality:"",censor_status:-1,create_time:"",loras:[],type:1,complex_params:""}),d=e.reactive({id:""}),g=e.shallowRef(),_=e.ref(!1),q=e.computed((()=>{var e,t,u;return(null==(t=null==(e=v.value)?void 0:e.complex_params)?void 0:t.length)?JSON.parse(null==(u=v.value)?void 0:u.complex_params):{}})),j=async()=>{if(m.isLogin)try{await a.drawSquareCollect({records_id:d.id,status:v.value.is_collect?0:1}),v.value.is_collect=v.value.is_collect?0:1}catch(t){console.error(t),e.index.$u.toast(JSON.stringify(t))}else p.navigateTo("/pages/login/login")};return e.onLoad((async()=>{const e=l.query.id;await(async e=>{try{const t=await s.drawRecordDetail({id:e});t.loras=JSON.parse(t.loras),v.value=t,c.value=r.PageStatusEnum.NORMAL}catch(t){c.value=r.PageStatusEnum.ERROR}})(e),d.id=l.query.collectId})),(t,u)=>{var s,a;return e.e({a:t.$theme.navColor,b:t.$theme.navBgColor,c:t.$theme.pageStyle,d:e.p({"back-text":"绘画详情"}),e:e.p({mode:"circle",color:t.$theme.primaryColor,size:"40"}),f:e.p({src:v.value.image,width:"100%",height:"100%",mode:"widthFix","border-radius":"30"}),g:e.o((t=>e.unref(n)(v.value.prompt_en))),h:e.t(v.value.prompt),i:e.o((t=>e.unref(n)(v.value.negative_prompt))),j:e.t(v.value.negative_prompt||"未填写"),k:e.t(null==(a=null==(s=e.unref(m))?void 0:s.userInfo)?void 0:a.nickname),l:e.t(v.value.create_time),m:e.t(i[v.value.type]),n:e.t(v.value.engine),o:e.t(v.value.loras.join("、")),p:e.t(v.value.scale),q:e.t(e.unref(q).step||"-"),r:e.t(e.unref(q).cfg_scale||"-"),s:e.t(e.unref(q).sampler_name||"-"),t:e.t(e.unref(q).seed||"-"),v:d.id},d.id?{w:e.n(v.value.is_collect?"praise-entry":"praise-leave"),x:e.o(j),y:e.p({name:"photo",size:"42"}),z:e.o((e=>(async e=>{m.isLogin?(_.value=!0,setTimeout((()=>{g.value.open(e)}),300)):p.navigateTo("/pages/login/login")})(v.value))),A:e.p({type:"primary",size:"default",customStyle:{padding:"0 30rpx",height:"82rpx",width:"300rpx",margin:"0"}})}:{},{B:_.value},_.value?{C:e.sr(g,"d57ee576-6,d57ee576-0",{k:"posterRef"}),D:e.o((e=>_.value=!1))}:{},{E:e.p({status:c.value})})}}}),n=e._export_sfc(i,[["__scopeId","data-v-d57ee576"]]);wx.createPage(n);
