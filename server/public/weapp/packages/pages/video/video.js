"use strict";const e=require("../../../common/vendor.js"),o=require("../../../api/video.js"),t=require("../../../stores/app.js"),s=require("../../../hooks/useLockFn.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/app.js"),require("../../../api/shop.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("router-navigate")+e.resolveComponent("u-navbar")+e.resolveComponent("u-form")+e.resolveComponent("u-button")+e.resolveComponent("tabbar"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+i+n+r+u+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../components/tabbar/tabbar.js"))();const n=()=>"./components/prompt.js",r=()=>"./components/video-size.js",u=()=>"./components/video-style.js",i=()=>"./components/uploader-picture.js",a=e.defineComponent({__name:"video",setup(n){const r=e.useRouter(),u=e.useRoute(),i=e.shallowRef(),a=t.useAppStore(),p=e.ref([{mode:1,name:"文生视频"},{mode:2,name:"图生视频"}]),l=e.reactive({type:1,prompt:"",scale:"1:1",image:"",style_id:[],channel:""}),m=e.ref({model:{},style:[],example:{}}),c=e.computed((()=>m.value.model[l.channel]||{})),{lockFn:d,isLock:v}=s.useLockFn((async()=>{try{if(!l.prompt)return e.index.$u.toast("请输入"+(1===l.type?"视频场景":"描述词"));if(2===l.type&&!l.image)return e.index.$u.toast("请上传参考图");await o.postVideoGenerate({...l}),l.prompt="",l.style_id=[],l.image="",r.navigateTo("/packages/pages/video_list/video_list")}catch(t){}}));return(async()=>{m.value=await o.getVideoConfig(),l.channel=m.value.channel})(),e.onLoad((()=>{e.index.$on("videoRegenerate",(e=>{Object.assign(l,e)}));const o=u.query;try{const e=JSON.parse(o.data);Object.assign(l,e)}catch(t){}})),(o,t)=>e.e({a:o.$theme.navColor,b:o.$theme.navBgColor,c:o.$theme.pageStyle,d:e.p({name:"clock",size:32}),e:e.p({to:"/packages/pages/video_list/video_list"}),f:e.p({"back-text":"视频"}),g:e.f(p.value,((o,t,s)=>({a:e.t(o.name),b:o.mode,c:Number(l.type)===o.mode?1:"",d:e.o((e=>l.type=o.mode),o.mode)}))),h:2===l.type},2===l.type?{i:e.o((e=>l.image=e)),j:e.p({modelValue:l.image})}:{},{k:e.o((e=>l.prompt=e)),l:e.p({type:l.type,config:m.value.example,showTranslate:!!m.value.translate_switch,modelValue:l.prompt}),m:e.o((e=>l.scale=e)),n:e.p({modelValue:l.scale}),o:m.value.style.length},m.value.style.length?{p:e.o((e=>l.style_id=e)),q:e.p({"style-list":m.value.style,modelValue:l.style_id})}:{},{r:e.sr(i,"72107fad-3",{k:"uFormRef"}),s:e.p({model:l,"label-position":"top","border-bottom":!1}),t:m.value.is_member},m.value.is_member?{}:e.unref(c).price>0?{w:e.t(e.unref(c).price),x:e.t(e.unref(a).getTokenUnit)}:{},{v:e.unref(c).price>0,y:e.o(e.unref(d)),z:e.p({type:"primary",loading:e.unref(v)})})}});wx.createPage(a);
