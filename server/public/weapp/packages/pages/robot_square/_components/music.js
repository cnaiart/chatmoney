"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../common/assets.js"),r=require("../../../../api/square.js"),s=require("../../../../api/task_reward.js"),a=require("../../../../stores/user.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../router/index.js"),require("../../../../utils/cache.js"),require("../../../../enums/constantEnums.js"),require("../../../../config/index.js"),require("../../../../utils/client.js"),require("../../../../enums/appEnums.js"),require("../../../../api/user.js"),require("../../../../utils/auth.js"),require("../../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js"))();const t=e.defineComponent({__name:"music",props:{keyword:null},setup(t){const u=t,o=e.useRouter(),n=a.useUserStore(),l=e.ref([]),c=e.shallowRef(),d=e.reactive({lists:[],current:""}),p=async(e,i)=>{var s,a;try{const{lists:a=[]}=await r.getMusicSquare({keyword:u.keyword,style_id:d.current,page_size:i,page_no:e});null==(s=c.value)||s.complete(a)}catch(t){null==(a=c.value)||a.complete(!1)}},m=()=>{var e;null==(e=c.value)||e.refresh()};return e.watch((()=>d.current),(()=>{m()})),e.watchDebounced((()=>u.keyword),(e=>{m()}),{debounce:500,immediate:!1}),(async()=>{d.lists=await s.getMusicStyle(),d.lists.unshift({name:"全部",id:""})})(),(s,a)=>({a:e.f(d.lists,((i,r,s)=>({a:e.t(i.name),b:i.id===d.current?1:"",c:i.id,d:e.o((e=>d.current=i.id),i.id)}))),b:e.f(l.value,((i,s,a)=>{var t,l;return e.e({a:"e5a64ea9-1-"+a+",e5a64ea9-0",b:e.p({src:i.image_url,width:"100%",height:"340",mode:"aspectFill","border-radius":"15"}),c:e.t(i.duration),d:e.n(i.is_collect?"praise-entry":"praise-leave"),e:e.o((e=>(async e=>{n.isLogin?(await r.musicSquareCollect({records_id:e.id,status:e.is_collect?0:1}),0===d.current?m():e.is_collect=e.is_collect?0:1):o.navigateTo("/pages/login/login")})(i)),i.id),f:e.t(null==i?void 0:i.title),g:null==(t=null==i?void 0:i.user_info)?void 0:t.name},(null==(l=null==i?void 0:i.user_info)?void 0:l.name)?{h:"e5a64ea9-2-"+a+",e5a64ea9-0",i:e.p({src:i.user_info.image,width:"40",height:"40","border-radius":"50"}),j:e.t(i.user_info.name)}:{},{k:i.id,l:e.o((e=>(async e=>{n.isLogin||o.navigateTo("/pages/login/login"),o.navigateTo({path:"/packages/pages/music_player/music_player",query:{id:e.records_id,style_id:d.current,keyword:u.keyword}})})(i)),i.id)})})),c:i._imports_0$4,d:e.sr(c,"e5a64ea9-0",{k:"pagingRef"}),e:e.o(p),f:e.o((e=>l.value=e)),g:e.p({"auto-show-back-to-top":!0,fixed:!1,"auto-clean-list-when-reload":!0,"auto-scroll-to-top-when-reload":!1,modelValue:l.value})})}}),u=e._export_sfc(t,[["__scopeId","data-v-e5a64ea9"]]);wx.createComponent(u);
