import{_ as A}from"./index.a47f7f49.js";import{h as H,a as J,m as O,a7 as P,dc as j,j as f,d as T}from"./entry.dfbfd4fd.js";import{E as q}from"./index.17567b0d.js";/* empty css                     */import{k as X,a as _,s as Z,b as I,H as m,I as g,J as o,X as y,V as b,u as l,e as C,U as F,a7 as G,R as U,$ as K,at as Q,Z as V,ag as W,ah as Y}from"./swiper-vue.2eb6bd20.js";import{u as ee}from"./asyncData.eaddccf2.js";import{c as te}from"./chat.01f4dab8.js";import{_ as oe}from"./_plugin-vue_export-helper.c27b6911.js";const k=u=>(W("data-v-fcf65801"),u=u(),Y(),u),se={class:"bg-body rounded-[12px] w-[330px] h-full flex flex-col"},ae={class:"flex-1 min-h-0"},ne={class:"px-[15px] py-[15px]"},le=k(()=>o("h3",{class:"font-bold"},[o("span",null,"帮我生成"),o("span",{class:"text-error"},"*")],-1)),re={class:"mt-[10px] flex"},ce={class:"mt-[15px]"},ie={class:"flex"},de=k(()=>o("h3",{class:"font-bold mr-auto"},[o("span",null,"需求描述")],-1)),ue={class:"px-[15px] pb-[15px]"},pe=k(()=>o("span",{class:"text-base font-bold"},"生成思维导图",-1)),fe={key:0,class:"text-sm ml-[10px]"},_e={key:1,class:"text-sm ml-[10px]"},me=X({__name:"control-panel",emits:["update","history","refresh"],setup(u,{expose:B,emit:w}){const L=H(),p=J(),c=O(),i=_(""),s=_(""),x=Z(null),r=_(!1),{data:n,refresh:R}=ee(()=>j(),{lazy:!0,default(){return{}}},"$UJscNzO9rO"),h=_(-1),E=()=>{var e;const t=(e=n.value.example_content)==null?void 0:e.length;if(t){let a=Math.round(Math.random()*(t-1));h.value===a&&(a<t-1?a++:a--),h.value=a}};I(n,()=>{!s.value&&E()}),I(h,t=>{if(!n.value.example_content)return;const e=n.value.example_content[t];e&&(s.value=e)});const M=()=>{c.isLogin||c.toggleShowLogin()};let d=null;const N=async()=>{if(!c.isLogin)return c.toggleShowLogin();if(!i.value)return f.msgError("请输入内容");r.value||(r.value=!0,d=te({type:4,question:i.value}),s.value="",d.addEventListener("chat",({data:t})=>{const{data:e,index:a}=t;s.value+=e}),d.addEventListener("finish",({data:t})=>{const{data:e,index:a}=t;e&&(s.value+=e)}),d.addEventListener("close",async()=>{R(),w("refresh"),await c.getUser(),setTimeout(async()=>{r.value=!1,S()},600)}),d.addEventListener("error",async t=>{var e;if(((e=t.data)==null?void 0:e.code)===1100){p.getIsShowRecharge?(await f.confirm(`${p.getTokenUnit}数量已用完，请前往充值`),L.push("/user/recharge")):f.msgError(`${p.getTokenUnit}数量已用完。请联系客服增加`);return}t.errorType==="connectError"&&f.msgError("请求失败，请重试"),setTimeout(()=>{r.value=!1},200)}))},S=()=>{var t,e;(e=x.value)==null||e.scrollTo({top:(t=x.value)==null?void 0:t.scrollHeight})};return P(s,async t=>{setTimeout(()=>{w("update",t)},500),r.value&&S()},{throttle:500}),B({changDescInput(t){s.value=t}}),(t,e)=>{const a=A,z=T,D=q,$=T;return m(),g("div",se,[o("div",ae,[y(D,null,{default:b(()=>[o("div",ne,[o("div",null,[o("div",null,[le,o("div",re,[y(a,{modelValue:l(i),"onUpdate:modelValue":e[0]||(e[0]=v=>C(i)?i.value=v:null),maxlength:"99999",rows:7,clearable:!0,"show-word-limit":!1,customStyle:{paddingBottom:"24px"},placeholder:"请输入简单描述，AI将智能输出markdown内容",onClick:M},null,8,["modelValue"])])]),o("div",ce,[o("div",ie,[de,l(n).is_example?(m(),F(z,{key:0,link:"",type:"primary",onClick:E},{default:b(()=>[G(" 试试示例 ")]),_:1})):U("",!0)]),K(o("textarea",{ref_key:"textareaRef",ref:x,"onUpdate:modelValue":e[1]||(e[1]=v=>C(s)?s.value=v:null),class:"bg-page h-[400px] w-full mt-[10px] rounded-[12px] p-[10px] resize-none border-[1px] border-solid border-[transparent] focus:border-primary"},null,512),[[Q,l(s)]])])])])]),_:1})]),o("div",ue,[y($,{size:"large",type:"primary",class:"w-full !border-none",onClick:N,loading:l(r)},{default:b(()=>[pe,l(n).member_free?(m(),g("span",fe," 会员免费 ")):l(n).balance>0?(m(),g("span",_e," 消耗 "+V(l(n).balance)+" "+V(l(p).getTokenUnit),1)):U("",!0)]),_:1},8,["loading"])])])}}});const Ee=oe(me,[["__scopeId","data-v-fcf65801"]]);export{Ee as default};
