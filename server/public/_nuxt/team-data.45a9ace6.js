import{E as ae}from"./index.5de6b9f9.js";import{_ as ne}from"./index.vue.c62cb732.js";import{E as ie}from"./index.e979a1ab.js";import{E as re,a as ce}from"./el-table-column.ac121129.js";import{_ as de}from"./index.vue.7f39d825.js";import{E as me}from"./index.828bffd0.js";import{h as pe,d as T,m as ue,j as ve}from"./entry.dfbfd4fd.js";/* empty css                  *//* empty css               *//* empty css                    *//* empty css                  *//* empty css                   *//* empty css                 */import"./el-tooltip.4ed993c7.js";/* empty css                     */import{k as fe,a as v,l as M,r as A,s as _e,E as be,H as a,I as k,J as o,Z as D,U as c,V as s,a7 as g,u as m,R as x,X as l,Y as E,ag as he,ah as ke}from"./swiper-vue.2eb6bd20.js";import{g as ge,d as xe,p as ye,t as we}from"./knowledge.51dee290.js";import Ce from"./add-user.5c7dd7b3.js";import N from"./permission-option.93bf8c8e.js";import{E as J}from"./index.76d1875c.js";import{E as Te}from"./index.6c069afb.js";import{_ as Ee}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.8ad94f19.js";import"./isUndefined.aa0326a0.js";import"./index.17567b0d.js";import"./_baseIteratee.5e0c38c1.js";import"./isEqual.0df0ab2c.js";import"./_getTag.83294aff.js";import"./debounce.8cbe4cfc.js";import"./index.071e9281.js";import"./dropdown.cd5c481a.js";import"./usePaging.b2b97b82.js";import"./useLockFn.619a13da.js";import"./index.deef7dcf.js";import"./use-dialog.7d399731.js";import"./refs.cabac943.js";const I=f=>(he("data-v-c7524e81"),f=f(),ke(),f),Ie=["onClick"],Ve=I(()=>o("div",{class:"text-xl font-bold"},"我的团队",-1)),Se={class:"flex justify-between items-center py-2"},Pe={class:"flex items-center"},Ue={class:"flex items-center"},$e={key:0},Me=["onClick"],Ae=["onClick"],De=I(()=>o("span",{class:"text-base mr-1"},"成员",-1)),Ne=["onClick"],Oe=["onClick"],Re=I(()=>o("span",{class:"text-base mr-1"},"成员",-1)),ze={key:3,class:"text-base"},Be={class:"flex items-center"},je={key:0},Le={class:"cursor-pointer"},He=["onClick"],Je={class:"text-base mr-1"},Xe={key:2,class:"text-base"},Ye=I(()=>o("div",{class:"w-full text-left"},[o("div",{class:"text-lg font-medium"},"成员处理方式")],-1)),Ze={class:"flex justify-end"},qe=fe({__name:"team-data",props:{id:{type:Number,default:0}},setup(f){const X=f,Y={1:"可管理",2:"可编辑",3:"可查看"},O=pe(),V=v(X.id),y=v([]),i=M(()=>y.value.find(t=>t.sn===ue().userInfo.sn)||{}),w=v(null),_=v(!1),p=v("all"),S=v(!1),R=A({sn:-1}),z=_e(),b=async()=>{y.value=await ge({kb_id:V.value})},Z=()=>{d.visible=!1,u.visible=!1},q=()=>{var t;(t=z.value)==null||t.show()},d=A({visible:!1,memberId:""}),B=t=>{d.visible=!d.visible,d.memberId=t.id.toString()},j=t=>d.visible&&d.memberId===t.id.toString(),L=async t=>{try{await ve.confirm("确定删除该成员？","删除成员"),await xe({id:t.id}),i.value.sn===t.sn&&setTimeout(()=>{O.back()},1e3),b()}finally{d.visible=!1}},u=A({visible:!1,memberId:""}),F=t=>{u.visible=!0,u.memberId=t.id.toString(),w.value=t.power},G=t=>u.visible&&u.memberId===t.id.toString(),P=async(t,n)=>{w.value=n,await ye({id:t.id,power:n}),u.visible=!1,b()},K=t=>{R.sn=t.sn,_.value=!0},Q=async()=>{S.value=!0,await we({sn:R.sn,kb_id:V.value,type:p.value}),S.value=!1,p.value==="kb"?setTimeout(()=>{O.back()},1e3):(_.value=!1,b())},H=t=>Y[t]||"未知权限",C=M(()=>i.value.power===1),W=M(()=>i.value.owned===1),ee=t=>t.sn!==i.value.sn&&C.value;return be(()=>{b()}),(t,n)=>{const te=ae,se=ne,oe=ie,h=re,U=de,$=me,le=ce;return a(),k("div",{class:"flex flex-col min-h-0 h-full p-5",onClick:E(Z,["stop"])},[Ve,o("div",Se,[o("div",null,"团队成员(共"+D(y.value.length)+"人)",1),i.value.owned===1?(a(),c(m(T),{key:0,type:"primary",plain:"",onClick:q},{default:s(()=>[g(" + 添加成员 ")]),_:1})):x("",!0)]),l(le,{class:"mt-4 cursor-pointer flex-1 min-h-0",data:y.value,size:"large",height:"100%","row-class-name":"h-[70px]"},{default:s(()=>[l(h,{label:"成员信息",prop:"name","min-width":"160"},{default:s(({row:e})=>[o("div",Pe,[l(te,{src:e.avatar,size:"26",class:"flex-none"},null,8,["src"]),l(se,{class:"ml-2",content:e.nickname,teleported:!0,effect:"light"},null,8,["content"]),e.sn===i.value.sn?(a(),c(oe,{key:0,type:"primary",size:"small",class:"ml-2"},{default:s(()=>[g(" 我 ")]),_:1})):x("",!0)])]),_:1}),l(h,{label:"成员角色",prop:"role","min-width":"160"},{default:s(({row:e})=>[o("div",Ue,[e.owned===1?(a(),k("div",$e,"所有者")):C.value&&i.value.sn!==e.sn?(a(),c($,{key:1,placement:"bottom",width:180,trigger:"click","show-arrow":!1,transition:"custom-popover",visible:j(e)},{reference:s(()=>[o("div",{class:"flex items-center cursor-pointer",onClick:E(r=>B(e),["stop"])},[De,l(U,{name:"el-icon-ArrowDown"})],8,Ae)]),default:s(()=>[o("div",{class:"flex items-center leading-10 cursor-pointer hover:bg-page px-2 rounded text-error",onClick:r=>L(e)}," 移出团队 ",8,Me)]),_:2},1032,["visible"])):i.value.power>=1&&i.value.sn===e.sn?(a(),c($,{key:2,placement:"bottom",width:180,trigger:"click","show-arrow":!1,transition:"custom-popover",visible:j(e)},{reference:s(()=>[o("div",{class:"flex items-center cursor-pointer",onClick:E(r=>B(e),["stop"])},[Re,l(U,{name:"el-icon-ArrowDown"})],8,Oe)]),default:s(()=>[o("div",{class:"flex items-center leading-10 cursor-pointer hover:bg-page px-2 rounded text-error",onClick:r=>L(e)}," 退出团队 ",8,Ne)]),_:2},1032,["visible"])):(a(),k("div",ze,"成员"))])]),_:1}),l(h,{label:"默认权限",prop:"permissions","min-width":"160"},{default:s(({row:e})=>[o("div",Be,[e.owned===1?(a(),k("div",je,"全部")):C.value?(a(),c($,{key:1,placement:"bottom-end",width:390,trigger:"click","show-arrow":!1,transition:"custom-popover",visible:G(e)},{reference:s(()=>[o("div",{class:"flex items-center cursor-pointer",onClick:E(r=>F(e),["stop"])},[o("span",Je,D(H(e.power)),1),l(U,{name:"el-icon-ArrowDown"})],8,He)]),default:s(()=>[o("div",Le,[l(N,{label:"可编辑",description:"只能操作数据学习，增删改查自己的数据，不能修改他人",value:2,"model-value":w.value,onChange:r=>P(e,2)},null,8,["model-value","onChange"]),l(N,{label:"可查看",description:"查看知识库所有数据",value:3,"model-value":w.value,onChange:r=>P(e,3)},null,8,["model-value","onChange"]),C.value?(a(),c(N,{key:0,label:"可管理",description:"管理整个知识库数据和信息",value:1,"model-value":e.power,onChange:r=>P(e,1)},null,8,["model-value","onChange"])):x("",!0)])]),_:2},1032,["visible"])):(a(),k("div",Xe,D(H(e.power)),1))])]),_:1}),l(h,{label:"加入时间",prop:"create_time","min-width":"150"}),W.value?(a(),c(h,{key:0,label:"操作","min-width":"200",fixed:"right"},{default:s(({row:e})=>[ee(e)?(a(),c(m(T),{key:0,type:"primary",link:"",onClick:r=>K(e)},{default:s(()=>[g(" 转移所有权 ")]),_:2},1032,["onClick"])):x("",!0)]),_:1})):x("",!0)]),_:1},8,["data"]),l(Ce,{ref_key:"addUserModal",ref:z,id:V.value,onSuccess:b},null,8,["id"]),l(m(Te),{modelValue:_.value,"onUpdate:modelValue":n[3]||(n[3]=e=>_.value=e),width:"450px",class:"!rounded-[12px]",center:"",draggable:"","destroy-on-close":"","close-on-click-modal":"false"},{header:s(()=>[Ye]),footer:s(()=>[o("div",Ze,[l(m(T),{onClick:n[2]||(n[2]=e=>_.value=!1)},{default:s(()=>[g("取消")]),_:1}),l(m(T),{type:"primary",loading:S.value,onClick:Q},{default:s(()=>[g("确认 ")]),_:1},8,["loading"])])]),default:s(()=>[o("div",null,[l(m(J),{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=e=>p.value=e),"true-value":"all",label:"同步转移所有者的所有成员。",size:"large"},null,8,["modelValue"]),l(m(J),{modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=e=>p.value=e),"true-value":"kb",label:"不同步转移所有者的所有成员，只转移知识库。",size:"large"},null,8,["modelValue"])])]),_:1},8,["modelValue"])],8,Ie)}}});const Ut=Ee(qe,[["__scopeId","data-v-c7524e81"]]);export{Ut as default};
