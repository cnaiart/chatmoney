import{_ as te}from"./index.vue.7f39d825.js";import{E as oe}from"./index.8ad94f19.js";import{a as se,m as le,E as ne,d as M,j as b}from"./entry.dfbfd4fd.js";import{E as ie,a as re}from"./index.883ed08b.js";import{E as ae}from"./index.828bffd0.js";import{_ as ce}from"./index.a47f7f49.js";import{E as me}from"./el-switch.48cb994a.js";import{E as pe}from"./el-image-viewer.d5621b18.js";import{E as de}from"./index.17567b0d.js";import"./el-tooltip.4ed993c7.js";/* empty css                  */import"./el-form-item.4ed993c7.js";/* empty css                   *//* empty css                *//* empty css                     */import{u as _e}from"./asyncData.eaddccf2.js";import{u as U}from"./useLockFn.619a13da.js";import{g as ue,p as fe,a as xe}from"./music.f06b2c3d.js";import{k as he,a as $,s as ye,r as ve,l as w,b as ge,H as i,I as a,J as o,S as C,aj as V,u as t,X as n,V as l,Z as c,U as u,R as h,a7 as I,T as B,ag as ke,ah as be}from"./swiper-vue.2eb6bd20.js";import{_ as we}from"./_plugin-vue_export-helper.c27b6911.js";import"./isUndefined.aa0326a0.js";import"./castArray.c741e965.js";import"./_baseClone.20563df6.js";import"./_getTag.83294aff.js";import"./dropdown.cd5c481a.js";import"./throttle.d40f833a.js";import"./debounce.8cbe4cfc.js";import"./position.4bcf7430.js";const f=y=>(ke("data-v-30a57f21"),y=y(),be(),y),Ee={class:"h-full py-[16px] bg-body w-[350px] rounded-[12px] flex flex-col"},Se={class:"px-[16px]"},Ce={class:"bg-page p-[8px] flex rounded-[10px]"},Ve=["onClick"],Ie={class:"mr-[5px]"},Fe={class:"flex"},Le={class:"flex-1 min-h-0"},ze={class:"p-[16px]"},Me=f(()=>o("span",{class:"font-bold text-tx-primary"},"歌曲名称",-1)),Ue={class:"flex-1"},$e={class:"inline-flex w-[96%]"},Be={class:"flex-1 mr-auto flex items-center"},Te={class:"font-bold text-tx-primary mr-[8px]"},je={class:"flex items-center cursor-pointer text-[#999999]"},Re={class:"flex-1"},De={class:"flex p-[10px]"},Ne={class:"flex-1"},qe=f(()=>o("span",null," 智能联想 ",-1)),Ge={key:0},Ae=f(()=>o("span",{class:"font-bold text-tx-primary"}," 选择版本 ",-1)),Pe=f(()=>o("span",{class:"font-bold text-tx-primary"}," 纯音乐 ",-1)),Qe={class:"w-full flex items-center"},He=f(()=>o("span",{class:"font-bold text-tx-primary flex-1"}," 音乐风格 ",-1)),Je={key:0,class:"flex-1 min-w-0 flex flex-wrap mx-[-6px]"},Oe=["onClick"],We={class:"pt-[100%] relative h-0 rounded-[12px] overflow-hidden"},Xe={class:"absolute inset-0 left-0 top-0"},Ze={key:0,class:"absolute bg-[var(--el-overlay-color-lighter)] inset-0 left-0 top-0 flex items-center justify-center text-white"},Ke={class:"text-center text-xs"},Ye={class:"px-[16px] pt-[16px]"},et=f(()=>o("span",{class:"text-base font-bold"},"立即生成",-1)),tt={key:0,class:"text-sm ml-[4px]"},ot={key:1,class:"text-sm ml-[4px] font-normal"},st=he({__name:"index",emits:["update"],setup(y,{emit:T}){const F=se(),v=le(),j=$([{mode:0,name:"灵感模式",tips:"只需输入一段歌曲描述，即可生成一首歌"},{mode:1,name:"歌词模式",tips:"输入自己的歌词，即可生成一首歌"}]),R=ye(),e=ve({channel:"go_api",custom_mode:0,title:"",prompt:"",style_id:[],is_style_custom:0,make_instrumental:0,style_custom:"",version:""}),D=()=>{e.is_style_custom=e.is_style_custom?0:1};$(8);const N=m=>{const r=e.style_id.findIndex(_=>_===m);r!==-1?e.style_id.splice(r,1):e.style_id.push(m)},p=w(()=>e.custom_mode===0),q=w(()=>({title:[{required:!0,message:"请输入歌曲名称"}],prompt:[{required:!0,message:`请输入${p.value?"歌曲描述":"歌词"}`}],version:[{required:!0,message:"请选择版本"}]})),E=()=>{v.isLogin||v.toggleShowLogin()},{data:d,refresh:G}=_e(()=>ue(),{default(){return{model:{},style:[],imagine:{}}},lazy:!0},"$MBLbBPlEM9");ge(d,m=>{e.channel=m.channel,e.version||(e.version=Object.keys(g.value.version)[0]||"")});const A=w(()=>!p.value&&d.value.imagine.status),g=w(()=>d.value.model[e.channel]||{}),{lockFn:P,isLock:Q}=U(async()=>{if(!e.title)return b.msgError("请输入歌曲名称");const m=await fe({prompt:e.title});v.getUser(),e.prompt=m.content}),{lockFn:H,isLock:J}=U(async()=>{try{if(!e.title)return b.msgError("请输入歌曲名称");if(!e.prompt)return b.msgError(`请输入${p.value?"歌曲描述":"歌词"}`);if(!e.version)return b.msgError("请选择版本");await xe({...e,style_id:e.is_style_custom?[]:e.style_id}),e.prompt="",e.title="",e.style_id=[],e.style_custom="",v.getUser(),G(),T("update")}catch{}finally{}});return(m,r)=>{const _=te,O=oe,W=ne,x=ie,X=ae,L=M,S=M,z=ce,Z=me,K=pe,Y=re,ee=de;return i(),a("div",Ee,[o("div",Se,[o("div",Ce,[(i(!0),a(C,null,V(t(j),s=>(i(),a("div",{class:B(["flex-1 flex items-center justify-center cursor-pointer py-[7px] text-tx-regular rounded-[10px]",{"!bg-primary !text-white":t(e).custom_mode===s.mode}]),key:s.mode,onClick:k=>t(e).custom_mode=s.mode},[o("span",Ie,c(s.name),1),n(O,{content:s.tips,placement:"bottom",effect:"light",teleported:!0},{default:l(()=>[o("span",Fe,[n(_,{name:"el-icon-QuestionFilled"})])]),_:2},1032,["content"])],10,Ve))),128))])]),o("div",Le,[n(ee,null,{default:l(()=>[o("div",ze,[n(Y,{ref_key:"formRef",ref:R,model:t(e),"label-position":"top",rules:t(q),"show-message":!1},{default:l(()=>[n(x,{prop:"title"},{label:l(()=>[Me]),default:l(()=>[o("div",Ue,[n(W,{class:"custom-input",modelValue:t(e).title,"onUpdate:modelValue":r[0]||(r[0]=s=>t(e).title=s),size:"large",placeholder:"给你的歌曲起个好听的名字",onFocus:E},null,8,["modelValue"])])]),_:1}),n(x,{prop:"prompt"},{label:l(()=>[o("div",$e,[o("div",Be,[o("span",Te,c(t(p)?"歌曲描述":"歌词"),1),t(p)?h("",!0):(i(),u(X,{key:0,placement:"right","show-arrow":!1,transition:"custom-popover",width:200,trigger:"hover",content:"建议歌词长度100-1250，太长或太短容易生成失败"},{reference:l(()=>[o("div",je,[n(_,{name:"el-icon-QuestionFilled",size:14})])]),_:1}))]),n(L,{link:"",size:"small",onClick:r[1]||(r[1]=s=>t(e).prompt="")},{icon:l(()=>[n(_,{name:"el-icon-Delete",size:12})]),default:l(()=>[I(" 清空 ")]),_:1})])]),default:l(()=>[o("div",Re,[n(z,{modelValue:t(e).prompt,"onUpdate:modelValue":r[2]||(r[2]=s=>t(e).prompt=s),placeholder:`请输入${t(p)?"灵感，例如写一首关于夏天的歌曲":"歌词"}`,contentStyle:{height:"160px"},showWordLimit:"",maxlength:"1300",onFocus:E},{"length-suffix":l(()=>[o("div",De,[o("div",Ne,[t(A)?(i(),u(S,{key:0,size:"small",type:"primary",plain:"",style:{border:"none","--el-button-hover-bg-color":`var(
                                                            --el-button-bg-color
                                                        )`,"--el-button-hover-text-color":`var(
                                                            --el-button-text-color
                                                        )`},loading:t(Q),onClick:t(P)},{icon:l(()=>[n(_,{name:"local-icon-bulb",size:12})]),default:l(()=>[qe,t(d).imagine.price>0?(i(),a("span",Ge,"：消耗"+c(t(d).imagine.price)+c(t(F).getTokenUnit),1)):h("",!0)]),_:1},8,["loading","onClick"])):h("",!0)])])]),_:1},8,["modelValue","placeholder"])])]),_:1}),n(x,{prop:"version"},{label:l(()=>[Ae]),default:l(()=>[o("div",null,[(i(!0),a(C,null,V(t(g).version,(s,k)=>(i(),u(S,{key:s,class:B({"!text-primary !border-primary":t(e).version===String(k)}),onClick:lt=>t(e).version=String(k)},{default:l(()=>[I(c(s),1)]),_:2},1032,["class","onClick"]))),128))])]),_:1}),t(p)?(i(),u(x,{key:0},{label:l(()=>[Pe]),default:l(()=>[o("div",null,[n(Z,{modelValue:t(e).make_instrumental,"onUpdate:modelValue":r[3]||(r[3]=s=>t(e).make_instrumental=s),"active-value":1,"inactive-value":0},null,8,["modelValue"])])]),_:1})):(i(),u(x,{key:1},{label:l(()=>[o("div",Qe,[He,n(L,{link:"",type:"primary",onClick:D},{default:l(()=>[I(c(t(e).is_style_custom?"系统风格":"自定义风格"),1)]),_:1})])]),default:l(()=>[t(e).is_style_custom?(i(),u(z,{key:1,modelValue:t(e).style_custom,"onUpdate:modelValue":r[4]||(r[4]=s=>t(e).style_custom=s),placeholder:"请输入自定义风格，多个风格以,隔开",contentStyle:{height:"120px"},onFocus:E},null,8,["modelValue"])):(i(),a("div",Je,[(i(!0),a(C,null,V(t(d).style,s=>(i(),a("div",{class:"w-[25%] px-[6px]",key:s.id},[o("div",{class:"h-full cursor-pointer",onClick:k=>N(s.id)},[o("div",We,[o("div",Xe,[n(K,{src:s.image,class:"h-full w-full"},null,8,["src"])]),t(e).style_id.includes(s.id)?(i(),a("div",Ze,[n(_,{name:"el-icon-SuccessFilled",size:20})])):h("",!0)]),o("div",Ke,c(s.name),1)],8,Oe)]))),128))]))]),_:1}))]),_:1},8,["model","rules"])])]),_:1})]),o("div",Ye,[n(S,{size:"large",class:"w-full",type:"primary",loading:t(J),onClick:t(H)},{default:l(()=>[o("div",null,[et,t(d).is_member?(i(),a("span",tt,"会员免费")):t(g).price>0?(i(),a("span",ot," 消耗 "+c(t(g).price)+" "+c(t(F).getTokenUnit),1)):h("",!0)])]),_:1},8,["loading","onClick"])])])}}});const Ut=we(st,[["__scopeId","data-v-30a57f21"]]);export{Ut as default};
