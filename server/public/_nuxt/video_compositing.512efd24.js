import{m as Z,h as G,a0 as K,cU as O,j as C,cV as Q,cI as W,d as R,E as Y,v as ee}from"./entry.dfbfd4fd.js";import{_ as te}from"./nuxt-link.42058260.js";import{_ as oe}from"./index.vue.7f39d825.js";import{E as se,a as ne}from"./el-table-column.ac121129.js";import{_ as ae,a as ie}from"./file.598d0601.js";import{E as le}from"./el-progress.8f5e9f30.js";import{_ as re}from"./index.vue.e0bcb29b.js";import{E as ce}from"./index.17567b0d.js";/* empty css                    *//* empty css               *//* empty css                 */import"./el-tooltip.4ed993c7.js";/* empty css                  *//* empty css                     */import{u as de}from"./usePaging.b2b97b82.js";import{a as me}from"./file.a6a074d0.js";import{k as _e,r as U,a as pe,aa as ue,b as fe,j as he,H as l,I as p,X as t,V as o,J as n,Z as u,u as s,a7 as d,$ as ge,U as f,R as v,S as ke,e as ve,n as ye}from"./swiper-vue.2eb6bd20.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./index.8ad94f19.js";import"./isUndefined.aa0326a0.js";import"./_baseIteratee.5e0c38c1.js";import"./isEqual.0df0ab2c.js";import"./_getTag.83294aff.js";import"./debounce.8cbe4cfc.js";import"./index.76d1875c.js";import"./index.071e9281.js";import"./el-image-viewer.d5621b18.js";import"./throttle.d40f833a.js";import"./position.4bcf7430.js";import"./index.f647f618.js";import"./___vite-browser-external.5512611b.js";import"./index.9c8f8f3a.js";import"./index.6c069afb.js";import"./use-dialog.7d399731.js";import"./refs.cabac943.js";/* empty css                  */import"./el-pagination.7a6b3d1c.js";import"./el-select.b7a2650e.js";import"./index.e979a1ab.js";import"./strings.ceb81673.js";import"./castArray.c741e965.js";const xe={class:"h-full"},be={class:"p-main"},Ce={class:"bg-white rounded-lg p-[20px]"},Ve={class:"border-b border-solid border-br-light pb-[10px]"},we=n("span",{class:"text-2xl font-medium"},"视频合成",-1),Ee={class:"text-tx-secondary ml-[10px]"},$e={class:"py-main"},Se={class:"flex items-center flex-wrap"},Be={class:"flex-1"},Re=["href"],Ue={class:"flex-none flex"},Ie={class:"flex-1 min-h-0"},Te={class:"flex items-center"},De={class:"ml-2"},Fe={key:0},Ne={key:1,class:"text-warning"},Le={key:2,class:"text-success"},Pe=["onClick"],je=["href"],ze={class:"flex justify-end mt-4"},Bt=_e({__name:"video_compositing",async setup(qe){let V,w;const E=Z();G();const h=U({show:!1,url:""}),y=U({keyword:""}),{pager:r,getLists:m,resetPage:I}=de({fetchFun:O,params:y}),x=pe([]),T=a=>{x.value=a.map(i=>i.id)},$=async a=>{await C.confirm("确定要删除？"),await Q({ids:a}),m()},D=async(a,i)=>{const{value:g}=await C.prompt("修改视频名称","",{inputValue:i});await W({name:g,id:a}),m()},F=K(()=>{I()},1e3),N=a=>{C.confirm(`错误信息：${a}`,"失败原因",{showConfirmButton:!1,type:"error",cancelButtonText:"关闭"})},L=async a=>{h.show=!0,await ye(),h.url=a},P=(a,i)=>{me(a,i)};[V,w]=ue(()=>m()),await V,w();let b=null;return fe(()=>r.extend,a=>{a.unfinished_num>0?b=setTimeout(()=>{m()},30*1e3):E.getUser()},{immediate:!0}),he(()=>{b&&clearTimeout(b)}),(a,i)=>{const g=R,S=te,B=oe,k=R,j=Y,c=se,z=ae,q=le,A=ne,H=re,J=ce,M=ie,X=ee;return l(),p("div",xe,[t(J,null,{default:o(()=>[n("div",be,[n("div",Ce,[n("div",Ve,[we,n("span",Ee," 剩余合成时长："+u(s(E).userInfo.video_num)+"分钟 ",1)]),n("div",$e,[n("div",Se,[n("div",Be,[t(S,{custom:"",to:"/digital_human/design"},{default:o(({href:e})=>[n("a",{href:e,class:"mr-[10px]",target:"_blank"},[t(g,{type:"primary"},{default:o(()=>[d("新建视频")]),_:1})],8,Re)]),_:1}),t(g,{disabled:!s(x).length,onClick:i[0]||(i[0]=e=>$(s(x)))},{default:o(()=>[d("批量删除")]),_:1},8,["disabled"])]),n("div",Ue,[t(j,{modelValue:s(y).keyword,"onUpdate:modelValue":i[1]||(i[1]=e=>s(y).keyword=e),placeholder:"搜索",onInput:s(F)},{prepend:o(()=>[t(k,{loading:s(r).loading},{icon:o(()=>[t(B,{name:"el-icon-Search"})]),_:1},8,["loading"])]),_:1},8,["modelValue","onInput"]),t(g,{circle:"",plain:"",class:"ml-[10px]",onClick:s(m)},{icon:o(()=>[t(B,{name:"el-icon-Refresh"})]),_:1},8,["onClick"])])])]),n("div",Ie,[ge((l(),f(A,{height:"100%",size:"large",data:s(r).lists,onSelectionChange:T},{default:o(()=>[t(c,{type:"selection",width:"55"}),t(c,{label:"文件名称","min-width":"200"},{default:o(({row:e})=>[n("div",Te,[e.video_url?(l(),f(z,{key:0,onClick:_=>L(e.video_url),class:"cursor-pointer",type:"video","file-size":"70px",uri:e.video_url},null,8,["onClick","uri"])):v("",!0),n("div",De,u(e.name),1)])]),_:1}),t(c,{label:"生成进度","min-width":"200"},{default:o(({row:e})=>[e.status!==1?(l(),f(q,{key:0,percentage:e.synthetic_schedule},null,8,["percentage"])):(l(),p(ke,{key:1},[d("-")],64))]),_:1}),t(c,{label:"任务状态","min-width":"120"},{default:o(({row:e})=>[e.status==1?(l(),p("span",Fe,u(e.status_desc),1)):e.status==2?(l(),p("span",Ne,u(e.status_desc),1)):e.status==3?(l(),p("span",Le,u(e.status_desc),1)):(l(),p("span",{key:3,class:"text-error cursor-pointer",onClick:_=>N(e.fail_reason)},u(e.status_desc),9,Pe))]),_:1}),t(c,{label:"消耗时长",prop:"consume_time","min-width":"120"}),t(c,{label:"最后更新时间",prop:"update_time","min-width":"180","show-tooltip-when-overflow":""}),t(c,{label:"操作",width:"180",fixed:"right"},{default:o(({row:e})=>[e.status==3&&e.video_url?(l(),f(k,{key:0,type:"primary",link:"",onClick:_=>P(e.video_url,e.name)},{default:o(()=>[d(" 下载 ")]),_:2},1032,["onClick"])):v("",!0),e.status==1||e.status==4?(l(),f(S,{key:1,custom:"",to:`/digital_human/design?id=${e.id}`},{default:o(({href:_})=>[n("a",{href:_,class:"mr-[10px]",target:"_blank"},[t(k,{type:"primary",link:""},{default:o(()=>[d(" 编辑 ")]),_:1})],8,je)]),_:2},1032,["to"])):v("",!0),t(k,{type:"primary",link:"",onClick:_=>D(e.id,e.name)},{default:o(()=>[d(" 重命名 ")]),_:2},1032,["onClick"]),e.delete_btn?(l(),f(k,{key:2,type:"danger",link:"",onClick:_=>$([e.id])},{default:o(()=>[d(" 删除 ")]),_:2},1032,["onClick"])):v("",!0)]),_:1})]),_:1},8,["data"])),[[X,s(r).loading]])]),n("div",ze,[t(H,{modelValue:s(r),"onUpdate:modelValue":i[2]||(i[2]=e=>ve(r)?r.value=e:null),onChange:s(m)},null,8,["modelValue","onChange"])])])])]),_:1}),t(M,{modelValue:s(h).show,"onUpdate:modelValue":i[3]||(i[3]=e=>s(h).show=e),url:s(h).url,type:"video"},null,8,["modelValue","url"])])}}});export{Bt as default};
