import{k as se,s as P,r as R,a as j,aa as q,H as i,I as d,X as r,V as _,S as A,aj as ae,u as a,J as t,$ as T,U as E,T as W,Y as ne,Z as I,R as f,a7 as re,a0 as ie,aw as le,ag as ce,ah as pe,ax as de}from"./swiper-vue.2eb6bd20.js";import{_ as _e}from"./index.vue.7f39d825.js";import{E as me}from"./index.8ad94f19.js";import{E as ue}from"./index.5de6b9f9.js";import{W as fe}from"./index.36f10986.js";import{h as ge,m as we,cE as ye,ah as N,ck as he,c$ as ve,H as xe,d as ke}from"./entry.dfbfd4fd.js";import{E as Ce,a as Se}from"./el-image-viewer.d5621b18.js";import"./el-tooltip.4ed993c7.js";/* empty css                  *//* empty css                  */import{u as F}from"./asyncData.eaddccf2.js";import{a as Pe,d as Ee}from"./square.4ad4120f.js";import{a as Ie}from"./task_reward.d02f9b86.js";import{e as be}from"./empty_con.c3f015fe.js";import{I as Ve}from"./index.38e9448d.js";import Be from"./posterPop.99583921.js";import{E as $e}from"./index.a258b1c6.js";import{_ as De}from"./_plugin-vue_export-helper.c27b6911.js";import"./isUndefined.aa0326a0.js";import"./throttle.d40f833a.js";import"./debounce.8cbe4cfc.js";import"./position.4bcf7430.js";import"./index.deef7dcf.js";import"./index.17567b0d.js";import"./index.e94bc8a7.js";import"./index.6c069afb.js";import"./use-dialog.7d399731.js";import"./refs.cabac943.js";/* empty css                  *//* empty css                   *//* empty css                     */import"./useCopy.5611cfa5.js";import"./download.f61d7233.js";import"./qrcode.vue.esm.415e365a.js";const b=m=>(ce("data-v-c481d2de"),m=m(),pe(),m),ze={class:"flex-1 min-h-0 mx-[16px] relative"},Le=["onClick"],Re={class:"flex-1 min-h-[70vh] overflow-hidden mx-auto"},je=["infinite-scroll-disabled"],qe={class:"image-payload h-full w-full relative text-sm"},Ae={class:"image-bg"},Te=["onClick"],We=["onClick"],Ne={class:"text-center leading-[38px]"},Fe={class:"image-content"},Oe=["onClick"],He={class:"flex justify-between mt-[10px]"},Me={class:"flex items-center"},Ue={class:"text-[#BBBBBB] ml-[6px] w-[80px] truncate"},Ye=["onClick"],Je=b(()=>t("p",{class:"text-white ml-[6px]"}," 复制 ",-1)),Ke={key:1,class:"flex justify-center items-center mt-[50px]"},Qe=b(()=>t("span",{class:"mt-[4px] ml-[10px] text-[#999999]"},"加载中...",-1)),Xe={class:"flex flex-col justify-center items-center w-full h-[60vh]"},Ze=b(()=>t("div",{class:"text-tx-regular mb-4"},"当前选择暂无绘画～",-1)),Ge=se({__name:"draw",props:{keyword:{}},async setup(m){let l,g;const O=m;ge();const w=we(),V=P(null),B=P(null),c=R({page_no:0,page_size:20,keyword:"",category_id:""}),H={4e3:{rowPerView:7},2e3:{rowPerView:6},1800:{rowPerView:5},1600:{rowPerView:5},1440:{rowPerView:4},1360:{rowPerView:4},1280:{rowPerView:4},1024:{rowPerView:3}},s=R({more:!0,count:0,loading:!1,lists:[]}),$=j(0),y=j([]),{data:D}=([l,g]=q(()=>F(()=>Ie({type:ve.DRAW}),{default(){return[]},transform(o){return[{id:"",name:"全部"}].concat(o)},lazy:!0},"$SQjM9OqPT4")),l=await l,g(),l);[l,g]=q(()=>F(()=>k(),{lazy:!0},"$E2KxCY8C7W")),await l,g();const k=async()=>{if(!s.loading){if(s.more)c.page_no+=1;else return;s.loading=!0;try{const o=await Pe(c),{lists:n,page_no:v,page_size:C,count:x}=o;v*C>x&&(s.more=!1),v==1?s.lists=n:s.lists=[...s.lists,...n]}finally{setTimeout(()=>s.loading=!1,200)}}},h=()=>{c.page_no=0,s.more=!0,k()},M=async o=>{if(!w.isLogin){w.toggleShowLogin(!0);return}await Ee({records_id:o.id,status:o.is_collect?0:1}),c.category_id===0?h():o.is_collect=o.is_collect?0:1},U=o=>{if(!w.isLogin){w.toggleShowLogin(!0);return}B.value.open(o)},Y=P(),J=o=>{Y.value=o,console.log(o)},z=o=>{var n;$.value=o,c.category_id=(n=D.value[o])==null?void 0:n.id,h()};return z(0),ye(()=>O.keyword,o=>{c.keyword=o,h()},{debounce:500}),(o,n)=>{const v=de,C=le,x=_e,K=me,Q=ue,X=fe,Z=xe,G=Ce,ee=ke,oe=Se,te=$e;return i(),d("div",ze,[r(C,{slidesPerView:"auto",spaceBetween:16,class:"category-lists",onSwiper:J,style:{padding:"10px 0"}},{default:_(()=>[(i(!0),d(A,null,ae(a(D),(e,u)=>(i(),E(v,{key:e.id,style:{width:"auto","margin-right":"12px"}},{default:_(()=>[Object.keys(e).includes("name")?(i(),d("div",{key:0,class:W(["category-item bg-white",{"is-active":a($)===u}]),onClick:S=>z(u)},I(e.name),11,Le)):f("",!0)]),_:2},1024))),128))]),_:1}),t("div",Re,[T((i(),d("div",{class:"model-lists mb-[10px] mx-[0px]","infinite-scroll-distance":"50","infinite-scroll-delay":200,"infinite-scroll-disabled":!a(s).more},[a(s).lists.length?(i(),E(X,{key:0,ref_key:"waterFull",ref:V,delay:100,list:a(s).lists,width:305,gutter:20,animationDelay:0,animationDuration:0,backgroundColor:"none",animationPrefix:"none",animated:"none",animationEffect:"none",breakpoints:H},{item:_(({item:e})=>{var u,S;return[t("div",qe,[t("div",Ae,[r(Ve,{thumbnail:e.thumbnail,image:(e==null?void 0:e.image)||(e==null?void 0:e.image_url),onRefresh:n[0]||(n[0]=p=>{var L;return(L=a(V))==null?void 0:L.renderer()}),onOnClick:n[1]||(n[1]=p=>y.value=p)},null,8,["thumbnail","image"])]),t("div",{class:"image-praise relative",onClick:p=>M(e)},[t("div",{class:W(["praise-animate",e.is_collect?"praise-entry":"praise-leave"])},null,2)],8,Te),r(K,{effect:"dark",content:"生成海报",placement:"top"},{default:_(()=>[t("div",{class:"image-poster relative",onClick:ne(p=>U(e),["stop"])},[t("div",Ne,[r(x,{size:"16px",color:"#ffffff",name:"el-icon-Picture"})])],8,We)]),_:2},1024),t("div",Fe,[t("p",{class:"text-white line-clamp-2",onClick:p=>("copy"in o?o.copy:a(N))(e.prompt)},I((e==null?void 0:e.prompts_cn)||(e==null?void 0:e.original_prompts.prompt)),9,Oe),t("div",He,[t("div",Me,[(u=e==null?void 0:e.user_info)!=null&&u.image?(i(),d(A,{key:0},[r(Q,{size:28,src:(S=e==null?void 0:e.user_info)==null?void 0:S.image},null,8,["src"]),t("p",Ue,I(e.user_info.name),1)],64)):f("",!0)]),t("div",{class:"flex items-center",onClick:p=>("copy"in o?o.copy:a(N))(e.prompts)},[r(x,{name:"el-icon-Copy"}),Je],8,Ye)])])])]}),_:1},8,["list"])):f("",!0),a(s).loading?(i(),d("div",Ke,[r(Z,{size:"25",class:"is-loading"},{default:_(()=>[r(a(he))]),_:1}),Qe])):f("",!0),T(t("div",Xe,[r(G,{class:"w-[200px] h-[200px]",src:a(be)},null,8,["src"]),Ze,r(ee,{type:"primary",onClick:h},{default:_(()=>[re(" 点击刷新")]),_:1})],512),[[ie,!a(s).lists.length&&!a(s).loading]])],8,je)),[[te,k]]),r(Be,{ref_key:"posterPopupRef",ref:B},null,512),a(y).length?(i(),E(oe,{key:0,"url-list":a(y),"hide-on-click-modal":!0,onClose:n[2]||(n[2]=e=>y.value=[])},null,8,["url-list"])):f("",!0)])])}}});const Ro=De(Ge,[["__scopeId","data-v-c481d2de"]]);export{Ro as default};
