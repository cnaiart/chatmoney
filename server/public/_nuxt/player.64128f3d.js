import{_ as Q}from"./index.vue.7f39d825.js";import{E as W}from"./el-image-viewer.d5621b18.js";import{E as ee}from"./index.8ad94f19.js";import{E as te}from"./index.5de6b9f9.js";import{E as se}from"./index.17567b0d.js";import{u as oe,_ as ie}from"./player.a8689b22.js";import{e as ae,h as le,m as re,v as ne,j as ce}from"./entry.dfbfd4fd.js";import"./el-tooltip.4ed993c7.js";/* empty css                  *//* empty css                  *//* empty css                     */import{k as de,a as ue,aa as T,E as _e,H as r,I as c,J as e,X as a,$ as pe,u as t,U as A,R as f,Z as u,V as x,Y as E,T as M,S as me,aj as fe,ag as xe,ah as he}from"./swiper-vue.2eb6bd20.js";import{u as F}from"./asyncData.eaddccf2.js";import{b as ve}from"./download.f61d7233.js";import{c as ge}from"./music.f06b2c3d.js";import{g as ye,m as be}from"./square.4ad4120f.js";import{_ as we}from"./_plugin-vue_export-helper.c27b6911.js";import"./throttle.d40f833a.js";import"./debounce.8cbe4cfc.js";import"./position.4bcf7430.js";import"./isUndefined.aa0326a0.js";import"./el-slider.211113d2.js";import"./el-input-number.a67590b7.js";import"./index.91e71ce7.js";const V=h=>(xe("data-v-1d8c5aef"),h=h(),he(),h),ke={class:"music-player-container h-full p-[16px]"},Ce={class:"music-player flex flex-col min-h-0 h-full bg-body rounded-xl"},ze={class:"flex flex-1 min-h-0 h-full"},Ee={class:"flex flex-col flex-1 h-full min-h-0 p-[16px]"},Me={class:"flex w-[30px] bg-body p-[5px] text-bold rounded-[50%] text-primary shadow-light"},Re=V(()=>e("div",{class:"text-xl flex-1 min-w-0 ml-[10px]"}," 音乐广场 ",-1)),$e={class:"flex flex-col flex-1 h-full min-h-0","element-loading-text":"加载中...","element-loading-background":"rgba(0, 0, 0, 0)"},qe={class:"flex items-center",style:{"margin-top":"30px"}},Be={key:1,class:"text-tx-secondary"},Le={key:2,class:"absolute inset-0 flex items-center justify-center text-white"},Ie={key:3,class:"absolute inset-0 flex items-center justify-center text-white"},Se={class:"ml-[15px] py-[8px]"},je={class:"text-xl font-medium"},De={class:"mt-[20px] text-base text-tx-placeholder"},Pe={class:"flex items-center",style:{"margin-top":"30px"}},Ue={class:"flex items-center w-[150px]"},Te={class:"ml-1 text-tx-primary"},Ae={class:"mt-[20px]"},Fe={key:0,class:"flex items-center"},Ve={class:"text-[#BBBBBB] ml-[6px] w-[200px] truncate"},Ze={class:"whitespace-pre"},Ne={class:"flex flex-col h-full min-h-0 w-[600px] p-[16px]"},He=V(()=>e("div",{class:"text-xl font-medium"},"热门推荐",-1)),Je=["id","onClick"],Xe={class:"w-[100px] h-[100px] flex items-center justify-center flex-none relative"},Oe={key:1,class:"text-tx-secondary"},Ye={key:2,class:"absolute inset-0 flex items-center justify-center text-white"},Ge={key:3,class:"absolute inset-0 flex items-center justify-center text-white"},Ke={class:"flex-1 ml-[20px]"},Qe={key:0,class:"mt-[12px] text-tx-secondary"},We={class:"flex justify-between mt-[12px]"},et={class:"mt-[4px] text-tx-secondary"},tt={class:"flex items-center"},st=["onClick"],ot=["onClick"],it={class:"px-[16px] pb-[16px]"},at=de({__name:"player",async setup(h){let d,v;const w=ae(),Z=le(),g=re(),k=ue(0),{playing:y,currentId:_,setCurrentId:N,togglePlay:H,setMusic:C}=oe(),{data:o,pending:J,refresh:R}=([d,v]=T(()=>F(()=>ye({id:k.value||w.query.id}),{default(){return{audio_url:"",create_time:"",duration:"",image_large_url:"",image_url:"",is_collect:0,id:-1,lyric:"",prompt:"",style_desc:"",tags:"",title:"",video_url:""}},transform:s=>s,lazy:!0,immediate:!1},"$xU1RrCMzZJ")),d=await d,v(),d),{data:p,refresh:$}=([d,v]=T(()=>F(()=>ge(),{default(){return[]},lazy:!0,immediate:!1},"$MZz6IZCXHw")),d=await d,v(),d),X=async s=>{if(s.square_id===_.value)return;k.value=s.square_id,await R(),await $();const n=p.value.filter(l=>l.square_id===k.value);C(p.value),z(n[0]),console.log(o.value),Z.replace({path:"",query:{id:o.value.id}})},z=s=>{if(s.square_id==_.value){H(),console.log("播放");return}N(s.id)},q=async s=>{if(!g.isLogin){g.toggleShowLogin(!0);return}await be({records_id:(s==null?void 0:s.square_id)||w.query.id,status:s.is_collect?0:1}),s.is_collect=s.is_collect?0:1},O=async(s,n)=>{if(!g.isLogin){g.toggleShowLogin(!0);return}try{const l=await $request.get({url:s,responseType:"blob",baseURL:""},{isReturnDefaultResponse:!0,apiPrefix:""});console.log("下载音乐",l);const b=new Blob([l._data],{type:l.headers.get("Content-Type")}),m=window.URL.createObjectURL(b);ve(m,n)}catch{ce.msgError("文件下载失败")}};return _e(async()=>{await R(),await $(),p.value.filter(n=>n.square_id===w.query.id).length===0&&p.value.unshift(o.value),C(p.value),z(o.value)}),(s,n)=>{var L,I,S,j,D,P;const l=Q,b=W,m=ee,Y=te,B=se,G=ie,K=ne;return r(),c("div",ke,[e("div",Ce,[e("div",ze,[e("div",Ee,[e("div",{class:"flex items-center cursor-pointer",onClick:n[0]||(n[0]=i=>s.$router.back())},[e("div",Me,[a(l,{name:"el-icon-Back",size:18})]),Re]),pe((r(),c("div",$e,[e("div",qe,[e("div",{class:"w-[200px] h-[200px] flex items-center justify-center flex-none relative",onClick:n[1]||(n[1]=i=>z(t(o)))},[(L=t(o))!=null&&L.image_url?(r(),A(b,{key:0,src:(I=t(o))==null?void 0:I.image_url,class:"w-full h-full rounded-[15px]"},null,8,["src"])):(r(),c("div",Be,[a(l,{name:"local-icon-music1",size:45})])),t(_)==t(o).id&&t(y)?(r(),c("div",Le,[a(l,{name:"local-icon-pause1",size:20})])):f("",!0),t(_)==t(o).id&&!t(y)?(r(),c("div",Ie,[a(l,{name:"local-icon-play",size:20})])):f("",!0)]),e("div",Se,[e("div",je,u(t(o).title),1),e("div",De,u(t(o).style_desc),1),e("div",Pe,[e("div",Ue,[a(l,{class:"cursor-pointer p-1",name:"el-icon-Timer",size:"30",color:"#556477"}),e("span",Te,u(t(o).duration),1)]),a(m,{effect:"dark",content:"收藏 / 取消收藏",placement:"bottom"},{default:x(()=>[e("div",{class:"image-praise relative dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",onClick:n[2]||(n[2]=E(i=>q(t(o)),["stop"]))},[e("div",{class:M(["praise-animate",t(o).is_collect?"praise-entry":"praise-leave"])},null,2)])]),_:1}),a(m,{effect:"dark",content:"下载音乐",placement:"bottom"},{default:x(()=>[e("div",null,[a(l,{class:"cursor-pointer dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",name:"el-icon-Download",size:"24",color:"#556477"})])]),_:1})]),e("div",Ae,[(j=(S=t(o))==null?void 0:S.user_info)!=null&&j.image?(r(),c("div",Fe,[a(Y,{size:40,src:(P=(D=t(o))==null?void 0:D.user_info)==null?void 0:P.image},null,8,["src"]),e("p",Ve,u(t(o).user_info.name),1)])):f("",!0)])])]),a(B,{style:{"margin-top":"30px"}},{default:x(()=>[e("div",Ze,u(t(o).lyric),1)]),_:1})])),[[K,t(J)]])]),e("div",Ne,[He,a(B,{style:{"margin-top":"20px"}},{default:x(()=>[(r(!0),c(me,null,fe(t(p),i=>(r(),c("div",{class:"flex bg-page rounded-[15px] cursor-pointer hover:bg-[#EEF2FF] mb-[20px] p-[20px]",id:`music-item-${i.id}`,onClick:U=>X(i)},[e("div",Xe,[i.image_url?(r(),A(b,{key:0,src:i.image_url,class:"w-full h-full rounded-[15px]"},null,8,["src"])):(r(),c("div",Oe,[a(l,{name:"local-icon-music1",size:45})])),t(_)==i.id&&t(y)?(r(),c("div",Ye,[a(l,{name:"local-icon-pause1",size:20})])):f("",!0),t(_)==i.id&&!t(y)?(r(),c("div",Ge,[a(l,{name:"local-icon-play",size:20})])):f("",!0)]),e("div",Ke,[e("div",{class:M(["text-[16px] font-bold",{"!text-primary":t(_)===i.id}])},u(i.title),3),i.style_name?(r(),c("div",Qe,u(i.style_name),1)):f("",!0),e("div",We,[e("div",et,u(i.duration),1),e("div",tt,[a(m,{effect:"dark",content:"收藏 / 取消收藏",placement:"bottom"},{default:x(()=>[e("div",{class:"image-praise relative dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",onClick:E(U=>q(i),["stop"])},[e("div",{class:M(["praise-animate",i.is_collect?"praise-entry":"praise-leave"])},null,2)],8,st)]),_:2},1024),a(m,{effect:"dark",content:"下载音乐",placement:"bottom"},{default:x(()=>[e("div",{onClick:E(U=>O(i.audio_url,i.title),["stop"])},[a(l,{class:"cursor-pointer dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",name:"el-icon-Download",size:"24",color:"#556477"})],8,ot)]),_:2},1024)])])])],8,Je))),256))]),_:1})])]),e("div",it,[a(G,{ref:"musicPlayerRef",class:"bg-page rounded-lg"},null,512)])])])}}});const qt=we(at,[["__scopeId","data-v-1d8c5aef"]]);export{qt as default};
