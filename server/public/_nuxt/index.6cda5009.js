import{E as q}from"./el-upload.5844c619.js";import{E as A}from"./el-progress.8f5e9f30.js";import{E as D}from"./index.6c069afb.js";import{j as V,am as H}from"./entry.dfbfd4fd.js";/* empty css                  */import{k as J,a as u,s as X,l as Z,b as z,H as m,I as v,X as h,ai as G,aj as k,V as _,N as K,O as S,u as n,e as w,U as M,J as f,S as Q,Z as T,R as W}from"./swiper-vue.2eb6bd20.js";import{_ as Y}from"./_plugin-vue_export-helper.c27b6911.js";const ee={class:"upload"},te={class:"file-list p-4"},le={class:"flex-1"},ae=["src"],se=J({__name:"index",props:{files:{type:Array,default:()=>[]},type:{type:String,default:"image"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:10},data:{type:Object,default:()=>({})},name:{type:String,default:"file"},header:{type:Object,default:()=>({})},showFileList:{type:Boolean,default:!1}},emits:["end","start","change","error","success","update:files"],setup(d,{emit:r}){const a=d,y=u(""),c=u(!1),B=e=>{y.value=e.url,c.value=!0},g=u(!1),b=X(),i=u(!1),l=u([]),C=()=>{i.value=!0},x=e=>{r("change",e),l.value.length==0&&(g.value=!1,r("end"))},F=(e,t)=>{r("success",e),r("update:files",[...a.files,{url:e.uri,name:e.name}]);const s=l.value.indexOf(t);!a.showFileList&&l.value.splice(s,1),x(t)},I=e=>{const t=l.value.indexOf(e),s=a.files;s.splice(t,1),r("update:files",[...s])},L=(e,t)=>{var s;V.msgError(`${t.name}文件上传失败`),(s=b.value)==null||s.abort(t),i.value=!1,r("error",t),x(t)},R=()=>{V.msgError(`超出上传上限${a.limit}，请重新上传`)},U=()=>{l.value=[],i.value=!1},j=Z(()=>{switch(a.type){case"image":return".jpg,.png,.gif,.jpeg";case"video":return".wmv,.avi,.mpg,.mpeg,.3gp,.mov,.mp4,.flv,.rmvb,.mkv";case"audio":return;default:return"*"}}),P=e=>H(a.type,{file:e.file,name:a.name,header:a.header,data:a.data}),N=e=>{g.value=!0,r("start",e)};return z(()=>a.files,e=>{!l.value.length&&(e!=null&&e.length)&&(l.value=[...e])},{immediate:!0}),(e,t)=>{const s=q,O=A,E=D;return m(),v("div",ee,[h(s,S({ref_key:"uploadRefs",ref:b,"file-list":n(l),"onUpdate:fileList":t[0]||(t[0]=o=>w(l)?l.value=o:null)},e.$attrs,{multiple:d.multiple,limit:d.limit,"show-file-list":d.showFileList,"on-progress":C,"on-success":F,"on-exceed":R,"on-error":L,accept:n(j),"on-remove":I,"http-request":P,"before-upload":N,"on-preview":B}),G({_:2},[k(e.$slots,(o,p)=>({name:p,fn:_($=>[K(e.$slots,p,S($,{loading:n(g)}),void 0,!0)])}))]),1040,["file-list","multiple","limit","show-file-list","accept"]),!d.showFileList&&n(l).length?(m(),M(E,{key:0,modelValue:n(i),"onUpdate:modelValue":t[1]||(t[1]=o=>w(i)?i.value=o:null),title:"上传进度","close-on-click-modal":!1,width:"500px",modal:!1,onClose:U},{default:_(()=>[f("div",te,[(m(!0),v(Q,null,k(n(l),(o,p)=>(m(),v("div",{key:p,class:"mb-5"},[f("div",null,T(o.name),1),f("div",le,[h(O,{percentage:parseInt(String(o.percentage))},null,8,["percentage"])])]))),128))])]),_:1},8,["modelValue"])):W("",!0),h(E,{modelValue:n(c),"onUpdate:modelValue":t[2]||(t[2]=o=>w(c)?c.value=o:null),width:"50vw"},{default:_(()=>[f("img",{"w-full":"",src:n(y),alt:"Preview Image"},null,8,ae)]),_:1},8,["modelValue"])])}}});const pe=Y(se,[["__scopeId","data-v-1e31db6a"]]);export{pe as _};
