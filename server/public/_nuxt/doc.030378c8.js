import{_ as H}from"./index.vue.7f39d825.js";import{E as J}from"./el-upload.5844c619.js";import{E as M}from"./index.8ad94f19.js";import{f as O,j as P,E as Q,d as X,v as Z}from"./entry.dfbfd4fd.js";import{E as G}from"./index.17567b0d.js";import"./el-progress.8f5e9f30.js";import"./el-tooltip.4ed993c7.js";/* empty css                  *//* empty css                     */import{isSameFile as K}from"./hook.050168d8.js";import{r as I,a as W,b as Y}from"./fileReader.454730c0.js";import{s as ee}from"./textSplitter.31dc1ae4.js";import{k as te,a as v,s as oe,H as i,I as d,$ as se,u as s,X as a,V as g,J as t,a7 as V,Z as m,S as F,aj as S,e as ae,R as le,T as ne,ag as ce,ah as ie}from"./swiper-vue.2eb6bd20.js";import{_ as de}from"./_plugin-vue_export-helper.c27b6911.js";import"./cloneDeep.4e82bacf.js";import"./_baseClone.20563df6.js";import"./_getTag.83294aff.js";import"./isEqual.0df0ab2c.js";import"./isUndefined.aa0326a0.js";import"./___vite-browser-external.5512611b.js";import"./index.9c8f8f3a.js";const D=u=>(ce("data-v-2d5f0ce7"),u=u(),ie(),u),re={class:"h-full flex flex-col min-h-0"},pe={class:"py-[16px]"},_e={class:"el-upload__text"},me=D(()=>t("em",null," 选择文件 ",-1)),ue={class:"el-upload__text"},fe={key:0,class:"grid grid-cols-2 gap-4 flex-1 min-h-[500px]"},he={style:{"border-right":"1px solid #eeeeee"}},ve={class:"mt-4 max-w-[500px]"},xe=["onClick"],ge={class:"ml-2"},ke={class:"closeIcon ml-auto opacity-0 transition duration-300 flex items-center"},we={class:"mt-4"},ye={class:"flex"},be=D(()=>t("div",null,"分段长度",-1)),Ce={class:"mt-2"},Ee={class:"flex flex-col"},Ie={class:"text-lg"},Ve={class:"flex-auto mt-2 h-[100px]"},Fe={class:"flex items-center"},Se={class:"bg-white px-4 rounded"},De={class:"mx-2 text-[#000] flex-1 line-clamp-1"},Le={class:"mt-2 whitespace-pre-line"},Re=te({__name:"doc",props:{modelValue:{}},emits:["update:modelValue"],setup(u,{expose:L,emit:R}){const l=O(u,"modelValue",R),w=[".txt",".docx",".pdf",".md"].join(", "),c=v([]),y=oe(),k=v(!1),r=v(-1);v("");const x=v(512),T=async({raw:e})=>{var n;try{if(e){k.value=!0,await K(e,c.value);const o=await $(e);if(!o)throw"解析结果为空，已自动忽略";l.value.push({name:e.name,path:"",data:[]}),e.data=o,c.value.push(e),C(c.value.length-1),b()}}catch(o){P.msgError(o)}finally{k.value=!1,(n=y.value)==null||n.clearFiles()}},b=()=>{l.value.forEach(e=>{e.data=[];const n=c.value.findIndex(f=>f.name==e.name);ee({text:c.value[n].data,chunkLen:x.value}).forEach(f=>{e.data.push({q:f,a:""})})})},$=async e=>{const n=e.name.substring(e.name.lastIndexOf(".")+1);let o="";switch(n){case"md":case"txt":o=await I(e);break;case"pdf":o=await Y(e);break;case"doc":case"docx":o=await W(e);break;default:o=await I(e);break}return o},B=async e=>{l.value[r.value].data.splice(e,1)},N=e=>{l.value.splice(e,1),c.value.splice(e,1)},C=e=>{r.value=e};return L({clearFiles:()=>{c.value=[]}}),(e,n)=>{var E;const o=H,f=J,j=M,A=Q,U=X,q=G,z=Z;return i(),d("div",re,[se((i(),d("div",pe,[a(f,{ref_key:"uploadRef",ref:y,drag:"","on-change":T,"auto-upload":!1,"show-file-list":!1,accept:s(w),multiple:!0,limit:50},{default:g(()=>[t("div",_e,[a(o,{name:"el-icon-Upload"}),V(" 拖拽文件至此，或点击"),me]),t("div",ue,"支持 "+m(s(w))+" 文件",1)]),_:1},8,["accept"])])),[[z,s(k)]]),s(l).length>0?(i(),d("div",fe,[t("div",he,[t("div",ve,[(i(!0),d(F,null,S(s(l),(p,_)=>(i(),d("div",{key:_,class:ne(["fileItem flex items-center p-2 rounded-lg mt-1 hover:cursor-pointer hover:bg-page transition duration-300",{"bg-page":s(r)==_}]),onClick:h=>C(_)},[a(o,{name:"el-icon-Folder",size:16,color:"#ffc94d"}),t("div",ge,m(p.name),1),t("div",ke,[a(o,{name:"el-icon-DeleteFilled",onClick:h=>N(_)},null,8,["onClick"])])],10,xe))),128))]),t("div",we,[t("div",ye,[be,a(j,{content:"按结束符号进行分段。我们建议您的文档应合理的使用标点符号，以确保每个完整的句子长度不要超过该值中文文档建议400~1000英文文档建议600~1200",placement:"top"},{default:g(()=>[t("span",null,[a(o,{name:"el-icon-QuestionFilled"})])]),_:1})]),a(A,{class:"mt-2 !w-[300px]",modelValue:s(x),"onUpdate:modelValue":n[0]||(n[0]=p=>ae(x)?x.value=p:null)},null,8,["modelValue"]),t("div",Ce,[a(U,{type:"primary",onClick:b},{default:g(()=>[V("重新预览")]),_:1})])])]),t("div",Ee,[t("div",Ie," 分段预览（"+m((E=s(l)[s(r)])==null?void 0:E.data.length)+"组） ",1),t("div",Ve,[a(q,{height:"100%"},{default:g(()=>{var p;return[(i(!0),d(F,null,S((p=s(l)[s(r)])==null?void 0:p.data,(_,h)=>(i(),d("div",{class:"bg-page rounded p-[10px] mt-2",key:h},[t("div",Fe,[t("span",Se," #"+m(h+1),1),t("span",De,m(s(l)[s(r)].name),1),a(o,{class:"icon-delete text-primary cursor-pointer",name:"el-icon-Delete",onClick:Be=>B(h)},null,8,["onClick"])]),t("div",Le,m(_.q),1)]))),128))]}),_:1})])])])):le("",!0)])}}});const st=de(Re,[["__scopeId","data-v-2d5f0ce7"]]);export{st as default};
