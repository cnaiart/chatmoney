import{_ as j}from"./index.vue.7f39d825.js";import{h as q,e as z,j as T,cI as U,d as D,cJ as H}from"./entry.dfbfd4fd.js";import{E as J}from"./el-page-header.a55518b4.js";import{E as O}from"./el-image-viewer.d5621b18.js";import{_ as P}from"./nuxt-link.42058260.js";import{E as $}from"./index.6c069afb.js";/* empty css                   *//* empty css                  */import{u as y}from"./useLockFn.619a13da.js";import{u as X}from"./canvas.94886ee6.js";import{k as Z,a as C,b as A,j as G,H as i,I as c,X as s,V as l,J as o,a7 as m,Z as K,u as t,S as x,R as _,U as M,e as Q}from"./swiper-vue.2eb6bd20.js";const W={class:"bg-primary h-[60px] flex items-center text-white px-main"},Y={class:"text-white text-base"},ee={class:"text-white"},te={class:"ml-auto"},oe={class:"flex flex-col items-center justify-center"},se={class:"w-[400px] h-[200px] relative text-white rounded-lg overflow-hidden"},ae={class:"loading absolute z-10 bg-[rgba(0,0,0,0.5)] inset-0 flex flex-col justify-center items-center"},ne=o("div",{class:"mt-[10px] text-lg"},"视频生成中",-1),ie=o("div",{class:"mt-[10px] text-lg"},"视频合成成功",-1),ce=o("div",{class:"mt-[10px] text-lg"},"视频合成失败",-1),le={class:"my-[20px] flex items-center"},re=o("span",{class:"cursor-pointer text-primary"}," 视频合成 ",-1),Ce=Z({__name:"design-header",setup(de){const e=X(),f=q(),h=z(),n=C(!1),r=C(-1),w=()=>{f.push("/digital_human/aside/video_compositing")},{isLock:V,lockFn:b}=y(async()=>{await e.savaOrComposite(),f.replace({path:"",query:{...h.query,id:e.id}})}),{isLock:E,lockFn:S}=y(async()=>{await e.putImgCover(),await e.savaOrComposite(2),await v(),n.value=!0});let d=null;const v=async()=>{const{status:a}=await H({id:e.id});r.value=a,a==2&&(d=setTimeout(()=>{v()},30*1e3))};A(n,a=>{console.log(a),a||d&&clearTimeout(d)}),G(()=>{d&&clearTimeout(d)});const L=async()=>{const{value:a}=await T.prompt("修改视频名称","",{inputValue:e.name});e.id&&await U({name:a,id:e.id}),e.name=a},B=()=>{e.voiceContent.text="",e.voiceContent.voice_url="",n.value=!1,e.id=void 0,f.replace({path:"",query:{...h.query,id:void 0}})};return(a,u)=>{const p=j,g=D,F=J,I=O,N=P,R=$;return i(),c("div",W,[s(F,{onBack:w},{content:l(()=>[o("span",Y,[m(K(t(e).name)+" ",1),s(g,{link:"",text:"",onClick:L},{default:l(()=>[o("span",ee,[s(p,{name:"el-icon-EditPen"})])]),_:1})])]),_:1}),o("div",te,[s(g,{plain:"",style:{"--el-button-bg-color":"transparent","--el-button-text-color":"#fff"},loading:t(V),onClick:t(b)},{default:l(()=>[m(" 存为草稿 ")]),_:1},8,["loading","onClick"]),s(g,{onClick:t(S),loading:t(E)},{default:l(()=>[m(" 合成视频 ")]),_:1},8,["onClick","loading"])]),s(R,{modelValue:t(n),"onUpdate:modelValue":u[1]||(u[1]=k=>Q(n)?n.value=k:null),title:"视频生成",width:"500px","close-on-click-modal":!1,"show-close":!1},{default:l(()=>[o("div",oe,[o("div",se,[o("div",ae,[t(r)==2?(i(),c(x,{key:0},[s(p,{class:"el-icon is-loading",size:30,name:"el-icon-Loading"}),ne],64)):_("",!0),t(r)==3?(i(),c(x,{key:1},[s(p,{size:30,name:"el-icon-SuccessFilled"}),ie],64)):_("",!0),t(r)==4?(i(),c(x,{key:2},[s(p,{size:30,name:"el-icon-CircleCloseFilled"}),ce],64)):_("",!0)]),t(e).cover?(i(),M(I,{key:0,class:"w-full h-full",src:t(e).cover,fit:"contain"},null,8,["src"])):_("",!0)]),o("div",le,[m(" 可在前往 "),s(N,{to:"/digital_human/aside/video_compositing",replace:!0},{default:l(()=>[re]),_:1}),m(" 处查看 ，或留在当前页面 "),t(r)==4?(i(),c("span",{key:0,class:"cursor-pointer text-primary",onClick:u[0]||(u[0]=k=>n.value=!1)}," 重新合成视频 ")):(i(),c("span",{key:1,class:"cursor-pointer text-primary",onClick:B}," 继续创作 "))])])]),_:1},8,["modelValue"])])}}});export{Ce as _};
