import{E as Z}from"./index.17567b0d.js";import{_ as G}from"./index.vue.7f39d825.js";import{d as M,E as K,s as O}from"./entry.dfbfd4fd.js";/* empty css                     */import{u as Q}from"./usePaging.b2b97b82.js";import{u as W}from"./useLockFn.619a13da.js";import{k as ee,a as h,r as se,H as c,I as r,X as i,V as n,J as s,u as o,a7 as T,R as S,S as B,aj as L,Z as y,T as te,Y as m,ag as le,ah as oe}from"./swiper-vue.2eb6bd20.js";import{a as ie,b as ae}from"./knowledge.51dee290.js";import{E as k}from"./index.76d1875c.js";import{E as ne}from"./index.deef7dcf.js";import{E as de}from"./index.6c069afb.js";import{E as N}from"./index.5de6b9f9.js";import{E as ce}from"./index.828bffd0.js";import{_ as re}from"./_plugin-vue_export-helper.c27b6911.js";import"./isEqual.0df0ab2c.js";import"./_getTag.83294aff.js";import"./use-dialog.7d399731.js";import"./isUndefined.aa0326a0.js";import"./refs.cabac943.js";import"./index.8ad94f19.js";import"./dropdown.cd5c481a.js";const C=_=>(le("data-v-8e35f1ae"),_=_(),oe(),_),ue={class:"locality-draw-popup"},pe=C(()=>s("div",{class:"w-full text-left"},[s("div",{class:"text-lg font-medium"},"添加成员")],-1)),ve={class:"w-1/2"},_e={class:"px-4"},xe={class:"flex flex-col"},fe={key:0,style:{height:"500px"},class:"flex justify-center items-center text-tx-placeholder"},he={class:"mt-4"},me={class:"my-2 px-4"},ke=["onClick"],ge={class:"ml-2 text-xs"},ye={key:0,class:"text-tx-placeholder"},Ce={class:"flex flex-col px-4"},we={class:"text-base"},Ee={class:"flex items-center"},Ve={class:"ml-2 text-tx-regular text-xs"},Se={class:"flex items-center"},Pe={class:"cursor-pointer"},$e=["onClick"],Ie=C(()=>s("div",{style:{width:"320px"}},[s("div",{class:"text-base text-tx-primary"}," 可编辑 "),s("div",{class:"text-xs text-tx-placeholder mt-2"}," 只能操作数据学习，增删改查自己的数据，不能修改他人 ")],-1)),ze=["onClick"],Ue=C(()=>s("div",{style:{width:"320px"}},[s("div",{class:"text-base text-tx-primary"}," 可查看 "),s("div",{class:"text-xs text-tx-placeholder mt-2"}," 查看知识库所有数据 ")],-1)),Ae=["onClick"],Me=C(()=>s("div",{style:{width:"320px"}},[s("div",{class:"text-base text-tx-primary"}," 可管理 "),s("div",{class:"text-xs text-tx-placeholder mt-2"}," 管理整个知识库数据和信息 ")],-1)),Te=["onClick"],Be={class:"text-xs"},Le=["onClick"],Ne={class:"flex justify-end"},je=ee({__name:"add-user",props:{id:{type:Number,default:0}},emits:["success"],setup(_,{expose:j,emit:D}){const P=_,F={[1]:"可管理",[2]:"可编辑",[3]:"可查看"},x=h(!1),w=h(!1),E=h(!1),$=h(-1),V=se({keyword:"",kb_id:P.id,page_type:0}),a=h([]),{pager:u,getLists:I,resetPage:z,resetParams:b}=Q({fetchFun:ie,params:V}),q=()=>{z(),I()},U=(t,l)=>{if(t.is_added)return;const f=a.value.findIndex(g=>g.id===t.id);f!==-1?(t.permission=0,a.value.splice(f,1)):t.is_added||(t.permission=3,a.value.push(t)),l==="box"?t.isSelected=t.isSelected?0:1:t.isSelected=t.isSelected?1:0},H=t=>{u.lists.forEach(l=>{l.is_added||(l.isSelected=t?1:0,l.permission=t?3:0)}),a.value=t?u.lists.filter(l=>!l.is_added):[]},J=t=>{a.value=a.value.filter(l=>l.id!==t.id),u.lists.find(l=>l.id===t.id).isSelected=!1},R=t=>{$.value=t,E.value=!0},A=()=>{E.value=!1},p=(t,l)=>{t.permission=l,A()},{lockFn:X,isLock:Y}=W(async()=>{const t={};a.value.forEach(l=>{t[l.sn]=l.permission}),await ae({kb_id:P.id,users:t}),D("success"),x.value=!1});return j({show:()=>{x.value=!0,b(),z(),a.value=[],w.value=!1,I()}}),(t,l)=>{const f=Z,g=G;return c(),r("div",ue,[i(o(de),{modelValue:x.value,"onUpdate:modelValue":l[3]||(l[3]=e=>x.value=e),width:"980px",class:"!rounded-[12px]",center:!0,draggable:!0,"destroy-on-close":!0,"close-on-click-modal":!1},{header:n(()=>[pe]),footer:n(()=>[s("div",Ne,[i(o(M),{onClick:l[2]||(l[2]=e=>x.value=!1)},{default:n(()=>[T("取消")]),_:1}),i(o(M),{type:"primary",loading:o(Y),onClick:o(X)},{default:n(()=>[T(" 确认 ")]),_:1},8,["loading","onClick"])])]),default:n(()=>[s("div",{class:"flex",onClick:A},[s("div",ve,[s("div",_e,[i(o(K),{modelValue:V.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>V.keyword=e),style:{width:"100%"},size:"large",placeholder:"搜索成员","prefix-icon":o(O),onInput:q},null,8,["modelValue","prefix-icon"])]),i(f,{height:"500px"},{default:n(()=>[s("div",xe,[o(u).lists.length===0?(c(),r("div",fe," 请搜索成员添加 ")):S("",!0),s("div",he,[s("div",me,[i(o(k),{modelValue:w.value,"onUpdate:modelValue":l[1]||(l[1]=e=>w.value=e),"true-value":1,"false-value":0,label:"全选",size:"large",onChange:H},null,8,["modelValue"])]),o(u).lists.length!==0?(c(!0),r(B,{key:0},L(o(u).lists,e=>(c(),r("div",{class:te(["my-4 mr-4 py-2 px-4 flex items-center cursor-pointer hover:bg-primary-light-9 rounded-[12px]",{"!cursor-not-allowed":e.is_added}]),key:e.id,onClick:v=>U(e,"box")},[i(o(k),{modelValue:e.isSelected,"onUpdate:modelValue":v=>e.isSelected=v,"true-value":1,"false-value":0,label:"",size:"large",disabled:e.is_added,onClick:m(v=>U(e,"checkbox"),["stop"])},null,8,["modelValue","onUpdate:modelValue","disabled","onClick"]),i(o(N),{src:e.avatar,size:"26",class:"flex-none ml-2"},null,8,["src"]),s("div",ge,[s("span",null,y(e.nickname),1),e.is_added?(c(),r("div",ye," 已添加 ")):S("",!0)])],10,ke))),128)):S("",!0)])])]),_:1})]),i(o(ne),{direction:"vertical",style:{height:"500px"}}),i(f,{height:"500px",class:"w-1/2"},{default:n(()=>[s("div",Ce,[s("div",we," 已选择："+y(a.value.length)+" 个 ",1),(c(!0),r(B,null,L(a.value,(e,v)=>(c(),r("div",{class:"mt-4 py-2 px-4 flex items-center justify-between cursor-pointer hover:bg-primary-light-9 rounded-[12px]",key:e.id},[s("div",Ee,[i(o(N),{src:e.avatar,size:"26",class:"flex-none ml-2"},null,8,["src"]),s("div",Ve,y(e.nickname),1)]),s("div",Se,[i(o(ce),{placement:"bottom-end",width:380,trigger:"click","show-arrow":!1,transition:"custom-popover",visible:E.value&&$.value===v},{reference:n(()=>[s("div",{class:"flex items-center cursor-pointer",onClick:m(d=>R(v),["stop"])},[s("span",Be,y(F[e.permission]),1),i(g,{name:"el-icon-ArrowDown"})],8,Te)]),default:n(()=>[s("div",Pe,[s("div",{class:"flex items-center p-4 hover:bg-page rounded-xl",onClick:d=>p(e,2)},[Ie,i(o(k),{"model-value":e.permission,"true-value":2,label:"",size:"large",onClick:m(d=>p(e,2),["stop"])},null,8,["model-value","true-value","onClick"])],8,$e),s("div",{class:"flex items-center p-4 hover:bg-page rounded-xl",onClick:d=>p(e,3)},[Ue,i(o(k),{"model-value":e.permission,"true-value":3,label:"",size:"large",onClick:m(d=>p(e,3),["stop"])},null,8,["model-value","true-value","onClick"])],8,ze),s("div",{class:"flex items-center p-4 hover:bg-page rounded-xl",onClick:d=>p(e,1)},[Me,i(o(k),{"model-value":e.permission,"true-value":1,label:"",size:"large",onClick:m(d=>p(e,1),["stop"])},null,8,["model-value","true-value","onClick"])],8,Ae)])]),_:2},1032,["visible"]),s("div",{class:"flex items-center ml-6",onClick:d=>J(e)},[i(g,{name:"el-icon-CloseBold"})],8,Le)])]))),128))])]),_:1})])]),_:1},8,["modelValue"])])}}});const as=re(je,[["__scopeId","data-v-8e35f1ae"]]);export{as as default};
