import{_ as T}from"./index.vue.7f39d825.js";import{E as q}from"./el-upload.5844c619.js";import{E as B}from"./index.17567b0d.js";import{f as Q,j as z,v as U}from"./entry.dfbfd4fd.js";import"./el-progress.8f5e9f30.js";/* empty css                     */import{r as y,a as H,b as J}from"./fileReader.454730c0.js";import{isSameFile as M}from"./hook.050168d8.js";import{s as O}from"./textSplitter.31dc1ae4.js";import{k as P,a as x,s as X,r as Z,i as G,H as l,I as c,$ as K,u as a,X as d,V as C,J as s,a7 as W,Z as p,S,aj as I,R as Y,T as ee,ag as te,ah as se}from"./swiper-vue.2eb6bd20.js";import{_ as ae}from"./_plugin-vue_export-helper.c27b6911.js";import"./cloneDeep.4e82bacf.js";import"./_baseClone.20563df6.js";import"./_getTag.83294aff.js";import"./isEqual.0df0ab2c.js";import"./___vite-browser-external.5512611b.js";import"./index.9c8f8f3a.js";const oe=_=>(te("data-v-9442b965"),_=_(),se(),_),ne={class:"h-full flex flex-col"},le={class:"py-[16px]"},ce={class:"el-upload__text"},ie=oe(()=>s("em",null," 选择文件 ",-1)),re={class:"el-upload__text"},de={key:0,class:"grid grid-cols-2 gap-4 flex-1 min-h-[500px]"},pe={style:{"border-right":"1px solid #eeeeee"}},_e={class:"mt-4 max-w-[500px]"},me=["onClick"],ue={class:"ml-2"},he={class:"closeIcon ml-auto opacity-0 transition duration-300 flex items-center"},fe={class:"flex flex-col"},ve={class:"text-lg"},xe={class:"flex-auto mt-2 h-[100px]"},ge={class:"flex items-center"},ke={class:"bg-white px-4 rounded"},we={class:"mx-2 text-[#000] flex-1 line-clamp-1"},be={class:"mt-2 whitespace-pre-line"},ye=P({__name:"QASplit",props:{modelValue:{}},emits:["update:modelValue"],setup(_,{emit:V}){const o=Q(_,"modelValue",V),g=[".txt",".docx",".pdf",".md"].join(", "),h=x([]),k=X(),v=x(!1),i=x(-1),D=Z([]),E=G("knowDetail"),F=async({raw:e})=>{var n;try{if(e){v.value=!0,await M(e,h.value);const t=await A(e);if(!t)throw"解析结果为空，已自动忽略";const m=L(t);o.value.push({name:e.name,path:"",data:m}),h.value.push(e),w(h.value.length-1)}}catch(t){z.msgError(t)}finally{v.value=!1,(n=k.value)==null||n.clearFiles()}},A=async e=>{const n=e.name.substring(e.name.lastIndexOf(".")+1);let t="";switch(n){case"md":case"txt":t=await y(e);break;case"pdf":t=await J(e);break;case"doc":case"docx":t=await H(e);break;default:t=await y(e);break}return t},w=e=>{i.value=e,D.length=0},L=e=>{const n=[];return O({text:e,chunkLen:E.qa_length}).forEach(m=>{n.push({q:m,a:""})}),n},$=async e=>{o.value[i.value].data.splice(e,1)},j=e=>{o.value.splice(e,1),h.value.splice(e,1)};return(e,n)=>{var b;const t=T,m=q,N=B,R=U;return l(),c("div",ne,[K((l(),c("div",le,[d(m,{ref_key:"uploadRef",ref:k,drag:"","on-change":F,"auto-upload":!1,"show-file-list":!1,accept:a(g),multiple:!0,limit:50},{default:C(()=>[s("div",ce,[d(t,{name:"el-icon-Upload"}),W(" 拖拽文件至此，或点击"),ie]),s("div",re,"支持 "+p(a(g))+" 文件",1)]),_:1},8,["accept"])])),[[R,a(v)]]),a(o).length>0?(l(),c("div",de,[s("div",pe,[s("div",_e,[(l(!0),c(S,null,I(a(o),(f,r)=>(l(),c("div",{key:r,class:ee(["fileItem flex items-center p-2 rounded-lg mt-1 hover:cursor-pointer hover:bg-page transition duration-300",{"bg-page":a(i)==r}]),onClick:u=>w(r)},[d(t,{name:"el-icon-Folder",size:16,color:"#ffc94d"}),s("div",ue,p(f.name),1),s("div",he,[d(t,{name:"el-icon-DeleteFilled",onClick:u=>j(r)},null,8,["onClick"])])],10,me))),128))])]),s("div",fe,[s("div",ve," 分段预览（"+p((b=a(o)[a(i)])==null?void 0:b.data.length)+"组） ",1),s("div",xe,[d(N,{height:"100%"},{default:C(()=>{var f;return[(l(!0),c(S,null,I((f=a(o)[a(i)])==null?void 0:f.data,(r,u)=>(l(),c("div",{class:"bg-page rounded p-[10px] mt-2",key:u},[s("div",ge,[s("span",ke," #"+p(u+1),1),s("span",we,p(a(o)[a(i)].name),1),d(t,{class:"icon-delete text-primary cursor-pointer",name:"el-icon-Delete",onClick:Ie=>$(u)},null,8,["onClick"])]),s("div",be,p(r.q),1)]))),128))]}),_:1})])])])):Y("",!0)])}}});const Je=ae(ye,[["__scopeId","data-v-9442b965"]]);export{Je as default};
