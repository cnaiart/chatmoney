import{g as Lt}from"./entry.dfbfd4fd.js";import{a as kt,s as Ct,o as Ht,b as Ot}from"./swiper-vue.2eb6bd20.js";var Et={exports:{}};(function(F1){(function(q1){var T1=typeof window=="object"&&!!window.document,z1=T1?window:Object;(function(Q,A1){var Z1=function(){},f1=function(w){return typeof w=="number"},H=function(w){return new E1(w)},j1=H.LM="2023-12-24 18:09",y1="https://github.com/xiangyuecn/Recorder",S1="Recorder",d1="getUserMedia",L1="srcSampleRate",p1="sampleRate",k1="bitRate",v1="catch",c1=Q[S1];if(c1&&c1.LM==j1)return c1.CLog(c1.i18n.$T("K8zP::重复导入{1}",0,S1),3);H.IsOpen=function(){var w=H.Stream;if(w){var _=w.getTracks&&w.getTracks()||w.audioTracks||[],u=_[0];if(u){var S=u.readyState;return S=="live"||S==u.LIVE}}return!1},H.BufferSize=4096,H.Destroy=function(){for(var w in g1(S1+" Destroy"),o1(),R1)R1[w]()};var R1={};H.BindDestroy=function(w,_){R1[w]=_},H.Support=function(){if(!A1)return!1;var w=navigator.mediaDevices||{};return w[d1]||(w=navigator)[d1]||(w[d1]=w.webkitGetUserMedia||w.mozGetUserMedia||w.msGetUserMedia),!!w[d1]&&(H.Scope=w,!!H.GetContext())},H.GetContext=function(w){if(!A1)return null;var _=window.AudioContext;if(_||(_=window.webkitAudioContext),!_)return null;var u=H.Ctx;if(u&&u.state!="closed"||(u=H.Ctx=new _,H.NewCtxs=H.NewCtxs||[],H.BindDestroy("Ctx",function(){var S=H.Ctx;S&&S.close&&(S.close(),H.Ctx=0);var y=H.NewCtxs;H.NewCtxs=[];for(var C=0;C<y.length;C++)y[C].close()})),w&&u.close)try{u=new _,H.NewCtxs.push(u)}catch(S){g1("GetContext tryNew Error",1,S)}return u},H.CloseNewCtx=function(w){if(w&&w!=H.Ctx){w.close&&w.close();for(var _=H.NewCtxs||[],u=_.length,S=0;S<_.length;S++)if(_[S]==w){_.splice(S,1);break}g1(Z("mSxV::剩{1}个GetContext未close",0,u+"-1="+_.length),_.length?3:0)}};var E=function(w){var _=w.state,u="ctx.state="+_;return _=="suspended"&&(u+=Z("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),u},n1="ConnectEnableWebM";H[n1]=!0;var l1="ConnectEnableWorklet";H[l1]=!1;var u1=function(w,_){var u=w.BufferSize||H.BufferSize,S=w.Stream,y=S._RC||S._c||H.GetContext(!0);S._c=y;var C,T,Y,X=function(s){var f=S._m=y.createMediaStreamSource(S),p=y.destination,l="createMediaStreamDestination";y[l]&&(p=S._d=y[l]()),f.connect(s),s.connect(p)},I="",v=S._call,O=function(s){for(var f in v){for(var p=s.length,l=new Int16Array(p),o=0,i=0;i<p;i++){var c=Math.max(-1,Math.min(1,s[i]));c=c<0?32768*c:32767*c,l[i]=c,o+=Math.abs(c)}for(var m in v)v[m](l,o);return}},W="ScriptProcessor",r1="audioWorklet",$=S1+" "+r1,t1="RecProc",R="MediaRecorder",e=R+".WebM.PCM",t=y.createScriptProcessor||y.createJavaScriptNode,r=Z("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,r1),a=function(){T=S.isWorklet=!1,M1(S),g1(Z("7TU0::Connect采用老的{1}，",0,W)+_1.get(Z(H[l1]?"JwCL::但已设置{1}尝试启用{2}":"VGjB::可设置{1}尝试启用{2}",2),[S1+"."+l1+"=true",r1])+I+r,3);var s=S._p=t.call(y,u,1,1);X(s),s.onaudioprocess=function(f){var p=f.inputBuffer.getChannelData(0);O(p)}},n=function(){C=S.isWebM=!1,m1(S),T=S.isWorklet=!t||H[l1];var s=window.AudioWorkletNode;if(T&&y[r1]&&s){var f=function(){return T&&S._na},p=S._na=function(){Y!==""&&(clearTimeout(Y),Y=setTimeout(function(){Y=0,f()&&(g1(Z("MxX1::{1}未返回任何音频，恢复使用{2}",0,r1,W),3),t&&a())},500))},l=function(){if(f()){var o=S._n=new s(y,t1,{processorOptions:{bufferSize:u}});X(o),o.port.onmessage=function(i){Y&&(clearTimeout(Y),Y=""),f()?O(i.data.val):T||g1(Z("XUap::{1}多余回调",0,r1),3)},g1(Z("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,r1,S1+"."+l1+"=false",W)+I+r,3)}};y.resume()[v&&"finally"](function(){if(f())if(y[t1])l();else{var o,i,c=(i="class "+t1+" extends AudioWorkletProcessor{",i+="constructor "+(o=function(m){return m.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,$)})(function(m){DEL_super(m);var h=this,g=m.processorOptions.bufferSize;h.bufferSize=g,h.buffer=new Float32Array(2*g),h.pos=0,h.port.onmessage=function(L){L.data.kill&&(h.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",m)}),i+="process "+o(function(m,h,g){var L=this,x=L.bufferSize,z=L.buffer,D=L.pos;if((m=(m[0]||[])[0]||[]).length){z.set(m,D);var M=~~((D+=m.length)/x)*x;if(M){this.port.postMessage({val:z.slice(0,M)});var d=z.subarray(M,D);(z=new Float32Array(2*x)).set(d),D=d.length,L.buffer=z}L.pos=D}return!L.kill}),i=(i+='}try{registerProcessor("'+t1+'", '+t1+')}catch(e){$C.error("'+$+' Reg Error",e)}').replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(i))));y[r1].addModule(c).then(function(m){f()&&(y[t1]=1,l(),Y&&p())})[v1](function(m){g1(r1+".addModule Error",1,m),f()&&a()})}})}else a()};(function(){var s=window[R],f="ondataavailable",p="audio/webm; codecs=pcm";C=S.isWebM=H[n1];var l=s&&f in s.prototype&&s.isTypeSupported(p);if(I=l?"":Z("VwPd::（此浏览器不支持{1}）",0,e),!_||!C||!l)return n();var o=function(){return C&&S._ra},i=(S._ra=function(){Y!==""&&(clearTimeout(Y),Y=setTimeout(function(){o()&&(g1(Z("vHnb::{1}未返回任何音频，降级使用{2}",0,R,r1),3),n())},500))},Object.assign({mimeType:p},H.ConnectWebMOptions)),c=S._r=new s(S,i),m=S._rd={sampleRate:y[p1]};c[f]=function(h){var g=new FileReader;g.onloadend=function(){if(o()){var L=C1(new Uint8Array(g.result),m);if(!L)return;if(L==-1)return void n();Y&&(clearTimeout(Y),Y=""),O(L)}else C||g1(Z("O9P7::{1}多余回调",0,R),3)},g.readAsArrayBuffer(h.data)},c.start(~~(u/48)),g1(Z("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,e,S1+"."+n1+"=false",r1,W))})()},M1=function(w){w._na=null,w._n&&(w._n.port.postMessage({kill:!0}),w._n.disconnect(),w._n=null)},m1=function(w){w._ra=null,w._r&&(w._r.stop(),w._r=null)},o1=function(w){var _=(w=w||H)==H,u=w.Stream;u&&(u._m&&(u._m.disconnect(),u._m=null),!u._RC&&u._c&&H.CloseNewCtx(u._c),u._RC=null,u._c=null,u._d&&(k(u._d.stream),u._d=null),u._p&&(u._p.disconnect(),u._p.onaudioprocess=u._p=null),M1(u),m1(u),_&&k(u)),w.Stream=0},k=H.StopS_=function(w){for(var _=w.getTracks&&w.getTracks()||w.audioTracks||[],u=0;u<_.length;u++){var S=_[u];S.stop&&S.stop()}w.stop&&w.stop()};H.SampleData=function(w,_,u,S,y){var C="SampleData";S||(S={});var T=S.index||0,Y=S.offset||0,X=S.filter;if(X&&X.fn&&X.sr!=_&&(X=null,g1(Z("d48C::{1}的filter采样率变了，重设滤波",0,C),3)),!X){var I=3*_/4<u?0:u/2*3/4;X={fn:I?H.IIRFilter(!0,_,I):0}}X.sr=_;var v=X.fn,O=S.frameNext||[];y||(y={});var W=y.frameSize||1;y.frameType&&(W=y.frameType=="mp3"?1152:1);var r1=w.length;r1+1<T&&g1(Z("tlbC::{1}似乎传入了未重置chunk {2}",0,C,T+">"+r1),3);for(var $=0,t1=T;t1<r1;t1++)$+=w[t1].length;$=Math.max(0,$-Math.floor(Y));var R=_/u;1<R?$=Math.floor($/R):(R=1,u=_),$+=O.length;for(var e=new Int16Array($),t=0,t1=0;t1<O.length;t1++)e[t]=O[t1],t++;for(;T<r1;T++){for(var r=w[T],t1=Y,a=r.length,n=v&&v.Embed,s=0,f=0,p=0,l=0,o=0,i=0;o<a;o++,i++)if(i<a&&(n?(p=r[i],l=n.b0*p+n.b1*n.x1+n.b0*n.x2-n.a1*n.y1-n.a2*n.y2,n.x2=n.x1,n.x1=p,n.y2=n.y1,n.y1=l):l=v?v(r[i]):r[i]),s=f,f=l,i!=0){var c=Math.floor(t1);if(o==c){var m=Math.ceil(t1),h=t1-c,g=s,L=m<a?f:g,x=g+(L-g)*h;32767<x?x=32767:x<-32768&&(x=-32768),e[t]=x,t++,t1+=R}}else o--;Y=Math.max(0,t1-a)}O=null;var z=e.length%W;if(0<z){var D=2*(e.length-z);O=new Int16Array(e.buffer.slice(D)),e=new Int16Array(e.buffer.slice(0,D))}return{index:T,offset:Y,filter:X,frameNext:O,sampleRate:u,data:e}},H.IIRFilter=function(w,_,u){var S=2*Math.PI*u/_,y=Math.sin(S),C=Math.cos(S),T=y/2,Y=1+T,X=-2*C/Y,I=(1-T)/Y;if(w)var v=(1-C)/2/Y,O=(1-C)/Y;else var v=(1+C)/2/Y,O=-(1+C)/Y;var W=0,r1=0,$=0,t1=0,R=0,e=function(t){return $=v*t+O*W+v*r1-X*t1-I*R,r1=W,W=t,R=t1,t1=$};return e.Embed={x1:0,x2:0,y1:0,y2:0,b0:v,b1:O,a1:X,a2:I},e},H.PowerLevel=function(w,_){var u=w/_||0;return u<1251?Math.round(u/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(u/1e4)/Math.log(10)))))},H.PowerDBFS=function(w){var _=Math.max(.1,w||0);return _=Math.min(_,32767),_=20*Math.log(_/32767)/Math.log(10),Math.max(-100,Math.round(_))},H.CLog=function(w,_){if(typeof console=="object"){var u=new Date,S=("0"+u.getMinutes()).substr(-2)+":"+("0"+u.getSeconds()).substr(-2)+"."+("00"+u.getMilliseconds()).substr(-3),y=this&&this.envIn&&this.envCheck&&this.id,C=["["+S+" "+S1+(y?":"+y:"")+"]"+w],T=arguments,Y=H.CLog,X=2,I=Y.log||console.log;for(f1(_)?I=_==1?Y.error||console.error:_==3?Y.warn||console.warn:I:X=1;X<T.length;X++)C.push(T[X]);O1?I&&I("[IsLoser]"+C[0],1<C.length?C:""):I.apply(console,C)}};var g1=function(){H.CLog.apply(this,arguments)},O1=!0;try{O1=!console.log.apply}catch{}var B1=0;function E1(w){var _=this;_.id=++B1,N1();var u={type:"mp3",onProcess:Z1};for(var S in w)u[S]=w[S];var y=(_.set=u)[k1],C=u[p1];(y&&!f1(y)||C&&!f1(C))&&_.CLog(Z.G("IllegalArgs-1",[Z("VtS4::{1}和{2}必须是数值",0,p1,k1)]),1,w),u[k1]=+y||16,u[p1]=+C||16e3,_.state=0,_._S=9,_.Sync={O:9,C:9}}H.Sync={O:9,C:9},H.prototype=E1.prototype={CLog:g1,_streamStore:function(){return this.set.sourceStream?this:H},_streamCtx:function(){var w=this._streamStore().Stream;return w&&w._c},open:function(w,_){var u=this,S=u.set,y=u._streamStore(),C=0;w=w||Z1;var T=function(a,n){n=!!n,u.CLog(Z("5tWi::录音open失败：")+a+",isUserNotAllow:"+n,1),C&&H.CloseNewCtx(C),_&&_(a,n)};u._streamTag=d1;var Y=function(){u.CLog("open ok, id:"+u.id+" stream:"+u._streamTag),w(),u._SO=0},X=y.Sync,I=++X.O,v=X.C;if(u._O=u._O_=I,u._SO=u._S,A1){var O=u.envCheck({envName:"H5",canProcess:!0});if(O)T(Z("A5bm::不能录音：")+O);else if(S.sourceStream){if(u._streamTag="set.sourceStream",!H.GetContext())return void T(Z("1iU7::不支持此浏览器从流中获取录音"));o1(y);var W=u.Stream=S.sourceStream;W._RC=S.runningContext,W._call={};try{u1(y)}catch(a){return o1(y),void T(Z("BTW2::从流中打开录音失败：")+a.message)}Y()}else{var r1=function(a,n){try{window.top.a}catch{return void T(Z("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'))}/Permission|Allow/i.test(a)?T(Z("gyO5::用户拒绝了录音权限"),!0):window.isSecureContext===!1?T(Z("oWNo::浏览器禁止不安全页面录音，可开启https解决")):/Found/i.test(a)?T(n+Z("jBa9::，无可用麦克风")):T(n)};if(H.IsOpen())Y();else if(H.Support()){var $=S.runningContext;$||($=C=H.GetContext(!0));var t1=function(a){setTimeout(function(){a._call={};var n=H.Stream;n&&(o1(),a._call=n._call),(H.Stream=a)._c=$,a._RC=S.runningContext,function(){if(v!=X.C||!u._O){var s=Z("dFm8::open被取消");return I==X.O?u.close():s=Z("VtJO::open被中断"),T(s),!0}}()||(H.IsOpen()?(n&&u.CLog(Z("upb8::发现同时多次调用open"),1),u1(y,1),Y()):T(Z("Q1GA::录音功能无效：无音频流")))},100)},R=function(a){var n=a.name||a.message||a.code+":"+a;u.CLog(Z("xEQR::请求录音权限错误"),1,a),r1(n,Z("bDOG::无法录音：")+n)},e=S.audioTrackSet||{};e[p1]=$[p1];var t={audio:e};try{var r=H.Scope[d1](t,t1,R)}catch(a){u.CLog(d1,3,a),t={audio:!0},r=H.Scope[d1](t,t1,R)}u.CLog(d1+"("+JSON.stringify(t)+") "+E($)+Z("RiWe::，未配置noiseSuppression和echoCancellation时浏览器可能会自动打开降噪和回声消除，移动端可能会降低系统播放音量（关闭录音后可恢复），请参阅文档中audioTrackSet配置")+"("+y1+") LM:"+j1+" UA:"+navigator.userAgent),r&&r.then&&r.then(t1)[v1](R)}else r1("",Z("COxc::此浏览器不支持录音"))}}else T(Z.G("NonBrowser-1",["open"])+Z("EMJq::，可尝试使用RecordApp解决方案")+"("+y1+"/tree/master/app-support-sample)")},close:function(w){w=w||Z1;var _=this,u=_._streamStore();_._stop();var S=" stream:"+_._streamTag,y=u.Sync;if(_._O=0,_._O_!=y.O)return _.CLog(Z("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+S,3),void w();y.C++,o1(u),_.CLog("close,"+S),w()},mock:function(w,_){var u=this;return u._stop(),u.isMock=1,u.mockEnvInfo=null,u.buffers=[w],u.recSize=w.length,u._setSrcSR(_),u._streamTag="mock",u},_setSrcSR:function(w){var _=this.set,u=_[p1];w<u?_[p1]=w:u=0,this[L1]=w,this.CLog(L1+": "+w+" set."+p1+": "+_[p1]+(u?" "+Z("UHvm::忽略")+": "+u:""),u?3:0)},envCheck:function(w){var _,u=this.set,S="CPU_BE";if(_||H[S]||typeof Int8Array!="function"||new Int8Array(new Int32Array([1]).buffer)[0]||(N1(S),_=Z("Essp::不支持{1}架构",0,S)),!_){var y=u.type,C=this[y+"_envCheck"];u.takeoffEncodeChunk&&(C?w.canProcess||(_=Z("7uMV::{1}环境不支持实时处理",0,w.envName)):_=Z("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,y)+(this[y]?"":Z("LG7e::(未加载编码器)"))),!_&&C&&(_=this[y+"_envCheck"](w,u))}return _||""},envStart:function(w,_){var u=this,S=u.set;if(u.isMock=w?1:0,u.mockEnvInfo=w,u.buffers=[],u.recSize=0,w&&(u._streamTag="env$"+w.envName),u.state=1,u.envInLast=0,u.envInFirst=0,u.envInFix=0,u.envInFixTs=[],u._setSrcSR(_),u.engineCtx=0,u[S.type+"_start"]){var y=u.engineCtx=u[S.type+"_start"](S);y&&(y.pcmDatas=[],y.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(w,_){var u=this,S=u.set,y=u.engineCtx;if(u.state==1){var C=u[L1],T=w.length,Y=H.PowerLevel(_,T),X=u.buffers,I=X.length;X.push(w);var v=X,O=I,W=Date.now(),r1=Math.round(T/C*1e3);u.envInLast=W,u.buffers.length==1&&(u.envInFirst=W-r1);var $=u.envInFixTs;$.splice(0,0,{t:W,d:r1});for(var t1=W,R=0,e=0;e<$.length;e++){var t=$[e];if(3e3<W-t.t){$.length=e;break}t1=t.t,R+=t.d}var r=$[1],a=W-t1,n=a-R;if(a/3<n&&(r&&1e3<a||6<=$.length)){var s=W-r.t-r1;if(r1/5<s){var f=!S.disableEnvInFix;if(u.CLog("["+W+"]"+_1.get(Z(f?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[s]),3),u.envInFix+=s,f){var p=new Int16Array(s*C/1e3);T+=p.length,X.push(p)}}}var l=u.recSize,o=T,i=l+o;if(u.recSize=i,y){var c=H.SampleData(X,C,S[p1],y.chunkInfo);y.chunkInfo=c,l=y.pcmSize,o=c.data.length,i=l+o,y.pcmSize=i,X=y.pcmDatas,I=X.length,X.push(c.data),C=c[p1]}var m=Math.round(i/C*1e3),h=X.length,g=v.length,L=function(){for(var d=x?0:-o,A=X[0]==null,F=I;F<h;F++){var j=X[F];j==null?A=1:(d+=j.length,y&&j.length&&u[S.type+"_encode"](y,j))}if(A&&y){var F=O;for(v[0]&&(F=0);F<g;F++)v[F]=null}A&&(d=x?o:0,X[0]=null),y?y.pcmSize+=d:u.recSize+=d},x=0,z="rec.set.onProcess";try{x=S.onProcess(X,Y,m,C,I,L)}catch(d){console.error(z+Z("gFUF::回调出错是不允许的，需保证不会抛异常"),d)}var D=Date.now()-W;if(10<D&&1e3<u.envInFirst-W&&u.CLog(z+Z("2ghS::低性能，耗时{1}ms",0,D),3),x===!0){for(var M=0,e=I;e<h;e++)X[e]==null?M=1:X[e]=new Int16Array(0);M?u.CLog(Z("ufqH::未进入异步前不能清除buffers"),3):y?y.pcmSize-=o:u.recSize-=o}else L()}else u.state||u.CLog("envIn at state=0",3)},start:function(){var w=this,_=1;if(w.set.sourceStream?w.Stream||(_=0):H.IsOpen()||(_=0),_){var u=w._streamCtx();if(w.CLog(Z("kLDN::start 开始录音，")+E(u)+" stream:"+w._streamTag),w._stop(),w.envStart(null,u[p1]),w.state=3,w._SO&&w._SO+1!=w._S)w.CLog(Z("Bp2y::start被中断"),3);else{w._SO=0;var S=function(){w.state==3&&(w.state=1,w.resume())};if(u.state=="suspended"){var y="AudioContext resume: ";w.CLog(y+"wait..."),u.resume().then(function(){w.CLog(y+u.state),S()})[v1](function(C){w.CLog(y+u.state+Z("upkE::，可能无法录音：")+C.message,1,C),S()})}else S()}}else w.CLog(Z("6WmN::start失败：未open"),1)},pause:function(){var w=this,_=w._streamStore().Stream;w.state&&(w.state=2,w.CLog("pause"),_&&delete _._call[w.id])},resume:function(){var w=this,_=w._streamStore().Stream;w.state&&(w.state=1,w.CLog("resume"),w.envResume(),_&&(_._call[w.id]=function(u,S){w.state==1&&w.envIn(u,S)},function(u){u._na&&u._na(),u._ra&&u._ra()}(_)))},_stop:function(w){var _=this,u=_.set;_.isMock||_._S++,_.state&&(_.pause(),_.state=0),!w&&_[u.type+"_stop"]&&(_[u.type+"_stop"](_.engineCtx),_.engineCtx=0)},stop:function(w,_,u){var S,y=this,C=y.set,T=y.envInLast-y.envInFirst,Y=T&&y.buffers.length;y.CLog(Z("Xq4s::stop 和start时差:")+(T?T+"ms "+Z("3CQP::补偿:")+y.envInFix+"ms envIn:"+Y+" fps:"+(Y/T*1e3).toFixed(1):"-")+" stream:"+y._streamTag+" ("+y1+") LM:"+j1);var X=function(){y._stop(),u&&y.close()},I=function(t){y.CLog(Z("u8JG::结束录音失败：")+t,1),_&&_(t),X()},v=function(t,r,a){var n="arraybuffer",s="dataType",f="DefaultDataType",p=y[s]||H[f]||"blob",l=s+"="+p,o=t instanceof ArrayBuffer,i=0,c=o?t.byteLength:t.size;if(p==n?o||(i=1):p=="blob"?typeof Blob!="function"?i=Z.G("NonBrowser-1",[l])+Z("1skY::，请设置{1}",0,S1+"."+f+'="'+n+'"'):(o&&(t=new Blob([t],{type:r})),t instanceof Blob||(i=1),r=t.type||r):i=Z.G("NotSupport-1",[l]),y.CLog(Z("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-S,a,c)+" "+l+","+r),i)I(i!=1?i:Z("Vkbd::{1}编码器返回的不是{2}",0,C.type,p)+", "+l);else{if(C.takeoffEncodeChunk)y.CLog(Z("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(c<Math.max(50,a/5))return void I(Z("Sz2H::生成的{1}无效",0,C.type));w&&w(t,a,r),X()}};if(!y.isMock){var O=y.state==3;if(!y.state||O)return void I(Z("wf9t::未开始录音")+(O?Z("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""))}y._stop(!0);var W=y.recSize;if(W)if(y[C.type]){if(y.isMock){var r1=y.envCheck(y.mockEnvInfo||{envName:"mock",canProcess:!1});if(r1)return void I(Z("AxOH::录音错误：")+r1)}var $=y.engineCtx;if(y[C.type+"_complete"]&&$){var t1=Math.round($.pcmSize/C[p1]*1e3);return S=Date.now(),void y[C.type+"_complete"]($,function(t,r){v(t,r,t1)},I)}if(S=Date.now(),y.buffers[0]){var R=H.SampleData(y.buffers,y[L1],C[p1]);C[p1]=R[p1];var e=R.data,t1=Math.round(e.length/C[p1]*1e3);y.CLog(Z("CxeT::采样:{1} 花:{2}ms",0,W+"->"+e.length,Date.now()-S)),setTimeout(function(){S=Date.now(),y[C.type](e,function(r,a){v(r,a,t1)},function(r){I(r)})})}else I(Z("xkKd::音频buffers被释放"))}else I(Z("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,C.type,S1));else I(Z("Ltz3::未采集到录音"))}};var C1=function(w,_){_.pos||(_.pos=[0],_.tracks={},_.bytes=[]);var u=_.tracks,S=[_.pos[0]],y=function(){_.pos[0]=S[0]},C=_.bytes.length,T=new Uint8Array(C+w.length);if(T.set(_.bytes),T.set(w,C),_.bytes=T,!_._ht){if(x1(T,S),b(T,S),!h1(x1(T,S),[24,83,128,103]))return;for(x1(T,S);S[0]<T.length;){var Y=x1(T,S),X=b(T,S),I=[0],v=0;if(!X)return;if(h1(Y,[22,84,174,107])){for(;I[0]<X.length;){var O=x1(X,I),W=b(X,I),r1=[0],$={channels:0,sampleRate:0};if(h1(O,[174]))for(;r1[0]<W.length;){var t1=x1(W,r1),R=b(W,r1),e=[0];if(h1(t1,[215])){var t=I1(R);$.number=t,u[t]=$}else if(h1(t1,[131])){var t=I1(R);t==1?$.type="video":t==2?($.type="audio",v||(_.track0=$),$.idx=v++):$.type="Type-"+t}else if(h1(t1,[134])){for(var r="",a=0;a<R.length;a++)r+=String.fromCharCode(R[a]);$.codec=r}else if(h1(t1,[225]))for(;e[0]<R.length;){var n=x1(R,e),s=b(R,e);if(h1(n,[181])){var t=0,f=new Uint8Array(s.reverse()).buffer;s.length==4?t=new Float32Array(f)[0]:s.length==8?t=new Float64Array(f)[0]:g1("WebM Track !Float",1,s),$[p1]=Math.round(t)}else h1(n,[98,100])?$.bitDepth=I1(s):h1(n,[159])&&($.channels=I1(s))}}}_._ht=1,g1("WebM Tracks",u),y();break}}}var p=_.track0;if(p){if(p.bitDepth==16&&/FLOAT/i.test(p.codec)&&(p.bitDepth=32,g1("WebM 16->32 bit",3)),p[p1]!=_[p1]||p.bitDepth!=32||p.channels<1||!/(\b|_)PCM\b/i.test(p.codec))return _.bytes=[],_.bad||g1("WebM Track Unexpected",3,_),-(_.bad=1);for(var l=[],o=0;S[0]<T.length;){var O=x1(T,S),W=b(T,S);if(!W)break;if(h1(O,[163])){var i=15&W[0],$=u[i];if($){if($.idx===0){for(var c=new Uint8Array(W.length-4),a=4;a<W.length;a++)c[a-4]=W[a];l.push(c),o+=c.length}}else g1("WebM !Track"+i,1,u)}y()}if(o){var m=new Uint8Array(T.length-_.pos[0]);m.set(T.subarray(_.pos[0])),_.bytes=m,_.pos[0]=0;for(var c=new Uint8Array(o),a=0,h=0;a<l.length;a++)c.set(l[a],h),h+=l[a].length;var f=new Float32Array(c.buffer);if(1<p.channels){for(var g=[],a=0;a<f.length;)g.push(f[a]),a+=p.channels;f=new Float32Array(g)}return f}}},h1=function(w,_){if(!w||w.length!=_.length)return!1;if(w.length==1)return w[0]==_[0];for(var u=0;u<w.length;u++)if(w[u]!=_[u])return!1;return!0},I1=function(w){for(var _="",u=0;u<w.length;u++){var S=w[u];_+=(S<16?"0":"")+S.toString(16)}return parseInt(_,16)||0},x1=function(w,_,u){var S=_[0];if(!(S>=w.length)){var y=w[S],C=("0000000"+y.toString(2)).substr(-8),T=/^(0*1)(\d*)$/.exec(C);if(T){var Y=T[1].length,X=[];if(!(S+Y>w.length)){for(var I=0;I<Y;I++)X[I]=w[S],S++;return u&&(X[0]=parseInt(T[2]||"0",2)),_[0]=S,X}}}},b=function(w,_){var u=x1(w,_,1);if(u){var S=I1(u),y=_[0],C=[];if(S<2147483647){if(y+S>w.length)return;for(var T=0;T<S;T++)C[T]=w[y],y++}return _[0]=y,C}},_1=H.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(w,_){var u=S1+".i18n.put: ",S=w.overwrite;S=S==null||S;var y=w.lang;if(!(y=_1.alias[y]||y))throw new Error(u+"set.lang?");var C=_1.locales[y];C||(C={},_1.locales[y]=C);for(var T,Y=/^([\w\-]+):/,X=0;X<_.length;X++){var I=_[X];if(T=Y.exec(I)){var v=T[1],I=I.substr(v.length+1);!S&&C[v]||(C[v]=I)}else g1(u+"'key:'? "+I,3,w)}},get:function(){return _1.v_G.apply(null,arguments)},v_G:function(w,_,u){_=_||[],u=u||_1.lang,u=_1.alias[u]||u;var S=_1.locales[u],y=S&&S[w]||"";return y||u=="zh"?(_1.lastLang=u,y=="=Empty"?"":y.replace(/\{(\d+)(\!?)\}/g,function(C,T,Y){return C=_[(T=+T||0)-1],(T<1||T>_.length)&&(C="{?}",g1("i18n["+w+"] no {"+T+"}: "+y,3)),Y?"":C})):u=="en"?_1.v_G(w,_,"zh"):_1.v_G(w,_,"en")},$T:function(){return _1.v_T.apply(null,arguments)},v_T:function(){for(var w,_=arguments,u="",S=[],y=0,C=S1+".i18n.$T:",T=/^([\w\-]*):/,Y=0;Y<_.length;Y++){var X=_[Y];if(Y==0){if(w=T.exec(X),!(u=w&&w[1]))throw new Error(C+"0 'key:'?");X=X.substr(u.length+1)}if(y===-1)S.push(X);else{if(y)throw new Error(C+" bad args");if(X===0)y=-1;else if(f1(X)){if(X<1)throw new Error(C+" bad args");y=X}else{var I=Y==1?"en":Y?"":"zh";if((w=T.exec(X))&&(I=w[1]||I,X=X.substr(w[1].length+1)),!w||!I)throw new Error(C+Y+" 'lang:'?");_1.put({lang:I,overwrite:!1},[u+":"+X])}}}return u?0<y?u:_1.v_G(u,S):""}},Z=_1.$T;Z.G=_1.get,Z("NonBrowser-1::非浏览器环境，不支持{1}",1),Z("IllegalArgs-1::参数错误：{1}",1),Z("NeedImport-2::调用{1}需要先导入{2}",2),Z("NotSupport-1::不支持：{1}",1),H.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var N1=H.Traffic=function(w){if(A1){w=w?"/"+S1+"/Report/"+w:"";var _=H.TrafficImgUrl;if(_){var u=H.Traffic,S=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],y=S[1]||"http://file/",C=(S[0]||y)+w;if(_.indexOf("//")==0&&(_=/^https:/i.test(C)?"https:"+_:"http:"+_),w&&(_=_+"&cu="+encodeURIComponent(y+w)),!u[C]){u[C]=1;var T=new Image;T.src=_,g1("Traffic Analysis Image: "+(w||S1+".TrafficImgUrl="+H.TrafficImgUrl))}}}};c1&&(g1(Z("8HO5::覆盖导入{1}",0,S1),1),c1.Destroy()),Q[S1]=H})(z1,T1),F1.exports&&(F1.exports=z1.Recorder)})(),function(q1){var T1=typeof window=="object"&&!!window.document,z1=(T1?window:Object).Recorder,Q=z1.i18n;(function(A1,Z1,f1,H){var j1="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",y1="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";A1.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return f1("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,j1,y1)}};var S1,d1=function(E){var n1=E.bitRate,l1=E.sampleRate,u1=l1;if((" "+y1+",").indexOf(" "+n1+",")==-1&&A1.CLog(f1("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+n1,y1),3),(" "+j1+",").indexOf(" "+l1+",")==-1){for(var M1=j1.split(", "),m1=[],o1=0;o1<M1.length;o1++)m1.push({v:+M1[o1],s:Math.abs(M1[o1]-l1)});m1.sort(function(k,g1){return k.s-g1.s}),u1=m1[0].v,E.sampleRate=u1,A1.CLog(f1("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,u1,l1,j1),3)}},L1=function(){return f1.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},p1=H&&typeof Worker=="function";A1.prototype.mp3=function(E,n1,l1){var u1=this,M1=u1.set,m1=E.length;if(A1.lamejs){if(p1){var o1=u1.mp3_start(M1);if(o1){if(o1.isW)return u1.mp3_encode(o1,E),void u1.mp3_complete(o1,n1,l1,1);u1.mp3_stop(o1)}}d1(M1);var k=new A1.lamejs.Mp3Encoder(1,M1.sampleRate,M1.bitRate),g1=new Int8Array(5e5),O1=0,B1=0,E1=function(){try{if(B1<m1)var C1=k.encodeBuffer(E.subarray(B1,B1+57600));else var C1=k.flush()}catch(_1){return console.error(_1),void l1("MP3 Encoder: "+_1.message)}var h1=C1.length;if(0<h1){if(O1+h1>g1.length){var I1=new Int8Array(g1.length+Math.max(5e5,h1));I1.set(g1.subarray(0,O1)),g1=I1}g1.set(C1,O1),O1+=h1}if(B1<m1)B1+=57600,setTimeout(E1);else{var x1=[g1.buffer.slice(0,O1)],b=c1.fn(x1,O1,m1,M1.sampleRate);R1(b,M1),n1(x1[0]||new ArrayBuffer(0),"audio/mp3")}};E1()}else l1(L1())},A1.BindDestroy("mp3Worker",function(){S1&&(A1.CLog("mp3Worker Destroy"),S1.terminate(),S1=null)}),A1.prototype.mp3_envCheck=function(E,n1){var l1="";return n1.takeoffEncodeChunk&&(v1()||(l1=f1("yhUs::当前浏览器版本太低，无法实时处理"))),l1||A1.lamejs||(l1=L1()),l1},A1.prototype.mp3_start=function(E){return v1(E)};var k1={id:0},v1=function(E,n1){var l1,u1=function(C1){var h1=C1.data,I1=l1.wkScope.wk_ctxs,x1=l1.wkScope.wk_lame,b=l1.wkScope.wk_mp3TrimFix,_1=I1[h1.id];if(h1.action=="init")I1[h1.id]={sampleRate:h1.sampleRate,bitRate:h1.bitRate,takeoff:h1.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new x1.Mp3Encoder(1,h1.sampleRate,h1.bitRate)};else if(!_1)return;var Z=function(u){var S=u.length;if(_1.mOffset+S>_1.memory.length){var y=new Int8Array(_1.memory.length+Math.max(5e5,S));y.set(_1.memory.subarray(0,_1.mOffset)),_1.memory=y}_1.memory.set(u,_1.mOffset),_1.mOffset+=S};switch(h1.action){case"stop":_1.encObj=null,delete I1[h1.id];break;case"encode":_1.pcmSize+=h1.pcm.length;try{var N1=_1.encObj.encodeBuffer(h1.pcm)}catch(u){_1.err=u,console.error(u)}N1&&0<N1.length&&(_1.takeoff?o1.onmessage({action:"takeoff",id:h1.id,chunk:N1}):Z(N1));break;case"complete":try{var N1=_1.encObj.flush()}catch(u){_1.err=u,console.error(u)}if(N1&&0<N1.length&&(_1.takeoff?o1.onmessage({action:"takeoff",id:h1.id,chunk:N1}):Z(N1)),_1.err){o1.onmessage({action:h1.action,id:h1.id,err:"MP3 Encoder: "+_1.err.message});break}var w=[_1.memory.buffer.slice(0,_1.mOffset)],_=b.fn(w,_1.mOffset,_1.pcmSize,_1.sampleRate);o1.onmessage({action:h1.action,id:h1.id,blob:w[0]||new ArrayBuffer(0),meta:_})}},M1=function(C1){o1.onmessage=function(h1){var I1=h1;C1&&(I1=h1.data);var x1=k1[I1.id];x1&&(I1.action=="takeoff"?x1.set.takeoffEncodeChunk(new Uint8Array(I1.chunk.buffer)):(x1.call&&x1.call(I1),x1.call=null))}},m1=function(){var C1={worker:o1,set:E};return E?(C1.id=++k1.id,k1[C1.id]=C1,d1(E),o1.postMessage({action:"init",id:C1.id,sampleRate:E.sampleRate,bitRate:E.bitRate,takeoff:!!E.takeoffEncodeChunk,x:new Int16Array(5)})):o1.postMessage({x:new Int16Array(5)}),C1},o1=S1;if(n1||!p1)return A1.CLog(f1("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),o1={postMessage:function(C1){u1({data:C1})}},l1={wkScope:{wk_ctxs:{},wk_lame:A1.lamejs,wk_mp3TrimFix:c1}},M1(),m1();try{if(!o1){var k=(u1+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage"),g1=");wk_lame();self.onmessage="+(k=k.replace(/[\w\$]+\.wkScope/g,"wkScope"));g1+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",g1+=",wk_mp3TrimFix:{rm:"+c1.rm+",fn:"+c1.fn+"} }";var O1=A1.lamejs.toString(),B1=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",O1,g1],{type:"text/javascript"}));o1=new Worker(B1),setTimeout(function(){(window.URL||webkitURL).revokeObjectURL(B1)},1e4),M1(1)}var E1=m1();return E1.isW=1,S1=o1,E1}catch(C1){return o1&&o1.terminate(),console.error(C1),v1(E,1)}};A1.prototype.mp3_stop=function(E){if(E&&E.worker){E.worker.postMessage({action:"stop",id:E.id}),E.worker=null,delete k1[E.id];var n1=-1;for(var l1 in k1)n1++;n1&&A1.CLog(f1("fT6M::mp3 worker剩{1}个未stop",0,n1),3)}},A1.prototype.mp3_encode=function(E,n1){E&&E.worker&&E.worker.postMessage({action:"encode",id:E.id,pcm:n1})},A1.prototype.mp3_complete=function(E,n1,l1,u1){var M1=this;E&&E.worker?(E.call=function(m1){u1&&M1.mp3_stop(E),m1.err?l1(m1.err):(R1(m1.meta,E.set),n1(m1.blob,"audio/mp3"))},E.worker.postMessage({action:"complete",id:E.id})):l1(f1("mPxH::mp3编码器未start"))},A1.mp3ReadMeta=function(E,n1){var l1=typeof window<"u"&&window.parseInt||typeof self<"u"&&self.parseInt||parseInt,u1=new Uint8Array(E[0]||[]);if(u1.length<4)return null;var M1=function(u,S){return("0000000"+((S||u1)[u]||0).toString(2)).substr(-8)},m1=M1(0)+M1(1),o1=M1(2)+M1(3);if(!/^1{11}/.test(m1))return null;var k={"00":2.5,10:2,11:1}[m1.substr(11,2)],g1={"01":3}[m1.substr(13,2)],O1={1:[44100,48e3,32e3],2:[22050,24e3,16e3],2.5:[11025,12e3,8e3]}[k];O1&&(O1=O1[l1(o1.substr(4,2),2)]);var B1=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][k==1?1:0][l1(o1.substr(0,4),2)];if(!(k&&g1&&B1&&O1))return null;for(var E1=Math.round(8*n1/B1),C1=g1==1?384:g1==2||k==1?1152:576,h1=C1/O1*1e3,I1=Math.floor(C1*B1/8/O1*1e3),x1=0,b=0,_1=0;_1<E.length;_1++){var Z=E[_1];if(b+=Z.byteLength,I1+3<=b){var N1=new Uint8Array(Z),w=Z.byteLength-(b-(I1+3)+1),_=M1(w,N1);x1=_.charAt(6)=="1";break}}return x1&&I1++,{version:k,layer:g1,sampleRate:O1,bitRate:B1,duration:E1,size:n1,hasPadding:x1,frameSize:I1,frameDurationFloat:h1}};var c1={rm:A1.mp3ReadMeta,fn:function(E,n1,l1,u1){var M1=this.rm(E,n1);if(!M1)return{err:"mp3 unknown format"};var m1=Math.round(l1/u1*1e3),o1=Math.floor((M1.duration-m1)/M1.frameDurationFloat);if(0<o1){var k=o1*M1.frameSize-(M1.hasPadding?1:0);n1-=k;for(var g1=0,O1=[],B1=0;B1<E.length;B1++){var E1=E[B1];if(k<=0)break;k>=E1.byteLength?(k-=E1.byteLength,O1.push(E1),E.splice(B1,1),B1--):(E[B1]=E1.slice(k),g1=E1,k=0)}var C1=this.rm(E,n1);if(!C1){g1&&(E[0]=g1);for(var B1=0;B1<O1.length;B1++)E.splice(B1,0,O1[B1]);M1.err="mp3 fix error: 已还原，错误原因不明"}var h1=M1.trimFix={};h1.remove=o1,h1.removeDuration=Math.round(o1*M1.frameDurationFloat),h1.duration=Math.round(8*n1/M1.bitRate)}return M1}},R1=function(E,n1){var l1="MP3 Info: ";(E.sampleRate&&E.sampleRate!=n1.sampleRate||E.bitRate&&E.bitRate!=n1.bitRate)&&(A1.CLog(l1+f1("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+n1.bitRate+"kbps "+n1.sampleRate+"hz","set:"+E.bitRate+"kbps "+E.sampleRate+"hz"),3,n1),n1.sampleRate=E.sampleRate,n1.bitRate=E.bitRate);var u1=E.trimFix;u1?(l1+=f1("iMSm::Fix移除{1}帧",0,u1.remove)+" "+u1.removeDuration+"ms -> "+u1.duration+"ms",2<u1.remove&&(E.err=(E.err?E.err+", ":"")+f1("b9zm::移除帧数过多"))):l1+=(E.duration||"-")+"ms",E.err?A1.CLog(l1,1,E.err,E):A1.CLog(l1,E)}})(z1,0,Q.$T,T1)}(),function(q1){function T1(){var z1=function(_){return Math.log(_)/Math.log(10)},Q=function(_){throw new Error("abort("+_+")")};function A1(_){return new Int8Array(_)}function Z1(_){return new Int16Array(_)}function f1(_){return new Int32Array(_)}function H(_){return new Float32Array(_)}function j1(_){return new Float64Array(_)}function y1(_){if(_.length==1)return H(_[0]);var u=_[0];_=_.slice(1);for(var S=[],y=0;y<u;y++)S.push(y1(_));return S}function S1(_){if(_.length==1)return f1(_[0]);var u=_[0];_=_.slice(1);for(var S=[],y=0;y<u;y++)S.push(S1(_));return S}function d1(_){if(_.length==1)return Z1(_[0]);var u=_[0];_=_.slice(1);for(var S=[],y=0;y<u;y++)S.push(d1(_));return S}function L1(_){if(_.length==1)return new Array(_[0]);var u=_[0];_=_.slice(1);for(var S=[],y=0;y<u;y++)S.push(L1(_));return S}var p1={fill:function(_,u,S,y){if(arguments.length==2)for(var C=0;C<_.length;C++)_[C]=u;else for(var C=u;C<S;C++)_[C]=y}},k1={arraycopy:function(_,u,S,y,C){for(var T=u+C;u<T;)S[y++]=_[u++]}},v1={};function c1(_){this.ordinal=_}v1.SQRT2=1.4142135623730951,v1.FAST_LOG10=function(_){return z1(_)},v1.FAST_LOG10_X=function(_,u){return z1(_)*u},c1.short_block_allowed=new c1(0),c1.short_block_coupled=new c1(1),c1.short_block_dispensed=new c1(2),c1.short_block_forced=new c1(3);var R1={};function E(_){this.ordinal=_}function n1(_){var u=_;this.ordinal=function(){return u}}function l1(){var _=null;function u(t){this.bits=0|t}this.qupvt=null,this.setModules=function(t){this.qupvt=t,_=t};var S=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function y(t,r,a,n,s,f){var p=.5946/r;for(t>>=1;t--!=0;)s[f++]=p>a[n++]?0:1,s[f++]=p>a[n++]?0:1}function C(t,r,a,n,s,f){var p=(t>>=1)%2;for(t>>=1;t--!=0;){var l,o,i,c,m,h,g,L;l=a[n++]*r,o=a[n++]*r,m=0|l,i=a[n++]*r,h=0|o,c=a[n++]*r,g=0|i,l+=_.adj43[m],L=0|c,o+=_.adj43[h],s[f++]=0|l,i+=_.adj43[g],s[f++]=0|o,c+=_.adj43[L],s[f++]=0|i,s[f++]=0|c}p!=0&&(l=a[n++]*r,o=a[n++]*r,m=0|l,h=0|o,l+=_.adj43[m],o+=_.adj43[h],s[f++]=0|l,s[f++]=0|o)}var T=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function Y(t,r,a,n){var s=function(l,o,i){var c=0,m=0;do{var h=l[o++],g=l[o++];c<h&&(c=h),m<g&&(m=g)}while(o<i);return c<m&&(c=m),c}(t,r,a);switch(s){case 0:return s;case 1:return function(l,o,i,c){var m=0,h=k.ht[1].hlen;do{var g=2*l[o+0]+l[o+1];o+=2,m+=h[g]}while(o<i);return c.bits+=m,1}(t,r,a,n);case 2:case 3:return function(l,o,i,c,m){var h,g,L=0,x=k.ht[c].xlen;g=c==2?k.table23:k.table56;do{var z=l[o+0]*x+l[o+1];o+=2,L+=g[z]}while(o<i);return(h=65535&L)<(L>>=16)&&(L=h,c++),m.bits+=L,c}(t,r,a,T[s-1],n);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return function(l,o,i,c,m){var h=0,g=0,L=0,x=k.ht[c].xlen,z=k.ht[c].hlen,D=k.ht[c+1].hlen,M=k.ht[c+2].hlen;do{var d=l[o+0]*x+l[o+1];o+=2,h+=z[d],g+=D[d],L+=M[d]}while(o<i);var A=c;return g<h&&(h=g,A++),L<h&&(h=L,A=c+2),m.bits+=h,A}(t,r,a,T[s-1],n);default:var f,p;for(E1.IXMAX_VAL<s&&Q(),s-=15,f=24;f<32&&!(k.ht[f].linmax>=s);f++);for(p=f-8;p<24&&!(k.ht[p].linmax>=s);p++);return function(l,o,i,c,m,h){var g,L=65536*k.ht[c].xlen+k.ht[m].xlen,x=0;do{var z=l[o++],D=l[o++];z!=0&&(14<z&&(z=15,x+=L),z*=16),D!=0&&(14<D&&(D=15,x+=L),z+=D),x+=k.largetbl[z]}while(o<i);return(g=65535&x)<(x>>=16)&&(x=g,c=m),h.bits+=x,c}(t,r,a,p,f,n)}}function X(t,r,a,n,s,f,p,l){for(var o=r.big_values,i=2;i<b.SBMAX_l+1;i++){var c=t.scalefac_band.l[i];if(o<=c)break;var m=s[i-2]+r.count1bits;if(a.part2_3_length<=m)break;var h=new u(m),g=Y(n,c,o,h);m=h.bits,a.part2_3_length<=m||(a.assign(r),a.part2_3_length=m,a.region0_count=f[i-2],a.region1_count=i-2-f[i-2],a.table_select[0]=p[i-2],a.table_select[1]=l[i-2],a.table_select[2]=g)}}this.noquant_count_bits=function(t,r,a){var n=r.l3_enc,s=Math.min(576,r.max_nonzero_coeff+2>>1<<1);for(a!=null&&(a.sfb_count1=0);1<s&&!(n[s-1]|n[s-2]);s-=2);r.count1=s;for(var f=0,p=0;3<s;s-=4){var l;if(1<(2147483647&(n[s-1]|n[s-2]|n[s-3]|n[s-4])))break;l=2*(2*(2*n[s-4]+n[s-3])+n[s-2])+n[s-1],f+=k.t32l[l],p+=k.t33l[l]}var o=f;if(r.count1table_select=0,p<f&&(o=p,r.count1table_select=1),r.count1bits=o,(r.big_values=s)==0)return o;if(r.block_type==b.SHORT_TYPE)(f=3*t.scalefac_band.s[3])>r.big_values&&(f=r.big_values),p=r.big_values;else if(r.block_type==b.NORM_TYPE){if(f=r.region0_count=t.bv_scf[s-2],p=r.region1_count=t.bv_scf[s-1],p=t.scalefac_band.l[f+p+2],f=t.scalefac_band.l[f+1],p<s){var i=new u(o);r.table_select[2]=Y(n,p,s,i),o=i.bits}}else r.region0_count=7,r.region1_count=b.SBMAX_l-1-7-1,f=t.scalefac_band.l[8],(p=s)<f&&(f=p);if(f=Math.min(f,s),p=Math.min(p,s),0<f){var i=new u(o);r.table_select[0]=Y(n,0,f,i),o=i.bits}if(f<p){var i=new u(o);r.table_select[1]=Y(n,f,p,i),o=i.bits}if(t.use_best_huffman==2&&Q(),a!=null&&r.block_type==b.NORM_TYPE){for(var c=0;t.scalefac_band.l[c]<r.big_values;)c++;a.sfb_count1=c}return o},this.count_bits=function(t,r,a,n){var s=a.l3_enc,f=E1.IXMAX_VAL/_.IPOW20(a.global_gain);return a.xrpow_max>f?E1.LARGE_BITS:(function(p,l,o,i,c){var m,h,g,L=0,x=0,z=0,D=0,M=l,d=0,A=M,F=0,j=p,B=0;for(g=c!=null&&i.global_gain==c.global_gain,h=i.block_type==b.SHORT_TYPE?38:21,m=0;m<=h;m++){var P=-1;if((g||i.block_type==b.NORM_TYPE)&&(P=i.global_gain-(i.scalefac[m]+(i.preflag!=0?_.pretab[m]:0)<<i.scalefac_scale+1)-8*i.subblock_gain[i.window[m]]),g&&c.step[m]==P)x!=0&&(C(x,o,j,B,A,F),x=0),z!=0&&Q();else{var V,N=i.width[m];if(L+i.width[m]>i.max_nonzero_coeff&&(V=i.max_nonzero_coeff-L+1,p1.fill(l,i.max_nonzero_coeff,576,0),(N=V)<0&&(N=0),m=h+1),x==0&&z==0&&(A=M,F=d,j=p,B=D),c!=null&&0<c.sfb_count1&&m>=c.sfb_count1&&0<c.step[m]&&P>=c.step[m]?(x!=0&&(C(x,o,j,B,A,F),x=0,A=M,F=d,j=p,B=D),z+=N):(z!=0&&(y(z,o,j,B,A,F),z=0,A=M,F=d,j=p,B=D),x+=N),N<=0){z!=0&&Q(),x!=0&&Q();break}}m<=h&&(d+=i.width[m],D+=i.width[m],L+=i.width[m])}x!=0&&(C(x,o,j,B,A,F),x=0),z!=0&&Q()}(r,s,_.IPOW20(a.global_gain),a,n),2&t.substep_shaping&&Q(),this.noquant_count_bits(t,a,n))},this.best_huffman_divide=function(t,r){var a=new C1,n=r.l3_enc,s=f1(23),f=f1(23),p=f1(23),l=f1(23);if(r.block_type!=b.SHORT_TYPE||t.mode_gr!=1){a.assign(r),r.block_type==b.NORM_TYPE&&(function(g,L,x,z,D,M,d){for(var A=L.big_values,F=0;F<=22;F++)z[F]=E1.LARGE_BITS;for(var F=0;F<16;F++){var j=g.scalefac_band.l[F+1];if(A<=j)break;var B=0,P=new u(B),V=Y(x,0,j,P);B=P.bits;for(var N=0;N<8;N++){var U=g.scalefac_band.l[F+N+2];if(A<=U)break;var a1=B;P=new u(a1);var q=Y(x,j,U,P);a1=P.bits,z[F+N]>a1&&(z[F+N]=a1,D[F+N]=F,M[F+N]=V,d[F+N]=q)}}}(t,r,n,s,f,p,l),X(t,a,r,n,s,f,p,l));var o=a.big_values;if(!(o==0||1<(n[o-2]|n[o-1])||576<(o=r.count1+2))){a.assign(r),a.count1=o;for(var i=0,c=0;o>a.big_values;o-=4){var m=2*(2*(2*n[o-4]+n[o-3])+n[o-2])+n[o-1];i+=k.t32l[m],c+=k.t33l[m]}if(a.big_values=o,a.count1table_select=0,c<i&&(i=c,a.count1table_select=1),a.count1bits=i,a.block_type==b.NORM_TYPE)X(t,a,r,n,s,f,p,l);else{if(a.part2_3_length=i,i=t.scalefac_band.l[8],o<i&&(i=o),0<i){var h=new u(a.part2_3_length);a.table_select[0]=Y(n,0,i,h),a.part2_3_length=h.bits}if(i<o){var h=new u(a.part2_3_length);a.table_select[1]=Y(n,i,o,h),a.part2_3_length=h.bits}r.part2_3_length>a.part2_3_length&&r.assign(a)}}}};var I=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],v=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],O=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],W=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];l1.slen1_tab=O,l1.slen2_tab=W,this.best_scalefac_store=function(t,r,a,n){var s,f,p,l,o=n.tt[r][a],i=0;for(s=p=0;s<o.sfbmax;s++){var c=o.width[s];for(p+=c,l=-c;l<0&&o.l3_enc[l+p]==0;l++);l==0&&(o.scalefac[s]=i=-2)}if(o.scalefac_scale==0&&o.preflag==0){var m=0;for(s=0;s<o.sfbmax;s++)0<o.scalefac[s]&&(m|=o.scalefac[s]);if(!(1&m)&&m!=0){for(s=0;s<o.sfbmax;s++)0<o.scalefac[s]&&(o.scalefac[s]>>=1);o.scalefac_scale=i=1}}if(o.preflag==0&&o.block_type!=b.SHORT_TYPE&&t.mode_gr==2){for(s=11;s<b.SBPSY_l&&!(o.scalefac[s]<_.pretab[s]&&o.scalefac[s]!=-2);s++);if(s==b.SBPSY_l){for(s=11;s<b.SBPSY_l;s++)0<o.scalefac[s]&&(o.scalefac[s]-=_.pretab[s]);o.preflag=i=1}}for(f=0;f<4;f++)n.scfsi[a][f]=0;for(t.mode_gr==2&&r==1&&n.tt[0][a].block_type!=b.SHORT_TYPE&&n.tt[1][a].block_type!=b.SHORT_TYPE&&(function(h,g){for(var L,x=g.tt[1][h],z=g.tt[0][h],D=0;D<k.scfsi_band.length-1;D++){for(L=k.scfsi_band[D];L<k.scfsi_band[D+1]&&!(z.scalefac[L]!=x.scalefac[L]&&0<=x.scalefac[L]);L++);if(L==k.scfsi_band[D+1]){for(L=k.scfsi_band[D];L<k.scfsi_band[D+1];L++)x.scalefac[L]=-1;g.scfsi[h][D]=1}}var M=0,d=0;for(L=0;L<11;L++)x.scalefac[L]!=-1&&(d++,M<x.scalefac[L]&&(M=x.scalefac[L]));for(var A=0,F=0;L<b.SBPSY_l;L++)x.scalefac[L]!=-1&&(F++,A<x.scalefac[L]&&(A=x.scalefac[L]));for(var D=0;D<16;D++)if(M<I[D]&&A<v[D]){var j=O[D]*d+W[D]*F;x.part2_length>j&&(x.part2_length=j,x.scalefac_compress=D)}}(a,n),i=0),s=0;s<o.sfbmax;s++)o.scalefac[s]==-2&&(o.scalefac[s]=0);i!=0&&(t.mode_gr==2?this.scale_bitcount(o):this.scale_bitcount_lsf(t,o))};var r1=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],$=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],t1=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var r,a,n,s=0,f=0,p=t.scalefac;if(t.block_type==b.SHORT_TYPE)n=r1,t.mixed_block_flag!=0&&(n=$);else if(n=t1,t.preflag==0){for(a=11;a<b.SBPSY_l&&!(p[a]<_.pretab[a]);a++);if(a==b.SBPSY_l)for(t.preflag=1,a=11;a<b.SBPSY_l;a++)p[a]-=_.pretab[a]}for(a=0;a<t.sfbdivide;a++)s<p[a]&&(s=p[a]);for(;a<t.sfbmax;a++)f<p[a]&&(f=p[a]);for(t.part2_length=E1.LARGE_BITS,r=0;r<16;r++)s<I[r]&&f<v[r]&&t.part2_length>n[r]&&(t.part2_length=n[r],t.scalefac_compress=r);return t.part2_length==E1.LARGE_BITS};var R=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,r){var a,n,s,f,p,l,o,i,c=f1(4),m=r.scalefac;for(a=r.preflag!=0?2:0,o=0;o<4;o++)c[o]=0;if(r.block_type==b.SHORT_TYPE){n=1;var h=_.nr_of_sfb_block[a][n];for(s=i=0;s<4;s++)for(f=h[s]/3,o=0;o<f;o++,i++)for(p=0;p<3;p++)m[3*i+p]>c[s]&&(c[s]=m[3*i+p])}else{n=0;var h=_.nr_of_sfb_block[a][n];for(s=i=0;s<4;s++)for(f=h[s],o=0;o<f;o++,i++)m[i]>c[s]&&(c[s]=m[i])}for(l=!1,s=0;s<4;s++)c[s]>R[a][s]&&(l=!0);if(!l){var g,L,x,z;for(r.sfb_partition_table=_.nr_of_sfb_block[a][n],s=0;s<4;s++)r.slen[s]=e[c[s]];switch(g=r.slen[0],L=r.slen[1],x=r.slen[2],z=r.slen[3],a){case 0:r.scalefac_compress=(5*g+L<<4)+(x<<2)+z;break;case 1:r.scalefac_compress=400+(5*g+L<<2)+x;break;case 2:r.scalefac_compress=500+3*g+L}}if(!l)for(r.part2_length=0,s=0;s<4;s++)r.part2_length+=r.slen[s]*r.sfb_partition_table[s];return l};var e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(t){for(var r=2;r<=576;r+=2){for(var a,n=0;t.scalefac_band.l[++n]<r;);for(a=S[n][0];t.scalefac_band.l[a+1]>r;)a--;for(a<0&&(a=S[n][0]),t.bv_scf[r-2]=a,a=S[n][1];t.scalefac_band.l[a+t.bv_scf[r-2]+2]>r;)a--;a<0&&(a=S[n][1]),t.bv_scf[r-1]=a}}}function u1(){}function M1(){this.setModules=function(u,S,y){};var _=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];this.updateMusicCRC=function(u,S,y,C){for(var T=0;T<C;++T)u[0]=(Y=S[y+T],X=(X=u[0])>>8^_[255&(X^Y)]);var Y,X}}function m1(){var _=this,u=null,S=null;this.setModules=function(e,t,r,a){u=r,S=a};var y=null,C=0,T=0,Y=0;function X(e,t,r){for(;0<r;){var a;Y==0&&(Y=8,T++,e.header[e.w_ptr].write_timing==C&&(n=e,k1.arraycopy(n.header[n.w_ptr].buf,0,y,T,n.sideinfo_len),T+=n.sideinfo_len,C+=8*n.sideinfo_len,n.w_ptr=n.w_ptr+1&Z.MAX_HEADER_BUF-1),y[T]=0),a=Math.min(r,Y),r-=a,Y-=a,y[T]|=t>>r<<Y,C+=a}var n}function I(e,t){var r,a=e.internal_flags;if(8<=t&&(X(a,76,8),t-=8),8<=t&&(X(a,65,8),t-=8),8<=t&&(X(a,77,8),t-=8),8<=t&&(X(a,69,8),t-=8),32<=t){var n=u.getLameShortVersion();if(32<=t)for(r=0;r<n.length&&8<=t;++r)t-=8,X(a,n.charCodeAt(r),8)}for(;1<=t;t-=1)X(a,a.ancillary_flag,1),a.ancillary_flag^=e.disable_reservoir?0:1}function v(e,t,r){for(var a=e.header[e.h_ptr].ptr;0<r;){var n=Math.min(r,8-(7&a));r-=n,e.header[e.h_ptr].buf[a>>3]|=t>>r<<8-(7&a)-n,a+=n}e.header[e.h_ptr].ptr=a}function O(e,t){var r,a=k.ht[t.count1table_select+32],n=0,s=t.big_values,f=t.big_values;for(r=(t.count1-t.big_values)/4;0<r;--r){var p=0,l=0;t.l3_enc[s+0]!=0&&(l+=8,t.xr[f+0]<0&&p++),t.l3_enc[s+1]!=0&&(l+=4,p*=2,t.xr[f+1]<0&&p++),t.l3_enc[s+2]!=0&&(l+=2,p*=2,t.xr[f+2]<0&&p++),t.l3_enc[s+3]!=0&&(l++,p*=2,t.xr[f+3]<0&&p++),s+=4,f+=4,X(e,p+a.table[l],a.hlen[l]),n+=a.hlen[l]}return n}function W(e,t,r,a,n){var s=k.ht[t],f=0;if(t==0)return f;for(var p=r;p<a;p+=2){var l=0,o=0,i=s.xlen,c=s.xlen,m=0,h=n.l3_enc[p],g=n.l3_enc[p+1];if(h!=0&&(n.xr[p]<0&&m++,l--),15<t){if(14<h){var L=h-15;m|=L<<1,o=i,h=15}if(14<g){var x=g-15;m<<=i,m|=x,o+=i,g=15}c=16}g!=0&&(m<<=1,n.xr[p+1]<0&&m++,l--),h=h*c+g,o-=l,l+=s.hlen[h],X(e,s.table[h],l),X(e,m,o),f+=l+o}return f}function r1(e,t){var r=3*e.scalefac_band.s[3];r>t.big_values&&(r=t.big_values);var a=W(e,t.table_select[0],0,r,t);return a+=W(e,t.table_select[1],r,t.big_values,t)}function $(e,t){var r,a,n,s;r=t.big_values;var f=t.region0_count+1;return n=e.scalefac_band.l[f],f+=t.region1_count+1,s=e.scalefac_band.l[f],r<n&&(n=r),r<s&&(s=r),a=W(e,t.table_select[0],0,n,t),a+=W(e,t.table_select[1],n,s,t),a+=W(e,t.table_select[2],s,r,t)}function t1(){this.total=0}function R(e,t){var r,a,n,s=e.internal_flags;return s.w_ptr,(n=s.h_ptr-1)==-1&&(n=Z.MAX_HEADER_BUF-1),r=s.header[n].write_timing-C,0<=(t.total=r)&&Q(),a=_.getframebits(e),r+=a,t.total+=a,t.total%8!=0?t.total=1+t.total/8:t.total=t.total/8,t.total+=T+1,r}this.getframebits=function(e){var t,r=e.internal_flags;t=r.bitrate_index!=0?k.bitrate_table[e.version][r.bitrate_index]:e.brate;var a=0|72e3*(e.version+1)*t/e.out_samplerate+r.padding;return 8*a},this.flush_bitstream=function(e){var t,r,a=e.internal_flags;a.h_ptr-1,t=a.l3_side,(r=R(e,new t1))<0||(I(e,r),a.ResvSize=0,t.main_data_begin=0,a.findReplayGain&&Q(),a.findPeakSample&&Q())},this.format_bitstream=function(e){var t,r=e.internal_flags;t=r.l3_side;var a=this.getframebits(e);I(e,t.resvDrain_pre),function(f,p){var l,o,i,c=f.internal_flags;if(l=c.l3_side,c.header[c.h_ptr].ptr=0,p1.fill(c.header[c.h_ptr].buf,0,c.sideinfo_len,0),f.out_samplerate<16e3?v(c,4094,12):v(c,4095,12),v(c,f.version,1),v(c,1,2),v(c,f.error_protection?0:1,1),v(c,c.bitrate_index,4),v(c,c.samplerate_index,2),v(c,c.padding,1),v(c,f.extension,1),v(c,f.mode.ordinal(),2),v(c,c.mode_ext,2),v(c,f.copyright,1),v(c,f.original,1),v(c,f.emphasis,2),f.error_protection&&v(c,0,16),f.version==1){for(v(c,l.main_data_begin,9),c.channels_out==2?v(c,l.private_bits,3):v(c,l.private_bits,5),i=0;i<c.channels_out;i++){var m;for(m=0;m<4;m++)v(c,l.scfsi[i][m],1)}for(o=0;o<2;o++)for(i=0;i<c.channels_out;i++){var h=l.tt[o][i];v(c,h.part2_3_length+h.part2_length,12),v(c,h.big_values/2,9),v(c,h.global_gain,8),v(c,h.scalefac_compress,4),h.block_type!=b.NORM_TYPE?(v(c,1,1),v(c,h.block_type,2),v(c,h.mixed_block_flag,1),h.table_select[0]==14&&(h.table_select[0]=16),v(c,h.table_select[0],5),h.table_select[1]==14&&(h.table_select[1]=16),v(c,h.table_select[1],5),v(c,h.subblock_gain[0],3),v(c,h.subblock_gain[1],3),v(c,h.subblock_gain[2],3)):(v(c,0,1),h.table_select[0]==14&&(h.table_select[0]=16),v(c,h.table_select[0],5),h.table_select[1]==14&&(h.table_select[1]=16),v(c,h.table_select[1],5),h.table_select[2]==14&&(h.table_select[2]=16),v(c,h.table_select[2],5),v(c,h.region0_count,4),v(c,h.region1_count,3)),v(c,h.preflag,1),v(c,h.scalefac_scale,1),v(c,h.count1table_select,1)}}else for(v(c,l.main_data_begin,8),v(c,l.private_bits,c.channels_out),i=o=0;i<c.channels_out;i++){var h=l.tt[o][i];v(c,h.part2_3_length+h.part2_length,12),v(c,h.big_values/2,9),v(c,h.global_gain,8),v(c,h.scalefac_compress,9),h.block_type!=b.NORM_TYPE?(v(c,1,1),v(c,h.block_type,2),v(c,h.mixed_block_flag,1),h.table_select[0]==14&&(h.table_select[0]=16),v(c,h.table_select[0],5),h.table_select[1]==14&&(h.table_select[1]=16),v(c,h.table_select[1],5),v(c,h.subblock_gain[0],3),v(c,h.subblock_gain[1],3),v(c,h.subblock_gain[2],3)):(v(c,0,1),h.table_select[0]==14&&(h.table_select[0]=16),v(c,h.table_select[0],5),h.table_select[1]==14&&(h.table_select[1]=16),v(c,h.table_select[1],5),h.table_select[2]==14&&(h.table_select[2]=16),v(c,h.table_select[2],5),v(c,h.region0_count,4),v(c,h.region1_count,3)),v(c,h.scalefac_scale,1),v(c,h.count1table_select,1)}f.error_protection&&Q();var g=c.h_ptr;c.h_ptr=g+1&Z.MAX_HEADER_BUF-1,c.header[c.h_ptr].write_timing=c.header[g].write_timing+p,c.h_ptr,c.w_ptr}(e,a);var n=8*r.sideinfo_len;if(n+=function(f){var p,l,o,i,c=0,m=f.internal_flags,h=m.l3_side;if(f.version==1)for(p=0;p<2;p++)for(l=0;l<m.channels_out;l++){var g=h.tt[p][l],L=l1.slen1_tab[g.scalefac_compress],x=l1.slen2_tab[g.scalefac_compress];for(o=i=0;o<g.sfbdivide;o++)g.scalefac[o]!=-1&&(X(m,g.scalefac[o],L),i+=L);for(;o<g.sfbmax;o++)g.scalefac[o]!=-1&&(X(m,g.scalefac[o],x),i+=x);g.block_type==b.SHORT_TYPE?i+=r1(m,g):i+=$(m,g),i+=O(m,g),c+=i}else for(l=p=0;l<m.channels_out;l++){var z,D,g=h.tt[p][l],M=0;if(D=o=i=0,g.block_type==b.SHORT_TYPE){for(;D<4;D++){var d=g.sfb_partition_table[D]/3,A=g.slen[D];for(z=0;z<d;z++,o++)X(m,Math.max(g.scalefac[3*o+0],0),A),X(m,Math.max(g.scalefac[3*o+1],0),A),X(m,Math.max(g.scalefac[3*o+2],0),A),M+=3*A}i+=r1(m,g)}else{for(;D<4;D++){var d=g.sfb_partition_table[D],A=g.slen[D];for(z=0;z<d;z++,o++)X(m,Math.max(g.scalefac[o],0),A),M+=A}i+=$(m,g)}i+=O(m,g),c+=M+i}return c}(e),I(e,t.resvDrain_post),n+=t.resvDrain_post,t.main_data_begin+=(a-n)/8,R(e,new t1),r.ResvSize,8*t.main_data_begin!=r.ResvSize&&(r.ResvSize=8*t.main_data_begin),1e9<C){var s;for(s=0;s<Z.MAX_HEADER_BUF;++s)r.header[s].write_timing-=C;C=0}return 0},this.copy_buffer=function(e,t,r,a,n){var s=T+1;if(s<=0)return 0;if(a!=0&&a<s)return-1;if(k1.arraycopy(y,0,t,r,s),T=-1,(Y=0)!=n){var f=f1(1);f[0]=e.nMusicCRC,S.updateMusicCRC(f,t,r,s),e.nMusicCRC=f[0],0<s&&(e.VBR_seek_table.nBytesWritten+=s),e.decode_on_the_fly&&Q()}return s},this.init_bit_stream_w=function(e){y=A1(w.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,T=-1,C=Y=0}}function o1(_,u,S,y){this.xlen=_,this.linmax=u,this.table=S,this.hlen=y}R1.MAX_VALUE=34028235e31,E.vbr_off=new E(0),E.vbr_mt=new E(1),E.vbr_rh=new E(2),E.vbr_abr=new E(3),E.vbr_mtrh=new E(4),E.vbr_default=E.vbr_mtrh,n1.STEREO=new n1(0),n1.JOINT_STEREO=new n1(1),n1.DUAL_CHANNEL=new n1(2),n1.MONO=new n1(3),n1.NOT_SET=new n1(4),u1.STEPS_per_dB=100,u1.MAX_dB=120,u1.GAIN_NOT_ENOUGH_SAMPLES=-24601,u1.GAIN_ANALYSIS_ERROR=0,u1.GAIN_ANALYSIS_OK=1,u1.INIT_GAIN_ANALYSIS_ERROR=0,u1.INIT_GAIN_ANALYSIS_OK=1,u1.MAX_ORDER=u1.YULE_ORDER=10,u1.MAX_SAMPLES_PER_WINDOW=(u1.MAX_SAMP_FREQ=48e3)*(u1.RMS_WINDOW_TIME_NUMERATOR=1)/(u1.RMS_WINDOW_TIME_DENOMINATOR=20)+1,M1.NUMTOCENTRIES=100,M1.MAXFRAMESIZE=2880,m1.EQ=function(_,u){return Math.abs(_)>Math.abs(u)?Math.abs(_-u)<=1e-6*Math.abs(_):Math.abs(_-u)<=1e-6*Math.abs(u)},m1.NEQ=function(_,u){return!m1.EQ(_,u)};var k={};function g1(_){this.bits=_}function O1(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function B1(_,u,S,y){this.l=f1(1+b.SBMAX_l),this.s=f1(1+b.SBMAX_s),this.psfb21=f1(1+b.PSFB21),this.psfb12=f1(1+b.PSFB12);var C=this.l,T=this.s;arguments.length==4&&(this.arrL=_,this.arrS=u,this.arr21=S,this.arr12=y,k1.arraycopy(this.arrL,0,C,0,Math.min(this.arrL.length,this.l.length)),k1.arraycopy(this.arrS,0,T,0,Math.min(this.arrS.length,this.s.length)),k1.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),k1.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function E1(){var _=null,u=null,S=null;this.setModules=function(e,t,r){_=e,u=t,S=r},this.IPOW20=function(e){return W[e]};var y=2220446049250313e-31,C=E1.IXMAX_VAL,T=C+2,Y=E1.Q_MAX,X=E1.Q_MAX2,I=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var v=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=v,this.sfBandIndex=[new B1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new B1([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var O=H(Y+X+1),W=H(Y),r1=H(T),$=H(T);function t1(e,t){var r=S.ATHformula(t,e);return r-=I,r=Math.pow(10,r/10+e.ATHlower)}function R(e){this.s=e}this.adj43=$,this.iteration_init=function(e){var t,r=e.internal_flags,a=r.l3_side;if(r.iteration_init_init==0){for(r.iteration_init_init=1,a.main_data_begin=0,function(o){for(var i=o.internal_flags.ATH.l,c=o.internal_flags.ATH.psfb21,m=o.internal_flags.ATH.s,h=o.internal_flags.ATH.psfb12,g=o.internal_flags,L=o.out_samplerate,x=0;x<b.SBMAX_l;x++){var z=g.scalefac_band.l[x],D=g.scalefac_band.l[x+1];i[x]=R1.MAX_VALUE;for(var M=z;M<D;M++){var d=M*L/1152,A=t1(o,d);i[x]=Math.min(i[x],A)}}for(var x=0;x<b.PSFB21;x++){var z=g.scalefac_band.psfb21[x],D=g.scalefac_band.psfb21[x+1];c[x]=R1.MAX_VALUE;for(var M=z;M<D;M++){var d=M*L/1152,A=t1(o,d);c[x]=Math.min(c[x],A)}}for(var x=0;x<b.SBMAX_s;x++){var z=g.scalefac_band.s[x],D=g.scalefac_band.s[x+1];m[x]=R1.MAX_VALUE;for(var M=z;M<D;M++){var d=M*L/384,A=t1(o,d);m[x]=Math.min(m[x],A)}m[x]*=g.scalefac_band.s[x+1]-g.scalefac_band.s[x]}for(var x=0;x<b.PSFB12;x++){var z=g.scalefac_band.psfb12[x],D=g.scalefac_band.psfb12[x+1];h[x]=R1.MAX_VALUE;for(var M=z;M<D;M++){var d=M*L/384,A=t1(o,d);h[x]=Math.min(h[x],A)}h[x]*=g.scalefac_band.s[13]-g.scalefac_band.s[12]}o.noATH&&Q(),g.ATH.floor=10*z1(t1(o,-1))}(e),r1[0]=0,t=1;t<T;t++)r1[t]=Math.pow(t,4/3);for(t=0;t<T-1;t++)$[t]=t+1-Math.pow(.5*(r1[t]+r1[t+1]),.75);for($[t]=.5,t=0;t<Y;t++)W[t]=Math.pow(2,-.1875*(t-210));for(t=0;t<=Y+X;t++)O[t]=Math.pow(2,.25*(t-210-X));var n,s,f,p;for(_.huffman_init(r),32<=(t=e.exp_nspsytune>>2&63)&&(t-=64),n=Math.pow(10,t/4/10),32<=(t=e.exp_nspsytune>>8&63)&&(t-=64),s=Math.pow(10,t/4/10),32<=(t=e.exp_nspsytune>>14&63)&&(t-=64),f=Math.pow(10,t/4/10),32<=(t=e.exp_nspsytune>>20&63)&&(t-=64),p=f*Math.pow(10,t/4/10),t=0;t<b.SBMAX_l;t++)l=t<=6?n:t<=13?s:t<=20?f:p,r.nsPsy.longfact[t]=l;for(t=0;t<b.SBMAX_s;t++){var l;l=t<=5?n:t<=10?s:t<=11?f:p,r.nsPsy.shortfact[t]=l}}},this.on_pe=function(e,t,r,a,n,s){var f,p,l=e.internal_flags,o=0,i=f1(2),c=new g1(o),m=u.ResvMaxBits(e,a,c,s),h=(o=c.bits)+m;for(Z.MAX_BITS_PER_GRANULE<h&&(h=Z.MAX_BITS_PER_GRANULE),p=f=0;p<l.channels_out;++p)r[p]=Math.min(Z.MAX_BITS_PER_CHANNEL,o/l.channels_out),i[p]=0|r[p]*t[n][p]/700-r[p],i[p]>3*a/4&&(i[p]=3*a/4),i[p]<0&&(i[p]=0),i[p]+r[p]>Z.MAX_BITS_PER_CHANNEL&&(i[p]=Math.max(0,Z.MAX_BITS_PER_CHANNEL-r[p])),f+=i[p];if(m<f)for(p=0;p<l.channels_out;++p)i[p]=m*i[p]/f;for(p=0;p<l.channels_out;++p)r[p]+=i[p],m-=i[p];for(p=f=0;p<l.channels_out;++p)f+=r[p];return Z.MAX_BITS_PER_GRANULE<f&&Q(),h},this.athAdjust=function(e,t,r){var a=90.30873362,n=v1.FAST_LOG10_X(t,10),s=e*e,f=0;return n-=r,1e-20<s&&(f=1+v1.FAST_LOG10_X(s,10/a)),f<0&&(f=0),n*=f,n+=r+a-94.82444863,Math.pow(10,.1*n)},this.calc_xmin=function(e,t,r,a){var n,s=0,f=e.internal_flags,p=0,l=0,o=f.ATH,i=r.xr,c=e.VBR==E.vbr_mtrh?1:0,m=f.masking_lower;for(e.VBR!=E.vbr_mtrh&&e.VBR!=E.vbr_mt||(m=1),n=0;n<r.psy_lmax;n++){for(d=e.VBR==E.vbr_rh||e.VBR==E.vbr_mtrh?athAdjust(o.adjust,o.l[n],o.floor):o.adjust*o.l[n],z=r.width[n],A=d/z,F=y,B=z>>1,j=0;P=i[p]*i[p],j+=P,F+=P<A?P:A,V=i[++p]*i[p],j+=V,F+=V<A?V:A,p++,0<--B;);if(d<j&&l++,n==b.SBPSY_l&&Q(),c!=0&&(d=F),!e.ATHonly){var h=t.en.l[n];0<h&&(N=j*t.thm.l[n]*m/h,c!=0&&(N*=f.nsPsy.longfact[n]),d<N&&(d=N))}a[s++]=c!=0?d:d*f.nsPsy.longfact[n]}var g=575;if(r.block_type!=b.SHORT_TYPE)for(var L=576;L--!=0&&m1.EQ(i[L],0);)g=L;r.max_nonzero_coeff=g;for(var x=r.sfb_smin;n<r.psymax;x++,n+=3){var z,D,M;for(M=e.VBR==E.vbr_rh||e.VBR==E.vbr_mtrh?athAdjust(o.adjust,o.s[x],o.floor):o.adjust*o.s[x],z=r.width[n],D=0;D<3;D++){var d,A,F,j=0,B=z>>1;A=M/z,F=y;do{var P,V;P=i[p]*i[p],j+=P,F+=P<A?P:A,V=i[++p]*i[p],j+=V,F+=V<A?V:A,p++}while(0<--B);if(M<j&&l++,x==b.SBPSY_s&&Q(),d=c!=0?F:M,!e.ATHonly&&!e.ATHshort){var N,h=t.en.s[x][D];0<h&&(N=j*t.thm.s[x][D]*m/h,c!=0&&(N*=f.nsPsy.shortfact[x]),d<N&&(d=N))}a[s++]=c!=0?d:d*f.nsPsy.shortfact[x]}e.useTemporal&&(a[s-3]>a[s-3+1]&&(a[s-3+1]+=(a[s-3]-a[s-3+1])*f.decay),a[s-3+1]>a[s-3+2]&&(a[s-3+2]+=(a[s-3+1]-a[s-3+2])*f.decay))}return l},this.calc_noise_core=function(e,t,r,a){var n=0,s=t.s,f=e.l3_enc;if(s>e.count1)for(;r--!=0;)l=e.xr[s],s++,n+=l*l,l=e.xr[s],s++,n+=l*l;else if(s>e.big_values){var p=H(2);for(p[0]=0,p[1]=a;r--!=0;)l=Math.abs(e.xr[s])-p[f[s]],s++,n+=l*l,l=Math.abs(e.xr[s])-p[f[s]],s++,n+=l*l}else for(;r--!=0;){var l;l=Math.abs(e.xr[s])-r1[f[s]]*a,s++,n+=l*l,l=Math.abs(e.xr[s])-r1[f[s]]*a,s++,n+=l*l}return t.s=s,n},this.calc_noise=function(e,t,r,a,n){var s,f,p=0,l=0,o=0,i=0,c=0,m=-20,h=0,g=e.scalefac,L=0;for(a.over_SSD=0,s=0;s<e.psymax;s++){var x,z=e.global_gain-(g[L++]+(e.preflag!=0?v[s]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[s]],D=0;if(n!=null&&n.step[s]==z)D=n.noise[s],h+=e.width[s],r[p++]=D/t[l++],D=n.noise_log[s];else{var M,d=O[z+E1.Q_MAX2];f=e.width[s]>>1,h+e.width[s]>e.max_nonzero_coeff&&(M=e.max_nonzero_coeff-h+1,f=0<M?M>>1:0);var A=new R(h);D=this.calc_noise_core(e,A,f,d),h=A.s,n!=null&&(n.step[s]=z,n.noise[s]=D),D=r[p++]=D/t[l++],D=v1.FAST_LOG10(Math.max(D,1e-20)),n!=null&&(n.noise_log[s]=D)}n!=null&&(n.global_gain=e.global_gain),c+=D,0<D&&(x=Math.max(0|10*D+.5,1),a.over_SSD+=x*x,o++,i+=D),m=Math.max(m,D)}return a.over_count=o,a.tot_noise=c,a.over_noise=i,a.max_noise=m,o}}function C1(){this.xr=H(576),this.l3_enc=f1(576),this.scalefac=f1(h1.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=f1(3),this.subblock_gain=f1(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=f1(h1.SFBMAX),this.window=f1(h1.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=f1(4),this.max_nonzero_coeff=0;var _=this;function u(S){return new Int32Array(S)}this.assign=function(S){var y;_.xr=(y=S.xr,new Float32Array(y)),_.l3_enc=u(S.l3_enc),_.scalefac=u(S.scalefac),_.xrpow_max=S.xrpow_max,_.part2_3_length=S.part2_3_length,_.big_values=S.big_values,_.count1=S.count1,_.global_gain=S.global_gain,_.scalefac_compress=S.scalefac_compress,_.block_type=S.block_type,_.mixed_block_flag=S.mixed_block_flag,_.table_select=u(S.table_select),_.subblock_gain=u(S.subblock_gain),_.region0_count=S.region0_count,_.region1_count=S.region1_count,_.preflag=S.preflag,_.scalefac_scale=S.scalefac_scale,_.count1table_select=S.count1table_select,_.part2_length=S.part2_length,_.sfb_lmax=S.sfb_lmax,_.sfb_smin=S.sfb_smin,_.psy_lmax=S.psy_lmax,_.sfbmax=S.sfbmax,_.psymax=S.psymax,_.sfbdivide=S.sfbdivide,_.width=u(S.width),_.window=u(S.window),_.count1bits=S.count1bits,_.sfb_partition_table=S.sfb_partition_table.slice(0),_.slen=u(S.slen),_.max_nonzero_coeff=S.max_nonzero_coeff}}k.t1HB=[1,1,1,0],k.t2HB=[1,2,1,3,1,1,3,2,0],k.t3HB=[3,2,1,1,1,1,3,2,0],k.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],k.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],k.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],k.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],k.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],k.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],k.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],k.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],k.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],k.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],k.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],k.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],k.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],k.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],k.t1l=[1,4,3,5],k.t2l=[1,4,7,4,5,7,6,7,8],k.t3l=[2,3,7,4,4,7,6,7,8],k.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],k.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],k.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],k.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],k.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],k.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],k.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],k.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],k.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],k.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],k.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],k.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],k.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],k.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],k.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],k.ht=[new o1(0,0,null,null),new o1(2,0,k.t1HB,k.t1l),new o1(3,0,k.t2HB,k.t2l),new o1(3,0,k.t3HB,k.t3l),new o1(0,0,null,null),new o1(4,0,k.t5HB,k.t5l),new o1(4,0,k.t6HB,k.t6l),new o1(6,0,k.t7HB,k.t7l),new o1(6,0,k.t8HB,k.t8l),new o1(6,0,k.t9HB,k.t9l),new o1(8,0,k.t10HB,k.t10l),new o1(8,0,k.t11HB,k.t11l),new o1(8,0,k.t12HB,k.t12l),new o1(16,0,k.t13HB,k.t13l),new o1(0,0,null,k.t16_5l),new o1(16,0,k.t15HB,k.t15l),new o1(1,1,k.t16HB,k.t16l),new o1(2,3,k.t16HB,k.t16l),new o1(3,7,k.t16HB,k.t16l),new o1(4,15,k.t16HB,k.t16l),new o1(6,63,k.t16HB,k.t16l),new o1(8,255,k.t16HB,k.t16l),new o1(10,1023,k.t16HB,k.t16l),new o1(13,8191,k.t16HB,k.t16l),new o1(4,15,k.t24HB,k.t24l),new o1(5,31,k.t24HB,k.t24l),new o1(6,63,k.t24HB,k.t24l),new o1(7,127,k.t24HB,k.t24l),new o1(8,255,k.t24HB,k.t24l),new o1(9,511,k.t24HB,k.t24l),new o1(11,2047,k.t24HB,k.t24l),new o1(13,8191,k.t24HB,k.t24l),new o1(0,0,k.t32HB,k.t32l),new o1(0,0,k.t33HB,k.t33l)],k.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],k.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],k.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],k.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],k.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],k.scfsi_band=[0,6,11,16,21],E1.Q_MAX=257,E1.Q_MAX2=116,E1.LARGE_BITS=1e5,E1.IXMAX_VAL=8206;var h1={};function I1(){var _,u;this.rv=null,this.qupvt=null;var S,y=new function(){this.setModules=function(I,v){}};function C(I){this.ordinal=I}function T(I){for(var v=0;v<I.sfbmax;v++)if(I.scalefac[v]+I.subblock_gain[I.window[v]]==0)return!1;return!0}function Y(I,v,O,W,r1){var $;switch(I){default:case 9:0<v.over_count?($=O.over_SSD<=v.over_SSD,O.over_SSD==v.over_SSD&&($=O.bits<v.bits)):$=O.max_noise<0&&10*O.max_noise+O.bits<=10*v.max_noise+v.bits;break;case 0:$=O.over_count<v.over_count||O.over_count==v.over_count&&O.over_noise<v.over_noise||O.over_count==v.over_count&&m1.EQ(O.over_noise,v.over_noise)&&O.tot_noise<v.tot_noise;break;case 8:Q();case 1:$=O.max_noise<v.max_noise;break;case 2:$=O.tot_noise<v.tot_noise;break;case 3:$=O.tot_noise<v.tot_noise&&O.max_noise<v.max_noise;break;case 4:$=O.max_noise<=0&&.2<v.max_noise||O.max_noise<=0&&v.max_noise<0&&v.max_noise>O.max_noise-.2&&O.tot_noise<v.tot_noise||O.max_noise<=0&&0<v.max_noise&&v.max_noise>O.max_noise-.2&&O.tot_noise<v.tot_noise+v.over_noise||0<O.max_noise&&-.05<v.max_noise&&v.max_noise>O.max_noise-.1&&O.tot_noise+O.over_noise<v.tot_noise+v.over_noise||0<O.max_noise&&-.1<v.max_noise&&v.max_noise>O.max_noise-.15&&O.tot_noise+O.over_noise+O.over_noise<v.tot_noise+v.over_noise+v.over_noise;break;case 5:$=O.over_noise<v.over_noise||m1.EQ(O.over_noise,v.over_noise)&&O.tot_noise<v.tot_noise;break;case 6:$=O.over_noise<v.over_noise||m1.EQ(O.over_noise,v.over_noise)&&(O.max_noise<v.max_noise||m1.EQ(O.max_noise,v.max_noise)&&O.tot_noise<=v.tot_noise);break;case 7:$=O.over_count<v.over_count||O.over_noise<v.over_noise}return v.over_count==0&&($=$&&O.bits<v.bits),$}function X(I,v,O,W,r1){var $=I.internal_flags;(function(R,e,t,r,a){var n,s=R.internal_flags;n=e.scalefac_scale==0?1.2968395546510096:1.6817928305074292;for(var f=0,p=0;p<e.sfbmax;p++)f<t[p]&&(f=t[p]);var l=s.noise_shaping_amp;switch(l==3&&Q(),l){case 2:break;case 1:1<f?f=Math.pow(f,.5):f*=.95;break;case 0:default:1<f?f=1:f*=.95}for(var o=0,p=0;p<e.sfbmax;p++){var i,c=e.width[p];if(o+=c,!(t[p]<f)){for(2&s.substep_shaping&&Q(),e.scalefac[p]++,i=-c;i<0;i++)r[o+i]*=n,r[o+i]>e.xrpow_max&&(e.xrpow_max=r[o+i]);if(s.noise_shaping_amp==2)return}}})(I,v,O,W);var t1=T(v);return!(t1||(t1=$.mode_gr==2?S.scale_bitcount(v):S.scale_bitcount_lsf($,v))&&(1<$.noise_shaping&&(p1.fill($.pseudohalf,0),v.scalefac_scale==0?(function(R,e){for(var t=0,r=0;r<R.sfbmax;r++){var a=R.width[r],n=R.scalefac[r];if(R.preflag!=0&&(n+=u.pretab[r]),t+=a,(1&n)!=0){n++;for(var s=-a;s<0;s++)e[t+s]*=1.2968395546510096,e[t+s]>R.xrpow_max&&(R.xrpow_max=e[t+s])}R.scalefac[r]=n>>1}R.preflag=0,R.scalefac_scale=1}(v,W),t1=!1):v.block_type==b.SHORT_TYPE&&0<$.subblock_gain&&(t1=function(R,e,t){var r,a=e.scalefac;for(r=0;r<e.sfb_lmax;r++)if(16<=a[r])return!0;for(var n=0;n<3;n++){var s=0,f=0;for(r=e.sfb_lmax+n;r<e.sfbdivide;r+=3)s<a[r]&&(s=a[r]);for(;r<e.sfbmax;r+=3)f<a[r]&&(f=a[r]);if(!(s<16&&f<8)){if(7<=e.subblock_gain[n])return!0;e.subblock_gain[n]++;var p=R.scalefac_band.l[e.sfb_lmax];for(r=e.sfb_lmax+n;r<e.sfbmax;r+=3){var l=e.width[r],o=a[r];if(0<=(o-=4>>e.scalefac_scale))a[r]=o,p+=3*l;else{a[r]=0;var i=210+(o<<e.scalefac_scale+1);m=u.IPOW20(i),p+=l*(n+1);for(var c=-l;c<0;c++)t[p+c]*=m,t[p+c]>e.xrpow_max&&(e.xrpow_max=t[p+c]);p+=l*(3-n-1)}}var m=u.IPOW20(202);p+=e.width[r]*(n+1);for(var c=-e.width[r];c<0;c++)t[p+c]*=m,t[p+c]>e.xrpow_max&&(e.xrpow_max=t[p+c])}}return!1}($,v,W)||T(v))),t1||(t1=$.mode_gr==2?S.scale_bitcount(v):S.scale_bitcount_lsf($,v)),t1))}this.setModules=function(I,v,O,W){_=v,this.rv=v,u=O,this.qupvt=O,S=W,y.setModules(u,S)},this.init_xrpow=function(I,v,O){var W=0,r1=0|v.max_nonzero_coeff;if(v.xrpow_max=0,p1.fill(O,r1,576,0),1e-20<(W=function(R,e,t,r){for(var a=r=0;a<=t;++a){var n=Math.abs(R.xr[a]);r+=n,e[a]=Math.sqrt(n*Math.sqrt(n)),e[a]>R.xrpow_max&&(R.xrpow_max=e[a])}return r}(v,O,r1,W))){var $=0;2&I.substep_shaping&&($=1);for(var t1=0;t1<v.psymax;t1++)I.pseudohalf[t1]=$;return!0}return p1.fill(v.l3_enc,0,576,0),!1},this.init_outer_loop=function(I,v){v.part2_3_length=0,v.big_values=0,v.count1=0,v.global_gain=210,v.scalefac_compress=0,v.table_select[0]=0,v.table_select[1]=0,v.table_select[2]=0,v.subblock_gain[0]=0,v.subblock_gain[1]=0,v.subblock_gain[2]=0,v.subblock_gain[3]=0,v.region0_count=0,v.region1_count=0,v.preflag=0,v.scalefac_scale=0,v.count1table_select=0,v.part2_length=0,v.sfb_lmax=b.SBPSY_l,v.sfb_smin=b.SBPSY_s,v.psy_lmax=I.sfb21_extra?b.SBMAX_l:b.SBPSY_l,v.psymax=v.psy_lmax,v.sfbmax=v.sfb_lmax,v.sfbdivide=11;for(var O=0;O<b.SBMAX_l;O++)v.width[O]=I.scalefac_band.l[O+1]-I.scalefac_band.l[O],v.window[O]=3;if(v.block_type==b.SHORT_TYPE){var W=H(576);v.sfb_smin=0,(v.sfb_lmax=0)!=v.mixed_block_flag&&Q(),v.psymax=v.sfb_lmax+3*((I.sfb21_extra?b.SBMAX_s:b.SBPSY_s)-v.sfb_smin),v.sfbmax=v.sfb_lmax+3*(b.SBPSY_s-v.sfb_smin),v.sfbdivide=v.sfbmax-18,v.psy_lmax=v.sfb_lmax;var r1=I.scalefac_band.l[v.sfb_lmax];k1.arraycopy(v.xr,0,W,0,576);for(var O=v.sfb_smin;O<b.SBMAX_s;O++)for(var $=I.scalefac_band.s[O],t1=I.scalefac_band.s[O+1],R=0;R<3;R++)for(var e=$;e<t1;e++)v.xr[r1++]=W[3*e+R];for(var t=v.sfb_lmax,O=v.sfb_smin;O<b.SBMAX_s;O++)v.width[t]=v.width[t+1]=v.width[t+2]=I.scalefac_band.s[O+1]-I.scalefac_band.s[O],v.window[t]=0,v.window[t+1]=1,v.window[t+2]=2,t+=3}v.count1bits=0,v.sfb_partition_table=u.nr_of_sfb_block[0][0],v.slen[0]=0,v.slen[1]=0,v.slen[2]=0,v.slen[3]=0,v.max_nonzero_coeff=575,p1.fill(v.scalefac,0),function(r,a){var n=r.ATH,s=a.xr;if(a.block_type!=b.SHORT_TYPE)for(var f=!1,p=b.PSFB21-1;0<=p&&!f;p--){var l=r.scalefac_band.psfb21[p],o=r.scalefac_band.psfb21[p+1],i=u.athAdjust(n.adjust,n.psfb21[p],n.floor);1e-12<r.nsPsy.longfact[21]&&(i*=r.nsPsy.longfact[21]);for(var c=o-1;l<=c;c--){if(!(Math.abs(s[c])<i)){f=!0;break}s[c]=0}}else for(var m=0;m<3;m++)for(var f=!1,p=b.PSFB12-1;0<=p&&!f;p--){var l=3*r.scalefac_band.s[12]+(r.scalefac_band.s[13]-r.scalefac_band.s[12])*m+(r.scalefac_band.psfb12[p]-r.scalefac_band.psfb12[0]),o=l+(r.scalefac_band.psfb12[p+1]-r.scalefac_band.psfb12[p]),h=u.athAdjust(n.adjust,n.psfb12[p],n.floor);1e-12<r.nsPsy.shortfact[12]&&(h*=r.nsPsy.shortfact[12]);for(var c=o-1;l<=c;c--){if(!(Math.abs(s[c])<h)){f=!0;break}s[c]=0}}}(I,v)},C.BINSEARCH_NONE=new C(0),C.BINSEARCH_UP=new C(1),C.BINSEARCH_DOWN=new C(2),this.outer_loop=function(I,v,O,W,r1,$){var t1=I.internal_flags,R=new C1,e=H(576),t=H(h1.SFBMAX),r=new O1,a=new function(){this.global_gain=0,this.sfb_count1=0,this.step=f1(39),this.noise=H(39),this.noise_log=H(39)},n=9999999,s=!1;if(function(c,m,h,g,L){var x,z=c.CurrentStep[g],D=!1,M=c.OldValue[g],d=C.BINSEARCH_NONE;for(m.global_gain=M,h-=m.part2_length;;){var A;if(x=S.count_bits(c,L,m,null),z==1||x==h)break;h<x?(d==C.BINSEARCH_DOWN&&(D=!0),D&&(z/=2),d=C.BINSEARCH_UP,A=z):(d==C.BINSEARCH_UP&&(D=!0),D&&(z/=2),d=C.BINSEARCH_DOWN,A=-z),m.global_gain+=A,m.global_gain<0&&Q(),255<m.global_gain&&Q()}for(;h<x&&m.global_gain<255;)m.global_gain++,x=S.count_bits(c,L,m,null);c.CurrentStep[g]=4<=M-m.global_gain?4:2,c.OldValue[g]=m.global_gain,m.part2_3_length=x}(t1,v,$,r1,W),t1.noise_shaping==0)return 100;u.calc_noise(v,O,t,r,a),r.bits=v.part2_3_length,R.assign(v);var f=0;for(k1.arraycopy(W,0,e,0,576);!s;){do{var p,l=new O1,o=255;if(p=2&t1.substep_shaping?20:3,t1.sfb21_extra&&Q(),!X(I,R,t,W))break;R.scalefac_scale!=0&&(o=254);var i=$-R.part2_length;if(i<=0)break;for(;(R.part2_3_length=S.count_bits(t1,W,R,a))>i&&R.global_gain<=o;)R.global_gain++;if(R.global_gain>o)break;if(r.over_count==0){for(;(R.part2_3_length=S.count_bits(t1,W,R,a))>n&&R.global_gain<=o;)R.global_gain++;if(R.global_gain>o)break}if(u.calc_noise(R,O,t,l,a),l.bits=R.part2_3_length,(Y(v.block_type!=b.SHORT_TYPE?I.quant_comp:I.quant_comp_short,r,l)?1:0)!=0)n=v.part2_3_length,r=l,v.assign(R),f=0,k1.arraycopy(W,0,e,0,576);else if(t1.full_outer_loop==0){if(++f>p&&r.over_count==0)break;t1.noise_shaping_amp,t1.noise_shaping_amp}}while(R.global_gain+R.scalefac_scale<255);t1.noise_shaping_amp==3?Q():s=!0}return I.VBR==E.vbr_rh||I.VBR==E.vbr_mtrh?k1.arraycopy(e,0,W,0,576):1&t1.substep_shaping&&Q(),r.over_count},this.iteration_finish_one=function(I,v,O){var W=I.l3_side,r1=W.tt[v][O];S.best_scalefac_store(I,v,O,W),I.use_best_huffman==1&&S.best_huffman_divide(I,r1),_.ResvAdjust(I,r1)}}function x1(){this.thm=new _1,this.en=new _1}function b(){var _=b.MPG_MD_MS_LR,u=null,S=this.psy=null,y=null;this.setModules=function(T,Y,X,I){u=T,this.psy=Y,S=Y,y=I};var C=new function(){var T=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*v1.SQRT2*.5/2384e-9,.017876148*v1.SQRT2*.5/2384e-9,.003134727*v1.SQRT2*.5/2384e-9,.002457142*v1.SQRT2*.5/2384e-9,971317e-9*v1.SQRT2*.5/2384e-9,218868e-9*v1.SQRT2*.5/2384e-9,101566e-9*v1.SQRT2*.5/2384e-9,13828e-9*v1.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],Y=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],X=Y[b.SHORT_TYPE],I=Y[b.SHORT_TYPE],v=Y[b.SHORT_TYPE],O=Y[b.SHORT_TYPE],W=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function r1(R,e,t){for(var r,a,n,s=10,f=e+238-14-286,p=-15;p<0;p++){var l,o,i;l=T[s+-10],o=R[f+-224]*l,i=R[e+224]*l,l=T[s+-9],o+=R[f+-160]*l,i+=R[e+160]*l,l=T[s+-8],o+=R[f+-96]*l,i+=R[e+96]*l,l=T[s+-7],o+=R[f+-32]*l,i+=R[e+32]*l,l=T[s+-6],o+=R[f+32]*l,i+=R[e+-32]*l,l=T[s+-5],o+=R[f+96]*l,i+=R[e+-96]*l,l=T[s+-4],o+=R[f+160]*l,i+=R[e+-160]*l,l=T[s+-3],o+=R[f+224]*l,i+=R[e+-224]*l,l=T[s+-2],o+=R[e+-256]*l,i-=R[f+256]*l,l=T[s+-1],o+=R[e+-192]*l,i-=R[f+192]*l,l=T[s+0],o+=R[e+-128]*l,i-=R[f+128]*l,l=T[s+1],o+=R[e+-64]*l,i-=R[f+64]*l,l=T[s+2],o+=R[e+0]*l,i-=R[f+0]*l,l=T[s+3],o+=R[e+64]*l,i-=R[f+-64]*l,l=T[s+4],o+=R[e+128]*l,i-=R[f+-128]*l,l=T[s+5],o+=R[e+192]*l,i-=R[f+-192]*l,o*=T[s+6],l=i-o,t[30+2*p]=i+o,t[31+2*p]=T[s+7]*l,s+=18,e--,f++}i=R[e+-16]*T[s+-10],o=R[e+-32]*T[s+-2],i+=(R[e+-48]-R[e+16])*T[s+-9],o+=R[e+-96]*T[s+-1],i+=(R[e+-80]+R[e+48])*T[s+-8],o+=R[e+-160]*T[s+0],i+=(R[e+-112]-R[e+80])*T[s+-7],o+=R[e+-224]*T[s+1],i+=(R[e+-144]+R[e+112])*T[s+-6],o-=R[e+32]*T[s+2],i+=(R[e+-176]-R[e+144])*T[s+-5],o-=R[e+96]*T[s+3],i+=(R[e+-208]+R[e+176])*T[s+-4],o-=R[e+160]*T[s+4],i+=(R[e+-240]-R[e+208])*T[s+-3],o-=R[e+224],r=o-i,a=o+i,i=t[14],o=t[15]-i,t[31]=a+i,t[30]=r+o,t[15]=r-o,t[14]=a-i,n=t[28]-t[0],t[0]+=t[28],t[28]=n*T[s+-36+7],n=t[29]-t[1],t[1]+=t[29],t[29]=n*T[s+-36+7],n=t[26]-t[2],t[2]+=t[26],t[26]=n*T[s+-72+7],n=t[27]-t[3],t[3]+=t[27],t[27]=n*T[s+-72+7],n=t[24]-t[4],t[4]+=t[24],t[24]=n*T[s+-108+7],n=t[25]-t[5],t[5]+=t[25],t[25]=n*T[s+-108+7],n=t[22]-t[6],t[6]+=t[22],t[22]=n*v1.SQRT2,n=t[23]-t[7],t[7]+=t[23],t[23]=n*v1.SQRT2-t[7],t[7]-=t[6],t[22]-=t[7],t[23]-=t[22],n=t[6],t[6]=t[31]-n,t[31]=t[31]+n,n=t[7],t[7]=t[30]-n,t[30]=t[30]+n,n=t[22],t[22]=t[15]-n,t[15]=t[15]+n,n=t[23],t[23]=t[14]-n,t[14]=t[14]+n,n=t[20]-t[8],t[8]+=t[20],t[20]=n*T[s+-180+7],n=t[21]-t[9],t[9]+=t[21],t[21]=n*T[s+-180+7],n=t[18]-t[10],t[10]+=t[18],t[18]=n*T[s+-216+7],n=t[19]-t[11],t[11]+=t[19],t[19]=n*T[s+-216+7],n=t[16]-t[12],t[12]+=t[16],t[16]=n*T[s+-252+7],n=t[17]-t[13],t[13]+=t[17],t[17]=n*T[s+-252+7],n=-t[20]+t[24],t[20]+=t[24],t[24]=n*T[s+-216+7],n=-t[21]+t[25],t[21]+=t[25],t[25]=n*T[s+-216+7],n=t[4]-t[8],t[4]+=t[8],t[8]=n*T[s+-216+7],n=t[5]-t[9],t[5]+=t[9],t[9]=n*T[s+-216+7],n=t[0]-t[12],t[0]+=t[12],t[12]=n*T[s+-72+7],n=t[1]-t[13],t[1]+=t[13],t[13]=n*T[s+-72+7],n=t[16]-t[28],t[16]+=t[28],t[28]=n*T[s+-72+7],n=-t[17]+t[29],t[17]+=t[29],t[29]=n*T[s+-72+7],n=v1.SQRT2*(t[2]-t[10]),t[2]+=t[10],t[10]=n,n=v1.SQRT2*(t[3]-t[11]),t[3]+=t[11],t[11]=n,n=v1.SQRT2*(-t[18]+t[26]),t[18]+=t[26],t[26]=n-t[18],n=v1.SQRT2*(-t[19]+t[27]),t[19]+=t[27],t[27]=n-t[19],n=t[2],t[19]-=t[3],t[3]-=n,t[2]=t[31]-n,t[31]+=n,n=t[3],t[11]-=t[19],t[18]-=n,t[3]=t[30]-n,t[30]+=n,n=t[18],t[27]-=t[11],t[19]-=n,t[18]=t[15]-n,t[15]+=n,n=t[19],t[10]-=n,t[19]=t[14]-n,t[14]+=n,n=t[10],t[11]-=n,t[10]=t[23]-n,t[23]+=n,n=t[11],t[26]-=n,t[11]=t[22]-n,t[22]+=n,n=t[26],t[27]-=n,t[26]=t[7]-n,t[7]+=n,n=t[27],t[27]=t[6]-n,t[6]+=n,n=v1.SQRT2*(t[0]-t[4]),t[0]+=t[4],t[4]=n,n=v1.SQRT2*(t[1]-t[5]),t[1]+=t[5],t[5]=n,n=v1.SQRT2*(t[16]-t[20]),t[16]+=t[20],t[20]=n,n=v1.SQRT2*(t[17]-t[21]),t[17]+=t[21],t[21]=n,n=-v1.SQRT2*(t[8]-t[12]),t[8]+=t[12],t[12]=n-t[8],n=-v1.SQRT2*(t[9]-t[13]),t[9]+=t[13],t[13]=n-t[9],n=-v1.SQRT2*(t[25]-t[29]),t[25]+=t[29],t[29]=n-t[25],n=-v1.SQRT2*(t[24]+t[28]),t[24]-=t[28],t[28]=n-t[24],n=t[24]-t[16],t[24]=n,n=t[20]-n,t[20]=n,n=t[28]-n,t[28]=n,n=t[25]-t[17],t[25]=n,n=t[21]-n,t[21]=n,n=t[29]-n,t[29]=n,n=t[17]-t[1],t[17]=n,n=t[9]-n,t[9]=n,n=t[25]-n,t[25]=n,n=t[5]-n,t[5]=n,n=t[21]-n,t[21]=n,n=t[13]-n,t[13]=n,n=t[29]-n,t[29]=n,n=t[1]-t[0],t[1]=n,n=t[16]-n,t[16]=n,n=t[17]-n,t[17]=n,n=t[8]-n,t[8]=n,n=t[9]-n,t[9]=n,n=t[24]-n,t[24]=n,n=t[25]-n,t[25]=n,n=t[4]-n,t[4]=n,n=t[5]-n,t[5]=n,n=t[20]-n,t[20]=n,n=t[21]-n,t[21]=n,n=t[12]-n,t[12]=n,n=t[13]-n,t[13]=n,n=t[28]-n,t[28]=n,n=t[29]-n,t[29]=n,n=t[0],t[0]+=t[31],t[31]-=n,n=t[1],t[1]+=t[30],t[30]-=n,n=t[16],t[16]+=t[15],t[15]-=n,n=t[17],t[17]+=t[14],t[14]-=n,n=t[8],t[8]+=t[23],t[23]-=n,n=t[9],t[9]+=t[22],t[22]-=n,n=t[24],t[24]+=t[7],t[7]-=n,n=t[25],t[25]+=t[6],t[6]-=n,n=t[4],t[4]+=t[27],t[27]-=n,n=t[5],t[5]+=t[26],t[26]-=n,n=t[20],t[20]+=t[11],t[11]-=n,n=t[21],t[21]+=t[10],t[10]-=n,n=t[12],t[12]+=t[19],t[19]-=n,n=t[13],t[13]+=t[18],t[18]-=n,n=t[28],t[28]+=t[3],t[3]-=n,n=t[29],t[29]+=t[2],t[2]-=n}function $(R,e){for(var t=0;t<3;t++){var r,a,n,s,f,p;s=R[e+6]*Y[b.SHORT_TYPE][0]-R[e+15],r=R[e+0]*Y[b.SHORT_TYPE][2]-R[e+9],a=s+r,n=s-r,s=R[e+15]*Y[b.SHORT_TYPE][0]+R[e+6],r=R[e+9]*Y[b.SHORT_TYPE][2]+R[e+0],f=s+r,p=-s+r,r=2069978111953089e-26*(R[e+3]*Y[b.SHORT_TYPE][1]-R[e+12]),s=2069978111953089e-26*(R[e+12]*Y[b.SHORT_TYPE][1]+R[e+3]),R[e+0]=190752519173728e-25*a+r,R[e+15]=190752519173728e-25*-f+s,n=.8660254037844387*n*1907525191737281e-26,f=.5*f*1907525191737281e-26+s,R[e+3]=n-f,R[e+6]=n+f,a=.5*a*1907525191737281e-26-r,p=.8660254037844387*p*1907525191737281e-26,R[e+9]=a+p,R[e+12]=a-p,e++}}function t1(R,e,t){var r,a,n,s,f,p,l,o,i,c,m,h,g,L,x,z,D,M;n=t[17]-t[9],f=t[15]-t[11],p=t[14]-t[12],l=t[0]+t[8],o=t[1]+t[7],i=t[2]+t[6],c=t[3]+t[5],R[e+17]=l+i-c-(o-t[4]),a=(l+i-c)*I[19]+(o-t[4]),r=(n-f-p)*I[18],R[e+5]=r+a,R[e+6]=r-a,s=(t[16]-t[10])*I[18],o=o*I[19]+t[4],r=n*I[12]+s+f*I[13]+p*I[14],a=-l*I[16]+o-i*I[17]+c*I[15],R[e+1]=r+a,R[e+2]=r-a,r=n*I[13]-s-f*I[14]+p*I[12],a=-l*I[17]+o-i*I[15]+c*I[16],R[e+9]=r+a,R[e+10]=r-a,r=n*I[14]-s+f*I[12]-p*I[13],a=l*I[15]-o+i*I[16]-c*I[17],R[e+13]=r+a,R[e+14]=r-a,m=t[8]-t[0],g=t[6]-t[2],L=t[5]-t[3],x=t[17]+t[9],z=t[16]+t[10],D=t[15]+t[11],M=t[14]+t[12],R[e+0]=x+D+M+(z+t[13]),r=(x+D+M)*I[19]-(z+t[13]),a=(m-g+L)*I[18],R[e+11]=r+a,R[e+12]=r-a,h=(t[7]-t[1])*I[18],z=t[13]-z*I[19],r=x*I[15]-z+D*I[16]+M*I[17],a=m*I[14]+h+g*I[12]+L*I[13],R[e+3]=r+a,R[e+4]=r-a,r=-x*I[17]+z-D*I[15]-M*I[16],a=m*I[13]+h-g*I[14]-L*I[12],R[e+7]=r+a,R[e+8]=r-a,r=-x*I[16]+z-D*I[17]-M*I[15],a=m*I[12]-h+g*I[13]-L*I[14],R[e+15]=r+a,R[e+16]=r-a}this.mdct_sub48=function(R,e,t){for(var r=e,a=286,n=0;n<R.channels_out;n++){for(var s=0;s<R.mode_gr;s++){for(var f,p=R.l3_side.tt[s][n],l=p.xr,o=0,i=R.sb_sample[n][1-s],c=0,m=0;m<9;m++)for(r1(r,a,i[c]),r1(r,a+32,i[c+1]),c+=2,a+=64,f=1;f<32;f+=2)i[c-1][f]*=-1;for(f=0;f<32;f++,o+=18){var h=p.block_type,g=R.sb_sample[n][s],L=R.sb_sample[n][1-s];if(p.mixed_block_flag!=0&&f<2&&(h=0),R.amp_filter[f]<1e-12)p1.fill(l,o+0,o+18,0);else if(R.amp_filter[f]<1&&Q(),h==b.SHORT_TYPE){for(var m=-3;m<0;m++){var x=Y[b.SHORT_TYPE][m+3];l[o+3*m+9]=g[9+m][W[f]]*x-g[8-m][W[f]],l[o+3*m+18]=g[14-m][W[f]]*x+g[15+m][W[f]],l[o+3*m+10]=g[15+m][W[f]]*x-g[14-m][W[f]],l[o+3*m+19]=L[2-m][W[f]]*x+L[3+m][W[f]],l[o+3*m+11]=L[3+m][W[f]]*x-L[2-m][W[f]],l[o+3*m+20]=L[8-m][W[f]]*x+L[9+m][W[f]]}$(l,o)}else{for(var z=H(18),m=-9;m<0;m++){var D,M;D=Y[h][m+27]*L[m+9][W[f]]+Y[h][m+36]*L[8-m][W[f]],M=Y[h][m+9]*g[m+9][W[f]]-Y[h][m+18]*g[8-m][W[f]],z[m+9]=D-M*X[3+m+9],z[m+18]=D*X[3+m+9]+M}t1(l,o,z)}if(h!=b.SHORT_TYPE&&f!=0)for(var m=7;0<=m;--m){var d,A;d=l[o+m]*v[20+m]+l[o+-1-m]*O[28+m],A=l[o+m]*O[28+m]-l[o+-1-m]*v[20+m],l[o+-1-m]=d,l[o+m]=A}}}if(r=t,a=286,R.mode_gr==1)for(var F=0;F<18;F++)k1.arraycopy(R.sb_sample[n][1][F],0,R.sb_sample[n][0][F],0,32)}}};this.lame_encode_mp3_frame=function(T,Y,X,I,v,O){var W,r1=L1([2,2]);r1[0][0]=new x1,r1[0][1]=new x1,r1[1][0]=new x1,r1[1][1]=new x1;var $,t1=L1([2,2]);t1[0][0]=new x1,t1[0][1]=new x1,t1[1][0]=new x1,t1[1][1]=new x1;var R,e,t,r=[null,null],a=T.internal_flags,n=y1([2,4]),s=[[0,0],[0,0]],f=[[0,0],[0,0]];if(r[0]=Y,r[1]=X,a.lame_encode_frame_init==0&&function(g,L){var x,z,D=g.internal_flags;if(D.lame_encode_frame_init==0){var M,d,A=H(2014),F=H(2014);for(D.lame_encode_frame_init=1,d=M=0;M<286+576*(1+D.mode_gr);++M)M<576*D.mode_gr?(A[M]=0,D.channels_out==2&&(F[M]=0)):(A[M]=L[0][d],D.channels_out==2&&(F[M]=L[1][d]),++d);for(z=0;z<D.mode_gr;z++)for(x=0;x<D.channels_out;x++)D.l3_side.tt[z][x].block_type=b.SHORT_TYPE;C.mdct_sub48(D,A,F)}}(T,r),a.padding=0,(a.slot_lag-=a.frac_SpF)<0&&(a.slot_lag+=T.out_samplerate,a.padding=1),a.psymodel!=0){var p,l=[null,null],o=0,i=f1(2);for(t=0;t<a.mode_gr;t++){for(e=0;e<a.channels_out;e++)l[e]=r[e],o=576+576*t-b.FFTOFFSET;if(T.VBR==E.vbr_mtrh||T.VBR==E.vbr_mt?Q():p=S.L3psycho_anal_ns(T,l,o,t,r1,t1,s[t],f[t],n[t],i),p!=0)return-4;for(T.mode==n1.JOINT_STEREO&&Q(),e=0;e<a.channels_out;e++){var c=a.l3_side.tt[t][e];c.block_type=i[e],c.mixed_block_flag=0}}}else Q();if(function(g){var L,x;if(g.ATH.useAdjust==0)return g.ATH.adjust=1;if(x=g.loudness_sq[0][0],L=g.loudness_sq[1][0],g.channels_out==2?Q():(x+=x,L+=L),g.mode_gr==2&&(x=Math.max(x,L)),x*=.5,.03125<(x*=g.ATH.aaSensitivityP))1<=g.ATH.adjust?g.ATH.adjust=1:g.ATH.adjust<g.ATH.adjustLimit&&(g.ATH.adjust=g.ATH.adjustLimit),g.ATH.adjustLimit=1;else{var z=31.98*x+625e-6;g.ATH.adjust>=z?(g.ATH.adjust*=.075*z+.925,g.ATH.adjust<z&&(g.ATH.adjust=z)):g.ATH.adjustLimit>=z?g.ATH.adjust=z:g.ATH.adjust<g.ATH.adjustLimit&&(g.ATH.adjust=g.ATH.adjustLimit),g.ATH.adjustLimit=z}}(a),C.mdct_sub48(a,r[0],r[1]),a.mode_ext=b.MPG_MD_LR_LR,T.force_ms?a.mode_ext=b.MPG_MD_MS_LR:T.mode==n1.JOINT_STEREO&&Q(),a.mode_ext==_?($=t1,R=f):($=r1,R=s),T.analysis&&a.pinfo!=null&&Q(),T.VBR==E.vbr_off||T.VBR==E.vbr_abr){var m,h;for(m=0;m<18;m++)a.nsPsy.pefirbuf[m]=a.nsPsy.pefirbuf[m+1];for(t=h=0;t<a.mode_gr;t++)for(e=0;e<a.channels_out;e++)h+=R[t][e];for(a.nsPsy.pefirbuf[18]=h,h=a.nsPsy.pefirbuf[9],m=0;m<9;m++)h+=(a.nsPsy.pefirbuf[m]+a.nsPsy.pefirbuf[18-m])*b.fircoef[m];for(h=3350*a.mode_gr*a.channels_out/h,t=0;t<a.mode_gr;t++)for(e=0;e<a.channels_out;e++)R[t][e]*=h}return a.iteration_loop.iteration_loop(T,R,[.5,.5],$),u.format_bitstream(T),W=u.copy_buffer(a,I,v,O,1),T.bWriteVbrTag&&y.addVbrFrame(T),T.analysis&&a.pinfo!=null&&Q(),function(g){var L,x;for(g.bitrate_stereoMode_Hist[g.bitrate_index][4]++,g.bitrate_stereoMode_Hist[15][4]++,g.channels_out==2&&Q(),L=0;L<g.mode_gr;++L)for(x=0;x<g.channels_out;++x){var z=0|g.l3_side.tt[L][x].block_type;g.l3_side.tt[L][x].mixed_block_flag!=0&&(z=4),g.bitrate_blockType_Hist[g.bitrate_index][z]++,g.bitrate_blockType_Hist[g.bitrate_index][5]++,g.bitrate_blockType_Hist[15][z]++,g.bitrate_blockType_Hist[15][5]++}}(a),W}}function _1(){this.l=H(b.SBMAX_l),this.s=y1([b.SBMAX_s,3]);var _=this;this.assign=function(u){k1.arraycopy(u.l,0,_.l,0,b.SBMAX_l);for(var S=0;S<b.SBMAX_s;S++)for(var y=0;y<3;y++)_.s[S][y]=u.s[S][y]}}function Z(){var _=40;function u(){this.write_timing=0,this.ptr=0,this.buf=A1(_)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=y1([2,Z.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new function(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[f1(4),f1(4)];for(var y=0;y<2;y++)for(var C=0;C<2;C++)this.tt[y][C]=new C1},this.ms_ratio=H(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=f1(2),this.CurrentStep=f1(2),this.masking_lower=0,this.bv_scf=f1(576),this.pseudohalf=f1(h1.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Z.BPC+1),this.itime=j1(2),this.sideinfo_len=0,this.sb_sample=y1([2,2,18,b.SBLIMIT]),this.amp_filter=H(32),this.header=new Array(Z.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new B1,this.minval_l=H(b.CBANDS),this.minval_s=H(b.CBANDS),this.nb_1=y1([4,b.CBANDS]),this.nb_2=y1([4,b.CBANDS]),this.nb_s1=y1([4,b.CBANDS]),this.nb_s2=y1([4,b.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=H(4),this.loudness_sq=y1([2,2]),this.loudness_sq_save=H(2),this.mld_l=H(b.SBMAX_l),this.mld_s=H(b.SBMAX_s),this.bm_l=f1(b.SBMAX_l),this.bo_l=f1(b.SBMAX_l),this.bm_s=f1(b.SBMAX_s),this.bo_s=f1(b.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=S1([b.CBANDS,2]),this.s3ind_s=S1([b.CBANDS,2]),this.numlines_s=f1(b.CBANDS),this.numlines_l=f1(b.CBANDS),this.rnumlines_l=H(b.CBANDS),this.mld_cb_l=H(b.CBANDS),this.mld_cb_s=H(b.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=H(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=f1(2),this.nsPsy=new function(){this.last_en_subshort=y1([4,9]),this.lastAttacks=f1(4),this.pefirbuf=H(19),this.longfact=H(b.SBMAX_l),this.shortfact=H(b.SBMAX_s),this.attackthre=0,this.attackthre_s=0},this.VBR_seek_table=new function(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0},this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=S1([16,5]),this.bitrate_blockType_Hist=S1([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var S=0;S<this.en.length;S++)this.en[S]=new _1;for(var S=0;S<this.thm.length;S++)this.thm[S]=new _1;for(var S=0;S<this.header.length;S++)this.header[S]=new u}function N1(){var _=new function(){var M=H(b.BLKSIZE),d=H(b.BLKSIZE_s/2),A=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function F(B,P,V){var N,U,a1,q=0,e1=P+(V<<=1);N=4;do{var J,s1,w1,K,i1,b1,G;for(G=N>>1,b1=(i1=(K=N)<<1)+K,N=i1<<1,a1=(U=P)+G;G1=B[U+0]-B[U+K],J1=B[U+0]+B[U+K],Q1=B[U+i1]-B[U+b1],U1=B[U+i1]+B[U+b1],B[U+i1]=J1-U1,B[U+0]=J1+U1,B[U+b1]=G1-Q1,B[U+K]=G1+Q1,G1=B[a1+0]-B[a1+K],J1=B[a1+0]+B[a1+K],Q1=v1.SQRT2*B[a1+b1],U1=v1.SQRT2*B[a1+i1],B[a1+i1]=J1-U1,B[a1+0]=J1+U1,B[a1+b1]=G1-Q1,B[a1+K]=G1+Q1,a1+=N,(U+=N)<e1;);for(s1=A[q+0],J=A[q+1],w1=1;w1<G;w1++){var P1,H1;P1=1-2*J*J,H1=2*J*s1,U=P+w1,a1=P+K-w1;do{var V1,Y1,X1,J1,G1,tt,U1,nt,Q1,at;Y1=H1*B[U+K]-P1*B[a1+K],V1=P1*B[U+K]+H1*B[a1+K],G1=B[U+0]-V1,J1=B[U+0]+V1,tt=B[a1+0]-Y1,X1=B[a1+0]+Y1,Y1=H1*B[U+b1]-P1*B[a1+b1],V1=P1*B[U+b1]+H1*B[a1+b1],Q1=B[U+i1]-V1,U1=B[U+i1]+V1,at=B[a1+i1]-Y1,nt=B[a1+i1]+Y1,Y1=J*U1-s1*at,V1=s1*U1+J*at,B[U+i1]=J1-V1,B[U+0]=J1+V1,B[a1+b1]=tt-Y1,B[a1+K]=tt+Y1,Y1=s1*nt-J*Q1,V1=J*nt+s1*Q1,B[a1+i1]=X1-V1,B[a1+0]=X1+V1,B[U+b1]=G1-Y1,B[U+K]=G1+Y1,a1+=N,U+=N}while(U<e1);s1=(P1=s1)*A[q+0]-J*A[q+1],J=P1*A[q+1]+J*A[q+0]}q+=2}while(N<V)}var j=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(B,P,V,N,U){for(var a1=0;a1<3;a1++){var q=b.BLKSIZE_s/2,e1=65535&192*(a1+1),J=b.BLKSIZE_s/8-1;do{var s1,w1,K,i1,b1,G=255&j[J<<2];s1=d[G]*N[V][U+G+e1],b1=d[127-G]*N[V][U+G+e1+128],w1=s1-b1,s1+=b1,K=d[G+64]*N[V][U+G+e1+64],b1=d[63-G]*N[V][U+G+e1+192],i1=K-b1,K+=b1,q-=4,P[a1][q+0]=s1+K,P[a1][q+2]=s1-K,P[a1][q+1]=w1+i1,P[a1][q+3]=w1-i1,s1=d[G+1]*N[V][U+G+e1+1],b1=d[126-G]*N[V][U+G+e1+129],w1=s1-b1,s1+=b1,K=d[G+65]*N[V][U+G+e1+65],b1=d[62-G]*N[V][U+G+e1+193],i1=K-b1,K+=b1,P[a1][q+b.BLKSIZE_s/2+0]=s1+K,P[a1][q+b.BLKSIZE_s/2+2]=s1-K,P[a1][q+b.BLKSIZE_s/2+1]=w1+i1,P[a1][q+b.BLKSIZE_s/2+3]=w1-i1}while(0<=--J);F(P[a1],q,b.BLKSIZE_s/2)}},this.fft_long=function(B,P,V,N,U){var a1=b.BLKSIZE/8-1,q=b.BLKSIZE/2;do{var e1,J,s1,w1,K,i1=255&j[a1];e1=M[i1]*N[V][U+i1],K=M[i1+512]*N[V][U+i1+512],J=e1-K,e1+=K,s1=M[i1+256]*N[V][U+i1+256],K=M[i1+768]*N[V][U+i1+768],w1=s1-K,s1+=K,P[0+(q-=4)]=e1+s1,P[q+2]=e1-s1,P[q+1]=J+w1,P[q+3]=J-w1,e1=M[i1+1]*N[V][U+i1+1],K=M[i1+513]*N[V][U+i1+513],J=e1-K,e1+=K,s1=M[i1+257]*N[V][U+i1+257],K=M[i1+769]*N[V][U+i1+769],w1=s1-K,s1+=K,P[q+b.BLKSIZE/2+0]=e1+s1,P[q+b.BLKSIZE/2+2]=e1-s1,P[q+b.BLKSIZE/2+1]=J+w1,P[q+b.BLKSIZE/2+3]=J-w1}while(0<=--a1);F(P,q,b.BLKSIZE/2)},this.init_fft=function(B){for(var P=0;P<b.BLKSIZE;P++)M[P]=.42-.5*Math.cos(2*Math.PI*(P+.5)/b.BLKSIZE)+.08*Math.cos(4*Math.PI*(P+.5)/b.BLKSIZE);for(var P=0;P<b.BLKSIZE_s/2;P++)d[P]=.5*(1-Math.cos(2*Math.PI*(P+.5)/b.BLKSIZE_s))}},u=2.302585092994046,S=2,y=16,C=.34,T=1/217621504/(b.BLKSIZE/2),Y=.2302585093;function X(M,d,A,F,j,B,P,V,N,U,a1){var q=M.internal_flags;N<2?(_.fft_long(q,F[j],N,U,a1),_.fft_short(q,B[P],N,U,a1)):N==2&&Q(),d[0]=F[j+0][0],d[0]*=d[0];for(var e1=b.BLKSIZE/2-1;0<=e1;--e1){var J=F[j+0][b.BLKSIZE/2-e1],s1=F[j+0][b.BLKSIZE/2+e1];d[b.BLKSIZE/2-e1]=.5*(J*J+s1*s1)}for(var w1=2;0<=w1;--w1){A[w1][0]=B[P+0][w1][0],A[w1][0]*=A[w1][0];for(var e1=b.BLKSIZE_s/2-1;0<=e1;--e1){var J=B[P+0][w1][b.BLKSIZE_s/2-e1],s1=B[P+0][w1][b.BLKSIZE_s/2+e1];A[w1][b.BLKSIZE_s/2-e1]=.5*(J*J+s1*s1)}}for(var K=0,e1=11;e1<b.HBLKSIZE;e1++)K+=d[e1];q.tot_ener[N]=K,M.analysis&&Q(),M.athaa_loudapprox==2&&N<2&&(q.loudness_sq[V][N]=q.loudness_sq_save[N],q.loudness_sq_save[N]=function(i1,b1){for(var G=0,P1=0;P1<b.BLKSIZE/2;++P1)G+=i1[P1]*b1.ATH.eql_w[P1];return G*=T}(d,q))}var I,v,O,W=8,r1=23,$=15,t1=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749],R=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],e=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],t=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function r(M,d,A,F,j,B){var P;if(M<d){if(!(d<M*v))return M+d;P=d/M}else{if(d*v<=M)return M+d;P=M/d}if(M+=d,F+3<=6){if(I<=P)return M;var U=0|v1.FAST_LOG10_X(P,16);return M*e[U]}var V,N,U=0|v1.FAST_LOG10_X(P,16);return d=B!=0?j.ATH.cb_s[A]*j.ATH.adjust:j.ATH.cb_l[A]*j.ATH.adjust,M<O*d?d<M?(V=1,U<=13&&(V=t[U]),N=v1.FAST_LOG10_X(M/d,10/15),M*((R[U]-V)*N+V)):13<U?M:M*t[U]:M*R[U]}function a(M,d,A,F,j){var B,P,V=0,N=0;for(B=P=0;B<b.SBMAX_s;++P,++B){for(var U=M.bo_s[B],a1=M.npart_s,q=U<a1?U:a1;P<q;)V+=d[P],N+=A[P],P++;if(M.en[F].s[B][j]=V,M.thm[F].s[B][j]=N,a1<=P){++B;break}var e1=M.PSY.bo_s_weight[B],J=1-e1;V=e1*d[P],N=e1*A[P],M.en[F].s[B][j]+=V,M.thm[F].s[B][j]+=N,V=J*d[P],N=J*A[P]}for(;B<b.SBMAX_s;++B)M.en[F].s[B][j]=0,M.thm[F].s[B][j]=0}function n(M,d,A,F){var j,B,P=0,V=0;for(j=B=0;j<b.SBMAX_l;++B,++j){for(var N=M.bo_l[j],U=M.npart_l,a1=N<U?N:U;B<a1;)P+=d[B],V+=A[B],B++;if(M.en[F].l[j]=P,M.thm[F].l[j]=V,U<=B){++j;break}var q=M.PSY.bo_l_weight[j],e1=1-q;P=q*d[B],V=q*A[B],M.en[F].l[j]+=P,M.thm[F].l[j]+=V,P=e1*d[B],V=e1*A[B]}for(;j<b.SBMAX_l;++j)M.en[F].l[j]=0,M.thm[F].l[j]=0}function s(M,d,A,F,j,B){var P,V,N=M.internal_flags;for(V=P=0;V<N.npart_s;++V){for(var U=0,a1=0,q=N.numlines_s[V],e1=0;e1<q;++e1,++P){var J=d[B][P];U+=J,a1<J&&(a1=J)}A[V]=U}for(P=V=0;V<N.npart_s;V++){var s1=N.s3ind_s[V][0],w1=N.s3_ss[P++]*A[s1];for(++s1;s1<=N.s3ind_s[V][1];)w1+=N.s3_ss[P]*A[s1],++P,++s1;var K=S*N.nb_s1[j][V];if(F[V]=Math.min(w1,K),N.blocktype_old[1&j]==b.SHORT_TYPE){var K=y*N.nb_s2[j][V],i1=F[V];F[V]=Math.min(K,i1)}N.nb_s2[j][V]=N.nb_s1[j][V],N.nb_s1[j][V]=w1}for(;V<=b.CBANDS;++V)A[V]=0,F[V]=0}function f(M,d,A){return 1<=A?M:A<=0?d:0<d?Math.pow(M/d,A)*d:0}var p=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function l(M,d){for(var A=309.07,F=0;F<b.SBMAX_s-1;F++)for(var j=0;j<3;j++){var B=M.thm.s[F][j];if(0<B){var P=B*d,V=M.en.s[F][j];P<V&&(A+=1e10*P<V?p[F]*(10*u):p[F]*v1.FAST_LOG10(V/P))}}return A}var o=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function i(M,d){for(var A=281.0575,F=0;F<b.SBMAX_l-1;F++){var j=M.thm.l[F];if(0<j){var B=j*d,P=M.en.l[F];B<P&&(A+=1e10*B<P?o[F]*(10*u):o[F]*v1.FAST_LOG10(P/B))}}return A}function c(M,d,A,F,j){var B,P;for(B=P=0;B<M.npart_l;++B){var V,N=0,U=0;for(V=0;V<M.numlines_l[B];++V,++P){var a1=d[P];N+=a1,U<a1&&(U=a1)}A[B]=N,F[B]=U,j[B]=N*M.rnumlines_l[B]}}function m(M,d,A,F){var j=t1.length-1,B=0,P=A[B]+A[B+1];if(0<P){var V=d[B];V<d[B+1]&&(V=d[B+1]);var N=0|(P=20*(2*V-P)/(P*(M.numlines_l[B]+M.numlines_l[B+1]-1)));j<N&&(N=j),F[B]=N}else F[B]=0;for(B=1;B<M.npart_l-1;B++)if(0<(P=A[B-1]+A[B]+A[B+1])){var V=d[B-1];V<d[B]&&(V=d[B]),V<d[B+1]&&(V=d[B+1]);var N=0|(P=20*(3*V-P)/(P*(M.numlines_l[B-1]+M.numlines_l[B]+M.numlines_l[B+1]-1)));j<N&&(N=j),F[B]=N}else F[B]=0;if(0<(P=A[B-1]+A[B])){var V=d[B-1];V<d[B]&&(V=d[B]);var N=0|(P=20*(2*V-P)/(P*(M.numlines_l[B-1]+M.numlines_l[B]-1)));j<N&&(N=j),F[B]=N}else F[B]=0}var h=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function g(M){return M<0&&(M=0),M*=.001,13*Math.atan(.76*M)+3.5*Math.atan(M*M/56.25)}function L(M,d,A,F,j,B,P,V,N,U,a1,q){var e1,J=H(b.CBANDS+1),s1=V/(15<q?1152:384),w1=f1(b.HBLKSIZE);V/=N;var K=0,i1=0;for(e1=0;e1<b.CBANDS;e1++){var b1;for(tt=g(V*K),J[e1]=V*K,b1=K;g(V*b1)-tt<C&&b1<=N/2;b1++);for(M[e1]=b1-K,i1=e1+1;K<b1;)w1[K++]=e1;if(N/2<K){K=N/2,++e1;break}}J[e1]=V*K;for(var G=0;G<q;G++){var P1,H1,V1,Y1,X1;V1=U[G],Y1=U[G+1],(P1=0|Math.floor(.5+a1*(V1-.5)))<0&&(P1=0),H1=0|Math.floor(.5+a1*(Y1-.5)),N/2<H1&&(H1=N/2),A[G]=(w1[P1]+w1[H1])/2,d[G]=w1[H1];var J1=s1*Y1;P[G]=(J1-J[d[G]])/(J[d[G]+1]-J[d[G]]),P[G]<0?P[G]=0:1<P[G]&&(P[G]=1),X1=g(V*U[G]*a1),X1=Math.min(X1,15.5)/15.5,B[G]=Math.pow(10,1.25*(1-Math.cos(Math.PI*X1))-2.5)}for(var G1=K=0;G1<i1;G1++){var tt,U1,nt=M[G1];tt=g(V*K),U1=g(V*(K+nt-1)),F[G1]=.5*(tt+U1),tt=g(V*(K-.5)),U1=g(V*(K+nt-.5)),j[G1]=U1-tt,K+=nt}return i1}function x(M,d,A,F,j,B){var P,V,N,U,a1,q,e1=y1([b.CBANDS,b.CBANDS]),J=0;if(B)for(var s1=0;s1<d;s1++)for(P=0;P<d;P++){var w1=(V=A[s1]-A[P],q=a1=U=N=void 0,N=V,U=.5<=(N*=0<=N?3:1.5)&&N<=2.5?8*((q=N-.5)*q-2*q):0,((a1=15.811389+7.5*(N+=.474)-17.5*Math.sqrt(1+N*N))<=-60?0:(N=Math.exp((U+a1)*Y),N/=.6609193))*F[P]);e1[s1][P]=w1*j[s1]}else Q();for(var s1=0;s1<d;s1++){for(P=0;P<d&&!(0<e1[s1][P]);P++);for(M[s1][0]=P,P=d-1;0<P&&!(0<e1[s1][P]);P--);M[s1][1]=P,J+=M[s1][1]-M[s1][0]+1}for(var K=H(J),i1=0,s1=0;s1<d;s1++)for(P=M[s1][0];P<=M[s1][1];P++)K[i1++]=e1[s1][P];return K}function z(M){var d=g(M);return d=Math.min(d,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*d))-2.5)}function D(M,d){M<-.3&&(M=3410),M/=1e3,M=Math.max(.1,M);var A=3.64*Math.pow(M,-.8)-6.8*Math.exp(-.6*Math.pow(M-3.4,2))+6*Math.exp(-.15*Math.pow(M-8.7,2))+.001*(.6+.04*d)*Math.pow(M,4);return A}this.L3psycho_anal_ns=function(M,d,A,F,j,B,P,V,N,U){var a1,q,e1,J,s1,w1,K,i1,b1,G=M.internal_flags,P1=y1([2,b.BLKSIZE]),H1=y1([2,3,b.BLKSIZE_s]),V1=H(b.CBANDS+1),Y1=H(b.CBANDS+1),X1=H(b.CBANDS+2),J1=f1(2),G1=f1(2),tt=y1([2,576]),U1=f1(b.CBANDS+2),nt=f1(b.CBANDS+2);for(p1.fill(nt,0),a1=G.channels_out,M.mode==n1.JOINT_STEREO&&(a1=4),b1=M.VBR==E.vbr_off?G.ResvMax==0?0:G.ResvSize/G.ResvMax*.5:M.VBR==E.vbr_rh||M.VBR==E.vbr_mtrh||M.VBR==E.vbr_mt?.6:1,q=0;q<G.channels_out;q++){var Q1=d[q],at=A+576-350-21+192;for(J=0;J<576;J++){var ht,pt;for(ht=Q1[at+J+10],s1=pt=0;s1<9;s1+=2)ht+=h[s1]*(Q1[at+J+s1]+Q1[at+J+21-s1]),pt+=h[s1+1]*(Q1[at+J+s1+1]+Q1[at+J+21-s1-1]);tt[q][J]=ht+pt}j[F][q].en.assign(G.en[q]),j[F][q].thm.assign(G.thm[q]),2<a1&&Q()}for(q=0;q<a1;q++){var St,et=H(12),st=[0,0,0,0],mt=H(12),Mt=1,At=H(b.CBANDS),yt=H(b.CBANDS),D1=[0,0,0,0],Rt=H(b.HBLKSIZE),Tt=y1([3,b.HBLKSIZE_s]);for(J=0;J<3;J++)et[J]=G.nsPsy.last_en_subshort[q][J+6],mt[J]=et[J]/G.nsPsy.last_en_subshort[q][J+4],st[0]+=et[J];q==2&&Q();var Bt=tt[1&q],_t=0;for(J=0;J<9;J++){for(var It=_t+64,K1=1;_t<It;_t++)K1<Math.abs(Bt[_t])&&(K1=Math.abs(Bt[_t]));G.nsPsy.last_en_subshort[q][J]=et[J+3]=K1,st[1+J/3]+=K1,K1>et[J+3-2]?K1/=et[J+3-2]:K1=et[J+3-2]>10*K1?et[J+3-2]/(10*K1):0,mt[J+3]=K1}for(M.analysis&&Q(),St=q==3?G.nsPsy.attackthre_s:G.nsPsy.attackthre,J=0;J<12;J++)D1[J/3]==0&&mt[J]>St&&(D1[J/3]=J%3+1);for(J=1;J<4;J++)(st[J-1]>st[J]?st[J-1]/st[J]:st[J]/st[J-1])<1.7&&(D1[J]=0,J==1&&(D1[0]=0));for(D1[0]!=0&&G.nsPsy.lastAttacks[q]!=0&&(D1[0]=0),G.nsPsy.lastAttacks[q]!=3&&D1[0]+D1[1]+D1[2]+D1[3]==0||((Mt=0)!=D1[1]&&D1[0]!=0&&(D1[1]=0),D1[2]!=0&&D1[1]!=0&&(D1[2]=0),D1[3]!=0&&D1[2]!=0&&(D1[3]=0)),q<2?G1[q]=Mt:Q(),N[q]=G.tot_ener[q],X(M,Rt,Tt,P1,1&q,H1,1&q,F,q,d,A),c(G,Rt,V1,At,yt),m(G,At,yt,U1),i1=0;i1<3;i1++){var bt,$1;for(s(M,Tt,Y1,X1,q,i1),a(G,Y1,X1,q,i1),K=0;K<b.SBMAX_s;K++){if($1=G.thm[q].s[K][i1],$1*=.8,2<=D1[i1]||D1[i1+1]==1){var ft=i1!=0?i1-1:2,K1=f(G.thm[q].s[K][ft],$1,.6*b1);$1=Math.min($1,K1)}if(D1[i1]==1){var ft=i1!=0?i1-1:2,K1=f(G.thm[q].s[K][ft],$1,.3*b1);$1=Math.min($1,K1)}else if(i1!=0&&D1[i1-1]==3||i1==0&&G.nsPsy.lastAttacks[q]==3){var ft=i1!=2?i1+1:0,K1=f(G.thm[q].s[K][ft],$1,.3*b1);$1=Math.min($1,K1)}bt=et[3*i1+3]+et[3*i1+4]+et[3*i1+5],6*et[3*i1+5]<bt&&($1*=.5,6*et[3*i1+4]<bt&&($1*=.5)),G.thm[q].s[K][i1]=$1}}for(G.nsPsy.lastAttacks[q]=D1[2],e1=w1=0;e1<G.npart_l;e1++){for(var it=G.s3ind[e1][0],vt=V1[it]*t1[U1[it]],ot=G.s3_ll[w1++]*vt;++it<=G.s3ind[e1][1];)vt=V1[it]*t1[U1[it]],ot=r(ot,G.s3_ll[w1++]*vt,it,it-e1,G,0);ot*=.158489319246111,G.blocktype_old[1&q]==b.SHORT_TYPE?X1[e1]=ot:X1[e1]=f(Math.min(ot,Math.min(2*G.nb_1[q][e1],16*G.nb_2[q][e1])),ot,b1),G.nb_2[q][e1]=G.nb_1[q][e1],G.nb_1[q][e1]=ot}for(;e1<=b.CBANDS;++e1)V1[e1]=0,X1[e1]=0;n(G,V1,X1,q)}for(M.mode!=n1.STEREO&&M.mode!=n1.JOINT_STEREO||Q(),M.mode==n1.JOINT_STEREO&&Q(),function(ct,lt,Pt,ut){var rt=ct.internal_flags;ct.short_blocks!=c1.short_block_coupled||lt[0]!=0&&lt[1]!=0||(lt[0]=lt[1]=0);for(var W1=0;W1<rt.channels_out;W1++)ut[W1]=b.NORM_TYPE,ct.short_blocks==c1.short_block_dispensed&&(lt[W1]=1),ct.short_blocks==c1.short_block_forced&&(lt[W1]=0),lt[W1]!=0?rt.blocktype_old[W1]==b.SHORT_TYPE&&(ut[W1]=b.STOP_TYPE):(ut[W1]=b.SHORT_TYPE,rt.blocktype_old[W1]==b.NORM_TYPE&&(rt.blocktype_old[W1]=b.START_TYPE),rt.blocktype_old[W1]==b.STOP_TYPE&&(rt.blocktype_old[W1]=b.SHORT_TYPE)),Pt[W1]=rt.blocktype_old[W1],rt.blocktype_old[W1]=ut[W1]}(M,G1,U,J1),q=0;q<a1;q++){var dt,xt,gt,wt=0;1<q?Q():(dt=P,wt=0,xt=U[q],gt=j[F][q]),dt[wt+q]=xt==b.SHORT_TYPE?l(gt,G.masking_lower):i(gt,G.masking_lower),M.analysis&&(G.pinfo.pe[F][q]=dt[wt+q])}return 0},this.psymodel_init=function(M){var d,A=M.internal_flags,F=!0,j=13,B=0,P=0,V=-8.25,N=-4.5,U=H(b.CBANDS),a1=H(b.CBANDS),q=H(b.CBANDS),e1=M.out_samplerate;switch(M.experimentalZ){default:case 0:F=!0;break;case 1:F=M.VBR!=E.vbr_mtrh&&M.VBR!=E.vbr_mt;break;case 2:F=!1;break;case 3:j=8,B=-1.75,P=-.0125,V=-8.25,N=-2.25}for(A.ms_ener_ratio_old=.25,A.blocktype_old[0]=A.blocktype_old[1]=b.NORM_TYPE,d=0;d<4;++d){for(var K=0;K<b.CBANDS;++K)A.nb_1[d][K]=1e20,A.nb_2[d][K]=1e20,A.nb_s1[d][K]=A.nb_s2[d][K]=1;for(var J=0;J<b.SBMAX_l;J++)A.en[d].l[J]=1e20,A.thm[d].l[J]=1e20;for(var K=0;K<3;++K){for(var J=0;J<b.SBMAX_s;J++)A.en[d].s[J][K]=1e20,A.thm[d].s[J][K]=1e20;A.nsPsy.lastAttacks[d]=0}for(var K=0;K<9;K++)A.nsPsy.last_en_subshort[d][K]=10}for(A.loudness_sq_save[0]=A.loudness_sq_save[1]=0,A.npart_l=L(A.numlines_l,A.bo_l,A.bm_l,U,a1,A.mld_l,A.PSY.bo_l_weight,e1,b.BLKSIZE,A.scalefac_band.l,b.BLKSIZE/1152,b.SBMAX_l),d=0;d<A.npart_l;d++){var s1=B;U[d]>=j&&(s1=P*(U[d]-j)/(24-j)+B*(24-U[d])/(24-j)),q[d]=Math.pow(10,s1/10),0<A.numlines_l[d]?A.rnumlines_l[d]=1/A.numlines_l[d]:A.rnumlines_l[d]=0}A.s3_ll=x(A.s3ind,A.npart_l,U,a1,q,F);var w1,K=0;for(d=0;d<A.npart_l;d++){G=R1.MAX_VALUE;for(var i1=0;i1<A.numlines_l[d];i1++,K++){var b1=e1*K/(1e3*b.BLKSIZE);P1=this.ATHformula(1e3*b1,M)-20,P1=Math.pow(10,.1*P1),(P1*=A.numlines_l[d])<G&&(G=P1)}A.ATH.cb_l[d]=G,6<(G=20*U[d]/10-20)&&(G=100),G<-15&&(G=-15),G-=8,A.minval_l[d]=Math.pow(10,G/10)*A.numlines_l[d]}for(A.npart_s=L(A.numlines_s,A.bo_s,A.bm_s,U,a1,A.mld_s,A.PSY.bo_s_weight,e1,b.BLKSIZE_s,A.scalefac_band.s,b.BLKSIZE_s/384,b.SBMAX_s),d=K=0;d<A.npart_s;d++){var G,s1=V;U[d]>=j&&(s1=N*(U[d]-j)/(24-j)+V*(24-U[d])/(24-j)),q[d]=Math.pow(10,s1/10),G=R1.MAX_VALUE;for(var i1=0;i1<A.numlines_s[d];i1++,K++){var P1,b1=e1*K/(1e3*b.BLKSIZE_s);P1=this.ATHformula(1e3*b1,M)-20,P1=Math.pow(10,.1*P1),(P1*=A.numlines_s[d])<G&&(G=P1)}A.ATH.cb_s[d]=G,G=7*U[d]/12-7,12<U[d]&&(G*=1+3.1*Math.log(1+G)),U[d]<12&&(G*=1+2.3*Math.log(1-G)),G<-15&&(G=-15),G-=8,A.minval_s[d]=Math.pow(10,G/10)*A.numlines_s[d]}A.s3_ss=x(A.s3ind_s,A.npart_s,U,a1,q,F),I=Math.pow(10,(W+1)/16),v=Math.pow(10,(r1+1)/16),O=Math.pow(10,$/10),_.init_fft(A),A.decay=Math.exp(-1*u/(.01*e1/192)),w1=3.5,2&M.exp_nspsytune&&(w1=1),0<Math.abs(M.msfix)&&(w1=M.msfix),M.msfix=w1;for(var H1=0;H1<A.npart_l;H1++)A.s3ind[H1][1]>A.npart_l-1&&(A.s3ind[H1][1]=A.npart_l-1);var V1=576*A.mode_gr/e1;if(A.ATH.decay=Math.pow(10,-1.2*V1),A.ATH.adjust=.01,-(A.ATH.adjustLimit=1)!=M.ATHtype){var Y1=M.out_samplerate/b.BLKSIZE,X1=0;for(d=b1=0;d<b.BLKSIZE/2;++d)b1+=Y1,A.ATH.eql_w[d]=1/Math.pow(10,this.ATHformula(b1,M)/10),X1+=A.ATH.eql_w[d];for(X1=1/X1,d=b.BLKSIZE/2;0<=--d;)A.ATH.eql_w[d]*=X1}for(var H1=K=0;H1<A.npart_s;++H1)for(d=0;d<A.numlines_s[H1];++d)++K;for(var H1=K=0;H1<A.npart_l;++H1)for(d=0;d<A.numlines_l[H1];++d)++K;for(d=K=0;d<A.npart_l;d++){var b1=e1*(K+A.numlines_l[d]/2)/(1*b.BLKSIZE);A.mld_cb_l[d]=z(b1),K+=A.numlines_l[d]}for(;d<b.CBANDS;++d)A.mld_cb_l[d]=1;for(d=K=0;d<A.npart_s;d++){var b1=e1*(K+A.numlines_s[d]/2)/(1*b.BLKSIZE_s);A.mld_cb_s[d]=z(b1),K+=A.numlines_s[d]}for(;d<b.CBANDS;++d)A.mld_cb_s[d]=1;return 0},this.ATHformula=function(M,d){var A;switch(d.ATHtype){case 0:A=D(M,9);break;case 1:A=D(M,-1);break;case 2:A=D(M,0);break;case 3:A=D(M,1)+6;break;case 4:A=D(M,d.ATHcurve);break;default:A=D(M,0)}return A}}function w(){var _,u,S,y,C,T=this;w.V9=410,w.V8=420,w.V7=430,w.V6=440,w.V5=450,w.V4=460,w.V3=470,w.V2=480,w.V1=490,w.V0=500,w.R3MIX=1e3,w.STANDARD=1001,w.EXTREME=1002,w.INSANE=1003,w.STANDARD_FAST=1004,w.EXTREME_FAST=1005,w.MEDIUM=1006,w.MEDIUM_FAST=1007,w.LAME_MAXMP3BUFFER=147456;var Y,X,I=new N1;function v(){this.lowerlimit=0}function O(e,t){this.lowpass=t}this.enc=new b,this.setModules=function(e,t,r,a,n,s,f,p,l){_=e,u=t,S=r,y=a,C=n,Y=s,X=p,this.enc.setModules(u,I,y,Y)};var W=4294479419;function r1(e,t){var r=[new O(8,2e3),new O(16,3700),new O(24,3900),new O(32,5500),new O(40,7e3),new O(48,7500),new O(56,1e4),new O(64,11e3),new O(80,13500),new O(96,15100),new O(112,15600),new O(128,17e3),new O(160,17500),new O(192,18600),new O(224,19400),new O(256,19700),new O(320,20500)],a=T.nearestBitrateFullIndex(t);e.lowerlimit=r[a].lowpass}function $(e){var t=b.BLKSIZE+e.framesize-b.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function t1(){this.n_in=0,this.n_out=0}function R(e,t,r,a,n,s){var f=e.internal_flags;if(f.resample_ratio<.9999||1.0001<f.resample_ratio)Q();else{s.n_out=Math.min(e.framesize,n),s.n_in=s.n_out;for(var p=0;p<s.n_out;++p)t[0][f.mf_size+p]=r[0][a+p],f.channels_out==2&&(t[1][f.mf_size+p]=r[1][a+p])}}this.lame_init=function(){var e,t,r=new function(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=n1.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null},a=((e=r).class_id=W,t=e.internal_flags=new Z,e.mode=n1.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=E.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=b.ENCDELAY+b.POSTDELAY,e.encoder_padding=0,t.mf_size=b.ENCDELAY-b.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0);return a!=0?null:(r.lame_allocated_gfp=1,r)},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],r=0,a=0,n=0,s=0;s=t[16],a=t[n=16],r=16;for(var f=0;f<16;f++)if(Math.max(e,t[f+1])!=e){s=t[f+1],n=f+1,a=t[f],r=f;break}return e-a<s-e?r:n},this.lame_init_params=function(e){var t,r,a=e.internal_flags;if(a.Class_ID=0,a.ATH==null&&(a.ATH=new function(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=H(b.SBMAX_l),this.s=H(b.SBMAX_s),this.psfb21=H(b.PSFB21),this.psfb12=H(b.PSFB12),this.cb_l=H(b.CBANDS),this.cb_s=H(b.CBANDS),this.eql_w=H(b.BLKSIZE/2)}),a.PSY==null&&(a.PSY=new function(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=H(b.SBMAX_l),this.bo_s_weight=H(b.SBMAX_s)}),a.rgdata==null&&(a.rgdata=new function(){}),a.channels_in=e.num_channels,a.channels_in==1&&(e.mode=n1.MONO),a.channels_out=e.mode==n1.MONO?1:2,a.mode_ext=b.MPG_MD_MS_LR,e.mode==n1.MONO&&(e.force_ms=!1),e.VBR==E.vbr_off&&e.VBR_mean_bitrate_kbps!=128&&e.brate==0&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==E.vbr_off||e.VBR==E.vbr_mtrh||e.VBR==E.vbr_mt||(e.free_format=!1),e.VBR==E.vbr_off&&e.brate==0&&Q(),e.VBR==E.vbr_off&&0<e.compression_ratio&&Q(),e.out_samplerate!=0&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),e.lowpassfreq==0){var n=16e3;switch(e.VBR){case E.vbr_off:var s=new v;r1(s,e.brate),n=s.lowerlimit;break;case E.vbr_abr:var s=new v;r1(s,e.VBR_mean_bitrate_kbps),n=s.lowerlimit;break;case E.vbr_rh:Q();default:Q()}e.mode!=n1.MONO||e.VBR!=E.vbr_off&&e.VBR!=E.vbr_abr||(n*=1.5),e.lowpassfreq=0|n}switch(e.out_samplerate==0&&Q(),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==E.vbr_off&&(e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.brate)),e.VBR==E.vbr_abr&&Q(),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,a.findPeakSample=!1),a.findReplayGain=e.findReplayGain,a.decode_on_the_fly=e.decode_on_the_fly,a.decode_on_the_fly&&(a.findPeakSample=!0),a.findReplayGain&&Q(),a.decode_on_the_fly&&!e.decode_only&&Q(),a.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*a.mode_gr,e.encoder_delay=b.ENCDELAY,a.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case E.vbr_mt:case E.vbr_rh:case E.vbr_mtrh:e.compression_ratio=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5][e.VBR_q];break;case E.vbr_abr:e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*a.channels_out/(1e3*e.brate)}e.mode==n1.NOT_SET&&(e.mode=n1.JOINT_STEREO),0<e.highpassfreq?Q():(a.highpass1=0,a.highpass2=0),0<e.lowpassfreq?(a.lowpass2=2*e.lowpassfreq,0<=e.lowpasswidth?Q():a.lowpass1=2*e.lowpassfreq,a.lowpass1/=e.out_samplerate,a.lowpass2/=e.out_samplerate):Q(),function(m){var h,g=m.internal_flags,L=32;if(0<g.lowpass1){for(var x=999,z=0;z<=31;z++){var D=z/31;D>=g.lowpass2&&(L=Math.min(L,z)),g.lowpass1<D&&D<g.lowpass2&&(x=Math.min(x,z))}g.lowpass1=x==999?(L-.75)/31:(x-.75)/31,g.lowpass2=L/31}0<g.highpass2&&Q(),0<g.highpass2&&Q();for(var z=0;z<32;z++){var M,d,D=z/31;g.highpass2>g.highpass1?Q():M=1,d=g.lowpass2>g.lowpass1?1<(h=(D-g.lowpass1)/(g.lowpass2-g.lowpass1+1e-20))?0:h<=0?1:Math.cos(Math.PI/2*h):1,g.amp_filter[z]=M*d}}(e),a.samplerate_index=function(m,h){switch(m){case 44100:return h.version=1,0;case 48e3:return h.version=1;case 32e3:return h.version=1,2;case 22050:return h.version=0;case 24e3:return h.version=0,1;case 16e3:return h.version=0,2;case 11025:return h.version=0;case 12e3:return h.version=0,1;case 8e3:return h.version=0,2;default:return h.version=0,-1}}(e.out_samplerate,e),a.samplerate_index<0&&Q(),e.VBR==E.vbr_off?e.free_format?a.bitrate_index=0:(e.brate=function(m,h,g){g<16e3&&(h=2);for(var L=k.bitrate_table[h][1],x=2;x<=14;x++)0<k.bitrate_table[h][x]&&Math.abs(k.bitrate_table[h][x]-m)<Math.abs(L-m)&&(L=k.bitrate_table[h][x]);return L}(e.brate,e.version,e.out_samplerate),a.bitrate_index=function(m,h,g){g<16e3&&(h=2);for(var L=0;L<=14;L++)if(0<k.bitrate_table[h][L]&&k.bitrate_table[h][L]==m)return L;return-1}(e.brate,e.version,e.out_samplerate),a.bitrate_index<=0&&Q()):a.bitrate_index=1,e.analysis&&(e.bWriteVbrTag=!1),a.pinfo!=null&&(e.bWriteVbrTag=!1),u.init_bit_stream_w(a);for(var f,p=a.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),l=0;l<b.SBMAX_l+1;l++)a.scalefac_band.l[l]=y.sfBandIndex[p].l[l];for(var l=0;l<b.PSFB21+1;l++){var o=(a.scalefac_band.l[22]-a.scalefac_band.l[21])/b.PSFB21,i=a.scalefac_band.l[21]+l*o;a.scalefac_band.psfb21[l]=i}a.scalefac_band.psfb21[b.PSFB21]=576;for(var l=0;l<b.SBMAX_s+1;l++)a.scalefac_band.s[l]=y.sfBandIndex[p].s[l];for(var l=0;l<b.PSFB12+1;l++){var o=(a.scalefac_band.s[13]-a.scalefac_band.s[12])/b.PSFB12,i=a.scalefac_band.s[12]+l*o;a.scalefac_band.psfb12[l]=i}for(a.scalefac_band.psfb12[b.PSFB12]=192,e.version==1?a.sideinfo_len=a.channels_out==1?21:36:a.sideinfo_len=a.channels_out==1?13:21,e.error_protection&&(a.sideinfo_len+=2),r=void 0,r=(t=e).internal_flags,t.frameNum=0,t.write_id3tag_automatic&&X.id3tag_write_v2(t),r.bitrate_stereoMode_Hist=S1([16,5]),r.bitrate_blockType_Hist=S1([16,6]),r.PeakSample=0,t.bWriteVbrTag&&Y.InitVbrTag(t),a.Class_ID=W,f=0;f<19;f++)a.nsPsy.pefirbuf[f]=700*a.mode_gr*a.channels_out;switch(e.ATHtype==-1&&(e.ATHtype=4),e.VBR){case E.vbr_mt:e.VBR=E.vbr_mtrh;case E.vbr_mtrh:e.useTemporal==null&&(e.useTemporal=!1),S.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),5<e.quality&&(e.quality=5),a.PSY.mask_adjust=e.maskingadjust,a.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?a.sfb21_extra=!1:a.sfb21_extra=44e3<e.out_samplerate,a.iteration_loop=new VBRNewIterationLoop(C);break;case E.vbr_rh:S.apply_preset(e,500-10*e.VBR_q,0),a.PSY.mask_adjust=e.maskingadjust,a.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?a.sfb21_extra=!1:a.sfb21_extra=44e3<e.out_samplerate,6<e.quality&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),a.iteration_loop=new VBROldIterationLoop(C);break;default:var c;a.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(c=e.VBR)==E.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),S.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=c,a.PSY.mask_adjust=e.maskingadjust,a.PSY.mask_adjust_short=e.maskingadjust_short,c==E.vbr_off?a.iteration_loop=new function(m){var h=m;this.quantize=h,this.iteration_loop=function(g,L,x,z){var D=g.internal_flags,M=H(h1.SFBMAX),d=H(576),A=f1(2),F=0,j=D.l3_side,B=new g1(F);this.quantize.rv.ResvFrameBegin(g,B),F=B.bits;for(var P=0;P<D.mode_gr;P++){this.quantize.qupvt.on_pe(g,L,A,F,P,P),D.mode_ext==b.MPG_MD_MS_LR&&Q();for(var V=0;V<D.channels_out;V++){var N,U,a1=j.tt[P][V];a1.block_type!=b.SHORT_TYPE?(N=0,U=D.PSY.mask_adjust-N):(N=0,U=D.PSY.mask_adjust_short-N),D.masking_lower=Math.pow(10,.1*U),this.quantize.init_outer_loop(D,a1),this.quantize.init_xrpow(D,a1,d)&&(this.quantize.qupvt.calc_xmin(g,z[P][V],a1,M),this.quantize.outer_loop(g,a1,M,d,V,A[V])),this.quantize.iteration_finish_one(D,P,V)}}this.quantize.rv.ResvFrameEnd(D,F)}}(C):Q()}return e.VBR!=E.vbr_off&&Q(),e.tune&&Q(),function(m){var h=m.internal_flags;switch(m.quality){default:case 9:h.psymodel=0,h.noise_shaping=0,h.noise_shaping_amp=0,h.noise_shaping_stop=0,h.use_best_huffman=0,h.full_outer_loop=0;break;case 8:m.quality=7;case 7:h.psymodel=1,h.noise_shaping=0,h.noise_shaping_amp=0,h.noise_shaping_stop=0,h.use_best_huffman=0,h.full_outer_loop=0;break;case 6:case 5:h.psymodel=1,h.noise_shaping==0&&(h.noise_shaping=1),h.noise_shaping_amp=0,h.noise_shaping_stop=0,h.subblock_gain==-1&&(h.subblock_gain=1),h.use_best_huffman=0,h.full_outer_loop=0;break;case 4:h.psymodel=1,h.noise_shaping==0&&(h.noise_shaping=1),h.noise_shaping_amp=0,h.noise_shaping_stop=0,h.subblock_gain==-1&&(h.subblock_gain=1),h.use_best_huffman=1,h.full_outer_loop=0;break;case 3:h.psymodel=1,h.noise_shaping==0&&(h.noise_shaping=1),h.noise_shaping_amp=1,-(h.noise_shaping_stop=1)==h.subblock_gain&&(h.subblock_gain=1),h.use_best_huffman=1,h.full_outer_loop=0;break;case 2:h.psymodel=1,h.noise_shaping==0&&(h.noise_shaping=1),h.substep_shaping==0&&(h.substep_shaping=2),h.noise_shaping_amp=1,-(h.noise_shaping_stop=1)==h.subblock_gain&&(h.subblock_gain=1),h.use_best_huffman=1,h.full_outer_loop=0;break;case 1:case 0:h.psymodel=1,h.noise_shaping==0&&(h.noise_shaping=1),h.substep_shaping==0&&(h.substep_shaping=2),h.noise_shaping_amp=2,-(h.noise_shaping_stop=1)==h.subblock_gain&&(h.subblock_gain=1),h.use_best_huffman=1,h.full_outer_loop=0}}(e),e.athaa_type<0?a.ATH.useAdjust=3:a.ATH.useAdjust=e.athaa_type,a.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),e.short_blocks==null&&(e.short_blocks=c1.short_block_allowed),e.short_blocks!=c1.short_block_allowed||e.mode!=n1.JOINT_STEREO&&e.mode!=n1.STEREO||(e.short_blocks=c1.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=N1.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=N1.NSATTACKTHRE_S),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),e.useTemporal==null&&(e.useTemporal=!0),a.slot_lag=a.frac_SpF=0,e.VBR==E.vbr_off&&(a.slot_lag=a.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),y.iteration_init(e),I.psymodel_init(e),0},this.lame_encode_flush=function(e,t,r,a){var n,s,f,p,l=e.internal_flags,o=d1([2,1152]),i=0,c=l.mf_samples_to_encode-b.POSTDELAY,m=$(e);if(l.mf_samples_to_encode<1)return 0;for(n=0,e.in_samplerate!=e.out_samplerate&&Q(),(f=e.framesize-c%e.framesize)<576&&(f+=e.framesize),e.encoder_padding=f,p=(c+f)/e.framesize;0<p&&0<=i;){var h=m-l.mf_size,g=e.frameNum;h*=e.in_samplerate,1152<(h/=e.out_samplerate)&&(h=1152),h<1&&(h=1),s=a-n,a==0&&(s=0),i=this.lame_encode_buffer(e,o[0],o[1],h,t,r,s),r+=i,n+=i,p-=g!=e.frameNum?1:0}return l.mf_samples_to_encode=0,i<0?i:(s=a-n,a==0&&(s=0),u.flush_bitstream(e),(i=u.copy_buffer(l,t,r,s,1))<0?i:(r+=i,s=a-(n+=i),a==0&&(s=0),e.write_id3tag_automatic&&Q(),n))},this.lame_encode_buffer=function(e,t,r,a,n,s,f){var p,l,o=e.internal_flags,i=[null,null];if(o.Class_ID!=W)return-3;if(a==0)return 0;l=a,((p=o).in_buffer_0==null||p.in_buffer_nsamples<l)&&(p.in_buffer_0=H(l),p.in_buffer_1=H(l),p.in_buffer_nsamples=l),i[0]=o.in_buffer_0,i[1]=o.in_buffer_1;for(var c=0;c<a;c++)i[0][c]=t[c],1<o.channels_in&&(i[1][c]=r[c]);return function(m,h,g,L,x,z,D){var M,d,A,F,j,B=m.internal_flags,P=0,V=[null,null],N=[null,null];if(B.Class_ID!=W)return-3;if(L==0)return 0;if((j=u.copy_buffer(B,x,z,D,0))<0)return j;if(z+=j,P+=j,N[0]=h,N[1]=g,m1.NEQ(m.scale,0)&&m1.NEQ(m.scale,1))for(d=0;d<L;++d)N[0][d]*=m.scale,B.channels_out==2&&(N[1][d]*=m.scale);if(m1.NEQ(m.scale_left,0)&&m1.NEQ(m.scale_left,1))for(d=0;d<L;++d)N[0][d]*=m.scale_left;if(m1.NEQ(m.scale_right,0)&&m1.NEQ(m.scale_right,1))for(d=0;d<L;++d)N[1][d]*=m.scale_right;m.num_channels==2&&B.channels_out==1&&Q(),F=$(m),V[0]=B.mfbuf[0],V[1]=B.mfbuf[1];for(var U,a1,q,e1,J,s1,w1,K=0;0<L;){var i1=[null,null],b1=0,G=0;i1[0]=N[0],i1[1]=N[1];var P1=new t1;if(R(m,V,i1,K,L,P1),b1=P1.n_in,G=P1.n_out,B.findReplayGain&&!B.decode_on_the_fly&&_.AnalyzeSamples(B.rgdata,V[0],B.mf_size,V[1],B.mf_size,G,B.channels_out)==u1.GAIN_ANALYSIS_ERROR)return-6;if(L-=b1,K+=b1,B.channels_out,B.mf_size+=G,B.mf_samples_to_encode<1&&Q(),B.mf_samples_to_encode+=G,B.mf_size>=F){var H1=D-P;if(D==0&&(H1=0),U=m,a1=V[0],q=V[1],e1=x,J=z,s1=H1,w1=T.enc.lame_encode_mp3_frame(U,a1,q,e1,J,s1),U.frameNum++,(M=w1)<0)return M;for(z+=M,P+=M,B.mf_size-=m.framesize,B.mf_samples_to_encode-=m.framesize,A=0;A<B.channels_out;A++)for(d=0;d<B.mf_size;d++)V[A][d]=V[A][d+m.framesize]}}return P}(e,i[0],i[1],a,n,s,f)}}h1.SFBMAX=3*b.SBMAX_s,b.ENCDELAY=576,b.POSTDELAY=1152,b.FFTOFFSET=224+(b.MDCTDELAY=48),b.DECDELAY=528,b.SBLIMIT=32,b.CBANDS=64,b.SBPSY_l=21,b.SBPSY_s=12,b.SBMAX_l=22,b.SBMAX_s=13,b.PSFB21=6,b.PSFB12=6,b.HBLKSIZE=(b.BLKSIZE=1024)/2+1,b.HBLKSIZE_s=(b.BLKSIZE_s=256)/2+1,b.NORM_TYPE=0,b.START_TYPE=1,b.SHORT_TYPE=2,b.STOP_TYPE=3,b.MPG_MD_LR_LR=0,b.MPG_MD_LR_I=1,b.MPG_MD_MS_LR=2,b.MPG_MD_MS_I=3,b.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],Z.MFSIZE=3456+b.ENCDELAY-b.MDCTDELAY,Z.MAX_HEADER_BUF=256,Z.MAX_BITS_PER_CHANNEL=4095,Z.MAX_BITS_PER_GRANULE=7680,Z.BPC=320,h1.SFBMAX=3*b.SBMAX_s,T1.Mp3Encoder=function(_,u,S){_!=1&&Q("fix cc: only supports mono");var y=new w,C=new function(){this.setModules=function(s,f){}},T=new u1,Y=new m1,X=new function(){function s(i,c,m,h,g,L,x,z,D,M,d,A,F,j){this.quant_comp=c,this.quant_comp_s=m,this.safejoint=h,this.nsmsfix=g,this.st_lrm=L,this.st_s=x,this.nsbass=z,this.scale=D,this.masking_adj=M,this.ath_lower=d,this.ath_curve=A,this.interch=F,this.sfscale=j}var f;function p(i,c,m){Q()}this.setModules=function(i){f=i};var l=[new s(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new s(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new s(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new s(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new s(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new s(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new s(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new s(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new s(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new s(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new s(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new s(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new s(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new s(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new s(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new s(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new s(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function o(i,c,m){var h=c,g=f.nearestBitrateFullIndex(c);if(i.VBR=E.vbr_abr,i.VBR_mean_bitrate_kbps=h,i.VBR_mean_bitrate_kbps=Math.min(i.VBR_mean_bitrate_kbps,320),i.VBR_mean_bitrate_kbps=Math.max(i.VBR_mean_bitrate_kbps,8),i.brate=i.VBR_mean_bitrate_kbps,320<i.VBR_mean_bitrate_kbps&&(i.disable_reservoir=!0),0<l[g].safejoint&&(i.exp_nspsytune=2|i.exp_nspsytune),0<l[g].sfscale&&(i.internal_flags.noise_shaping=2),0<Math.abs(l[g].nsbass)){var L=int(4*l[g].nsbass);L<0&&(L+=64),i.exp_nspsytune=i.exp_nspsytune|L<<2}return m!=0?i.quant_comp=l[g].quant_comp:0<Math.abs(i.quant_comp- -1)||(i.quant_comp=l[g].quant_comp),m!=0?i.quant_comp_short=l[g].quant_comp_s:0<Math.abs(i.quant_comp_short- -1)||(i.quant_comp_short=l[g].quant_comp_s),m!=0?i.msfix=l[g].nsmsfix:0<Math.abs(i.msfix- -1)||(i.msfix=l[g].nsmsfix),m!=0?i.internal_flags.nsPsy.attackthre=l[g].st_lrm:0<Math.abs(i.internal_flags.nsPsy.attackthre- -1)||(i.internal_flags.nsPsy.attackthre=l[g].st_lrm),m!=0?i.internal_flags.nsPsy.attackthre_s=l[g].st_s:0<Math.abs(i.internal_flags.nsPsy.attackthre_s- -1)||(i.internal_flags.nsPsy.attackthre_s=l[g].st_s),m!=0?i.scale=l[g].scale:0<Math.abs(i.scale- -1)||(i.scale=l[g].scale),m!=0?i.maskingadjust=l[g].masking_adj:0<Math.abs(i.maskingadjust-0)||(i.maskingadjust=l[g].masking_adj),0<l[g].masking_adj?m!=0?i.maskingadjust_short=.9*l[g].masking_adj:0<Math.abs(i.maskingadjust_short-0)||(i.maskingadjust_short=.9*l[g].masking_adj):m!=0?i.maskingadjust_short=1.1*l[g].masking_adj:0<Math.abs(i.maskingadjust_short-0)||(i.maskingadjust_short=1.1*l[g].masking_adj),m!=0?i.ATHlower=-l[g].ath_lower/10:0<Math.abs(10*-i.ATHlower-0)||(i.ATHlower=-l[g].ath_lower/10),m!=0?i.ATHcurve=l[g].ath_curve:0<Math.abs(i.ATHcurve- -1)||(i.ATHcurve=l[g].ath_curve),m!=0?i.interChRatio=l[g].interch:0<Math.abs(i.interChRatio- -1)||(i.interChRatio=l[g].interch),c}this.apply_preset=function(i,c,m){switch(c){case w.R3MIX:c=w.V3,i.VBR=E.vbr_mtrh;break;case w.MEDIUM:c=w.V4,i.VBR=E.vbr_rh;break;case w.MEDIUM_FAST:c=w.V4,i.VBR=E.vbr_mtrh;break;case w.STANDARD:c=w.V2,i.VBR=E.vbr_rh;break;case w.STANDARD_FAST:c=w.V2,i.VBR=E.vbr_mtrh;break;case w.EXTREME:c=w.V0,i.VBR=E.vbr_rh;break;case w.EXTREME_FAST:c=w.V0,i.VBR=E.vbr_mtrh;break;case w.INSANE:return c=320,i.preset=c,o(i,c,m),i.VBR=E.vbr_off,c}switch(i.preset=c){case w.V9:return p(),c;case w.V8:return p(),c;case w.V7:return p(),c;case w.V6:return p(),c;case w.V5:return p(),c;case w.V4:return p(),c;case w.V3:return p(),c;case w.V2:return p(),c;case w.V1:return p(),c;case w.V0:return p(),c}return 8<=c&&c<=320?o(i,c,m):(i.preset=0,c)}},I=new E1,v=new I1,O=new M1,W=new function(){this.getLameShortVersion=function(){return"3.98.4"}},r1=new function(){this.setModules=function(s,f){}},$=new function(){var s;this.setModules=function(f){s=f},this.ResvFrameBegin=function(f,p){var l,o=f.internal_flags,i=o.l3_side,c=s.getframebits(f);p.bits=(c-8*o.sideinfo_len)/o.mode_gr;var m=2048*o.mode_gr-8;320<f.brate?Q():(l=11520,f.strict_ISO&&Q()),o.ResvMax=l-c,o.ResvMax>m&&(o.ResvMax=m),(o.ResvMax<0||f.disable_reservoir)&&(o.ResvMax=0);var h=p.bits*o.mode_gr+Math.min(o.ResvSize,o.ResvMax);return l<h&&(h=l),i.resvDrain_pre=0,o.pinfo!=null&&Q(),h},this.ResvMaxBits=function(f,p,l,o){var i,c=f.internal_flags,m=c.ResvSize,h=c.ResvMax;o!=0&&(m+=p),1&c.substep_shaping&&(h*=.9),l.bits=p,9*h<10*m?(i=m-9*h/10,l.bits+=i,c.substep_shaping|=128):(i=0,c.substep_shaping&=127,f.disable_reservoir||1&c.substep_shaping||(l.bits-=.1*p));var g=m<6*c.ResvMax/10?m:6*c.ResvMax/10;return(g-=i)<0&&(g=0),g},this.ResvAdjust=function(f,p){f.ResvSize-=p.part2_3_length+p.part2_length},this.ResvFrameEnd=function(f,p){var l,o=f.l3_side;f.ResvSize+=p*f.mode_gr;var i=0;o.resvDrain_post=0,(o.resvDrain_pre=0)!=(l=f.ResvSize%8)&&(i+=l),0<(l=f.ResvSize-i-f.ResvMax)&&(i+=l);var c=Math.min(8*o.main_data_begin,i)/8;o.resvDrain_pre+=8*c,i-=8*c,f.ResvSize-=8*c,o.main_data_begin-=c,o.resvDrain_post+=i,f.ResvSize-=i}},t1=new l1,R=new function(){this.setModules=function(s,f,p){}},e=new function(){};y.setModules(T,Y,X,I,v,O,W,r1,e),Y.setModules(T,e,W,O),r1.setModules(Y,W),X.setModules(y),v.setModules(Y,$,I,t1),I.setModules(t1,$,y.enc.psy),$.setModules(Y),t1.setModules(I),O.setModules(y,Y,W),C.setModules(R,e),R.setModules(W,r1,X);var t=y.lame_init();t.num_channels=_,t.in_samplerate=u,t.out_samplerate=u,t.brate=S,t.mode=n1.STEREO,t.quality=3,t.bWriteVbrTag=!1,t.disable_reservoir=!0,t.write_id3tag_automatic=!1,y.lame_init_params(t);var r=1152,a=0|1.25*r+7200,n=A1(a);this.encodeBuffer=function(s,f){_==1&&(f=s),s.length>r&&(r=s.length,n=A1(a=0|1.25*r+7200));var p=y.lame_encode_buffer(t,s,f,s.length,n,0,a);return new Int8Array(n.subarray(0,p))},this.flush=function(){var s=y.lame_encode_flush(t,n,0,a);return new Int8Array(n.subarray(0,s))}}}T1(),q1.lamejs=T1}((typeof window=="object"&&window.document?window:Object).Recorder)})(Et);var Nt=Et.exports;const Dt=Lt(Nt),Vt=function(F1){let q1,T1,z1,Q,A1,Z1,f1,H;const j1=function(S1){q1=Math.round(Math.log(S1)/Math.log(2)),T1=1<<q1,z1=(T1<<2)*Math.sqrt(2),Q=[],A1=[],Z1=[0],f1=[0],H=[];let d1,L1,p1,k1;for(d1=0;d1<T1;d1++){for(p1=d1,L1=0,k1=0;L1!=q1;L1++)k1<<=1,k1|=p1&1,p1>>>=1;H[d1]=k1}let v1,c1=2*Math.PI/T1;for(d1=(T1>>1)-1;d1>0;d1--)v1=d1*c1,f1[d1]=Math.cos(v1),Z1[d1]=Math.sin(v1)},y1=function(S1){let d1,L1,p1,k1,v1=1,c1=q1-1,R1,E,n1,l1;for(d1=0;d1!=T1;d1++)Q[d1]=S1[H[d1]],A1[d1]=0;for(d1=q1;d1!=0;d1--){for(L1=0;L1!=v1;L1++)for(R1=f1[L1<<c1],E=Z1[L1<<c1],p1=L1;p1<T1;p1+=v1<<1)k1=p1+v1,n1=R1*Q[k1]-E*A1[k1],l1=R1*A1[k1]+E*Q[k1],Q[k1]=Q[p1]-n1,A1[k1]=A1[p1]-l1,Q[p1]+=n1,A1[p1]+=l1;v1<<=1,c1--}L1=T1>>1;const u1=new Float64Array(L1);for(E=z1,R1=-z1,d1=L1;d1!=0;d1--)n1=Q[d1],l1=A1[d1],n1>R1&&n1<E&&l1>R1&&l1<E?u1[d1-1]=0:u1[d1-1]=Math.round(n1*n1+l1*l1);return u1};return j1(F1),{transform:y1,bufferSize:T1}},Xt=(F1,q1)=>{q1=q1||{type:"mp3",sampleRate:32e3,bitRate:32,duration:6e5,numberOfChannels:1,encodeBitRate:64e3,format:"mp3",frameSize:1};const T1=kt(!1),z1=kt(!1),Q=Ct(),A1=()=>{Q.value=Dt({...q1,async onProcess(y1,S1,d1,L1){var p1;(p1=F1==null?void 0:F1.ondata)==null||p1.call(F1,{pcmData:y1[y1.length-1],powerLevel:S1,sampleRate:L1})}})},Z1=()=>new Promise(async(y1,S1)=>{Q.value||A1(),Q.value.open(()=>{z1.value=!0,y1()},d1=>{z1.value=!1,S1("无法录音:"+d1)})}),f1=async()=>{var y1;try{Q.value||A1(),Q.value.start(q1),T1.value=!0,(y1=F1.onstart)==null||y1.call(F1)}catch(S1){return console.log(S1),Promise.reject(S1)}},H=()=>{var y1;Q.value&&T1.value&&((y1=Q.value)==null||y1.stop((S1,d1)=>{var p1;const L1=window.URL.createObjectURL(S1);return T1.value=!1,(p1=F1.onstop)==null?void 0:p1.call(F1,{tempFilePath:L1,duration:d1,blob:S1})},()=>{T1.value=!1}))},j1=()=>{var y1,S1;(S1=(y1=Q.value)==null?void 0:y1.close)==null||S1.call(y1,()=>{T1.value=!1,z1.value=!1}),Q.value=null};return Ht(()=>{H(),j1()}),{isRecording:T1,isOpen:z1,mediaRecorder:Q,start:f1,authorize:Z1,stop:H,close:j1}},Ft={id:"",width:0,height:0,scale:2,fps:30,fftSize:1024,lineCount:6,widthRatio:.6,spaceWidth:0,minHeight:8,position:0,mirrorEnable:!1,fallDuration:600,linear:[{pos:0,color:"white"},{pos:1,color:"white"}],round:!0,fullFreq:!1},jt=F1=>{const q1=F1.id;q1||console.error("绘制图形前必须指定`canvasId`");let T1=Object.assign({},Ft,F1);(!T1.width||!T1.height)&&console.error("必须指定画布的宽高");const z1=Vt(T1.fftSize);let Q,A1=0,Z1=0,f1=0,H=0,j1=[];const y1=c1=>{Q=c1,A1=0,Z1=Date.now(),k1()},S1=(c1,R1,E,n1)=>{const l1=c1.createLinearGradient(0,E,0,n1);for(let u1=0;u1<R1.length;u1++)l1.addColorStop(R1[u1].pos,R1[u1].color);return l1},d1=(c1,R1,E,n1,l1,u1)=>{const[M1,m1,o1,k]=u1;c1.beginPath(),c1.moveTo(R1+M1,E),c1.lineTo(R1+n1-M1,E),c1.arc(R1+n1-m1,E+m1,m1,Math.PI*1.5,Math.PI*2),c1.lineTo(R1+n1,E+l1-o1),c1.arc(R1+n1-o1,E+l1-o1,o1,0,Math.PI*.5),c1.lineTo(R1+k,E+l1),c1.arc(R1+k,E+l1-k,k,Math.PI*.5,Math.PI),c1.lineTo(R1,E+M1),c1.arc(R1+M1,E+M1,M1,Math.PI,Math.PI*1.5),c1.fill()},L1=T1.onDraw?T1.onDraw:(c1,{frequencyData:R1,sampleRate:E,options:n1})=>{const{scale:l1,width:u1,height:M1,lineCount:m1,round:o1,fftSize:k,position:g1,fallDuration:O1,fps:B1,fullFreq:E1,linear:C1,mirrorEnable:h1}=n1,I1=u1*l1,x1=M1*l1,b=Math.abs(g1);let _1=g1==1?0:x1,Z=x1;b<1&&(Z=Z/2,_1=Z,Z=Math.floor(Z*(1+b)),_1=Math.floor(g1>0?_1*(1-b):_1*(1+b)));const N1=j1,w=Math.ceil(Z/(O1/(1e3/B1))),_=1<<(Math.round(Math.log(k)/Math.log(2)+3)<<1),u=Math.log(_)/Math.log(10),S=20*Math.log(32767)/Math.log(10),y=k/2.5;let C=y;E1||(C=Math.min(y,Math.floor(y*5e3/(E/2))));const T=C==k,Y=T?m1:Math.round(m1*.8),X=C/Y,I=T?0:(y-C)/(m1-Y);let v=0;for(let n=0;n<m1;n++){const s=Math.ceil(v);n<Y?v+=X:v+=I;let f=Math.ceil(v);f==s&&f++,f=Math.min(f,y);let p=0;if(R1)for(let i=s;i<f;i++)p=Math.max(p,Math.abs(R1[i]));const l=p>_?Math.floor((Math.log(p)/Math.log(10)-u)*17):0;let o=Z*Math.min(l/S,1);N1[n]=(N1[n]||0)-w,o<N1[n]&&(o=N1[n]),o<0&&(o=0),N1[n]=o}c1.clearRect(0,0,I1,x1);const O=S1(c1,C1,_1,_1-Z),W=S1(c1,C1,_1,_1+Z),r1=h1?m1*2-1:m1,$=n1.spaceWidth*l1;let t1=n1.widthRatio;$!=0&&(t1=(I1-$*(r1+1))/I1);let R=0,e=0,t=0;for(let n=0;n<2;n++){const s=Math.max(1*l1,I1*t1/r1);if(R=Math.floor(s),t=s-R,e=(I1-r1*s)/(r1+1),e>0&&e<1)t1=1,e=0;else break}const r=n1.minHeight*l1,a=h1?(I1-R)/2-e:0;for(let n=0;n<2;n++){n&&(c1.save(),c1.scale(-1,1));const s=n?I1:0;for(let f=0,p=a,l=0,o,i,c,m;f<m1;f++){p+=e,o=Math.floor(p)-s,c=R,l+=t,l>=1&&(c++,l--),m=Math.max(j1[f],r);const h=o1?c/2:0;let g=new Array(4).fill(h);_1!=0&&(i=_1-m,c1.fillStyle=O,_1!=x1&&(g=[h,h,0,0]),d1(c1,o,i,c,m,g)),_1!=x1&&(c1.fillStyle=W,_1!=0&&(g=[0,0,h,h]),d1(c1,o,_1,c,m,g)),p+=c}if(n&&c1.restore(),!h1)break}};delete T1.onDraw;const p1=(c1,R1)=>{const E=document.getElementById(q1);if(!E){console.error(`canvasId：${q1}无效`);return}const n1=E.getContext("2d");L1(n1,{frequencyData:c1,sampleRate:R1,options:T1})},k1=()=>{const c1=Math.floor(1e3/T1.fps);f1||(f1=setInterval(function(){k1()},c1));const R1=Date.now();if(H=H||0,R1-Z1>(T1==null?void 0:T1.fallDuration)*1.5){clearInterval(f1),j1=[],p1(null,Q.sampleRate);return}if(R1-H<c1)return;H=R1;const E=z1.bufferSize,n1=Q.pcmData;let l1=A1;const u1=new Int16Array(E);for(let m1=0;m1<E&&l1<n1.length;m1++,l1++)u1[m1]=n1[l1];A1=l1;const M1=z1.transform(u1);p1(M1,Q.sampleRate)},v1=()=>{clearInterval(f1)};return Ot(()=>F1,()=>{T1=Object.assign(T1,F1)},{deep:!0}),{render:y1,draw:p1,stopRender:v1}};export{Xt as a,jt as u};
