import{d as e,u as a,G as t,s as l,L as s,Z as o,o as r,k as i,b as m,w as p,aG as n,aH as u,f as c,t as d,c as f,g as x,F as _,l as y,z as j,aT as g,R as h,r as v,a as w,j as k,i as b,I as V,e as C,av as R}from"./index-9f08b835.js";import{_ as z}from"./page-meta.d2ccf398.js";import{_ as $}from"./u-image.e6fb9592.js";import{_ as I}from"./z-paging.5d396652.js";import{_ as T}from"./u-popup.6c89de8e.js";import{_ as U}from"./create_record.3474bfb9.js";import{b as B}from"./create.9c487682.js";import{u as F}from"./useCopy.7659937f.js";import{C as G}from"./creation-history-item.6e6c2da3.js";import{F as H}from"./floating-menu.a8f47c3e.js";import{e as O,h as D,k as J}from"./chat.05123b79.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.f0423eb2.js";import"./u-tag.d6be710f.js";import"./u-read-more.a42203b8.js";import"./u-loading.15b95fef.js";import"./text-item.75b27895.js";import"./ua-markdown.f5ba7fba.js";import"./katex.30814119.js";import"./_commonjsHelpers.157f59fb.js";import"./mp-html.6ddc2dff.js";import"./index.c3709e84.js";import"./icon_copy.36709540.js";import"./howler.bdae6f69.js";import"./index.f8572cdb.js";import"./index.73309c03.js";const L=e({__name:"create_history",setup(e){const{copy:L}=F(),N=a(),Q=j(),S=t({id:0,type:2}),X=l({}),Z=l(!1),q=t({title:"",text:""}),A=l([]),E=s(),K=async(e,a)=>{var t;const l=(await O({other_id:S.id,type:S.type,page_no:e,page_size:a})).lists.map((e=>{let a="";if(g(e.ask)){const t=(null==e?void 0:e.ask[0])||{};a=`${t.title}：${t.value}`}else a=e.ask;return{...e,title:a}}));null==(t=E.value)||t.complete(l)},M=async()=>{var e;(await h({title:"温馨提示",content:"删除的记录无法恢复，确定？"})).cancel||(await D({type:S.type,other_id:S.id}),null==(e=E.value)||e.reload())},P=async e=>{var a;try{(await h({title:"温馨提示",content:"删除的记录无法恢复，确定？"})).confirm&&await J({id:e}),null==(a=E.value)||a.refresh()}catch(t){}};return o((async e=>{var a;S.id=Number(null==e?void 0:e.id),await(async()=>{const e=await B({id:S.id});X.value=e})(),null==(a=E.value)||a.reload(!0)})),(e,a)=>{const t=v(w("page-meta"),z),l=v(w("u-image"),$),s=k,o=b,j=v(w("z-paging"),I),g=V,h=v(w("u-popup"),T);return r(),i(_,null,[m(t,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),m(j,{ref_key:"pagingRef",ref:E,auto:!1,modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),"auto-show-back-to-top":"",onQuery:K},{top:p((()=>[n(m(s,{class:"flex items-center p-[20rpx]"},{default:p((()=>[m(l,{src:X.value.image,width:"42",height:"42"},null,8,["src"]),m(s,{class:"flex-1 min-w-0 text-xl font-medium line-clamp-1 mx-[20rpx]"},{default:p((()=>[c(d(X.value.name),1)])),_:1}),A.value.length?(r(),f(s,{key:0,class:"text-sm",onClick:M},{default:p((()=>[c(" 清空记录 ")])),_:1})):x("v-if",!0)])),_:1},512),[[u,X.value.name]])])),empty:p((()=>[m(s,{class:"flex flex-col justify-center items-center pb-[300rpx]"},{default:p((()=>[m(o,{class:"w-[300rpx] h-[300rpx]",src:U,alt:""}),m(s,{class:"my-[32rpx] text-muted"},{default:p((()=>[c(" 暂无数据～ ")])),_:1})])),_:1})])),default:p((()=>[m(s,{class:"px-[20rpx]"},{default:p((()=>[(r(!0),i(_,null,y(A.value,(e=>(r(),f(s,{key:e.id},{default:p((()=>[(r(!0),i(_,null,y(e.reply,((a,t)=>(r(),f(s,{class:"mt-[20rpx]",key:t},{default:p((()=>[m(G,{title:e.title,time:e.create_time,content:a,index:t,overflow:!0,"record-id":e.id,"show-rewrite":e.extra,showVoice:C(N).getIsVoiceOpen,"model-name":e.model,onDelete:P,onCopy:C(L),onClickTitle:a=>((e,a)=>{q.text=e,q.title=a,Z.value=!0})(a,e.title),onRewrite:a=>(async e=>{await Q.navigateBack(),R("createRewrite",e.extra)})(e)},null,8,["title","time","content","index","record-id","show-rewrite","showVoice","model-name","onCopy","onClickTitle","onRewrite"])])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue"]),m(h,{modelValue:Z.value,"onUpdate:modelValue":a[1]||(a[1]=e=>Z.value=e),mode:"bottom","border-radius":"14",closeable:""},{default:p((()=>[m(s,{class:"h-[85vh] flex flex-col"},{default:p((()=>[m(s,{class:"p-[30rpx] pr-[60rpx] text-xl font-medium border-0 border-b border-light border-solid"},{default:p((()=>[m(s,{class:"line-clamp-1"},{default:p((()=>[c(" 标题详情 ")])),_:1})])),_:1}),m(s,{class:"flex-1 min-h-0"},{default:p((()=>[m(g,{class:"h-full","scroll-y":""},{default:p((()=>[m(s,{class:"p-[30rpx]"},{default:p((()=>[m(s,{class:"flex-1 min-w-0 text-lg whitespace-pre-wrap"},{default:p((()=>[c(d(q.title),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),x("    悬浮菜单    "),m(H)],64)}}});export{L as default};
