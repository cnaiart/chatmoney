import{L as e,s as l,aZ as a,bc as u}from"./index-9f08b835.js";import{h as o}from"./howler.bdae6f69.js";const v=new Set,r=r=>{const{onstart:n,onstop:s,onerror:t}=r||{},i=e(null),p=l(!1),c=l(0),d=l(0),y=l(0),m=()=>{null==n||n(),k(),p.value=!0},w=()=>{null==s||s(),p.value=!1,clearTimeout(y.value)},T=e=>{console.error(e),null==t||t(),p.value=!1,clearTimeout(y.value)},k=()=>{d.value=i.value.seek(),clearTimeout(y.value),y.value=setTimeout((()=>{k()}),100)},f=e=>{i.value=new o.Howl({src:e,autoplay:!1,preload:!1}),i.value.isPlaying=p,i.value.on("play",m),i.value.on("end",w),i.value.on("loaderror",T),i.value.on("playerror",T),i.value.on("stop",w),i.value.on("pause",w)},g=e=>{var l;null==(l=i.value)||l.unload(),f(e),i.value.src=e},h=()=>{var e;null==(e=i.value)||e.stop()},x=()=>{v.forEach((e=>{e.paused||e.pause()}))};return a((()=>{var e,l;p.value&&h(),i.value&&(null==(l=(e=i.value).destroy)||l.call(e),v.delete(i.value),i.value=null,clearTimeout(y.value))})),{pause:h,pauseAll:x,play:async e=>{x(),e&&(f(e),g(e)),await(async()=>{i.value.off("load"),i.value.load(),i.value.once("load",(()=>{c.value=i.value.duration(),u()?window.WeixinJSBridge.invoke("getNetworkType",{},(()=>{i.value.play()}),!1):i.value.play()}))})()},duration:c,currentTime:d,isPlaying:p,setUrl:g,suspend:()=>{var e;null==(e=i.value)||e.pause()},seek:e=>{var l;null==(l=i.value)||l.seek(e),d.value=i.value.seek()}}};export{r as u};
