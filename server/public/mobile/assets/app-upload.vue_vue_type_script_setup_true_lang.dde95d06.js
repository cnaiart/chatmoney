var e,t,i,o,a,s,n,l,r,u;import{o as c,c as d,w as p,n as h,m as f,f as m,t as v,g as y,i as g,h as b,j as w,ah as _,k,F as S,l as x,b1 as $,K as C,r as I,a as z,p as T,aB as B,b as P,aD as A,b2 as D,b3 as O,at as N,au as R,b4 as j,d as F,s as U,M as L,x as E,aT as M,b5 as V,aP as H,e as X,aJ as Y}from"./index-9f08b835.js";import{m as q,a as W,i as G,v as Z,b as K,f as J,p as Q}from"./mixin.c6ddb3c1.js";import{_ as ee}from"./_plugin-vue_export-helper.1b428a4d.js";import{i as te}from"./isString.bf535bd9.js";const ie={"uvicon-level":"e68f","uvicon-checkbox-mark":"e659","uvicon-folder":"e694","uvicon-movie":"e67c","uvicon-star-fill":"e61e","uvicon-star":"e618","uvicon-phone-fill":"e6ac","uvicon-phone":"e6ba","uvicon-apple-fill":"e635","uvicon-backspace":"e64d","uvicon-attach":"e640","uvicon-empty-data":"e671","uvicon-empty-address":"e68a","uvicon-empty-favor":"e662","uvicon-empty-car":"e657","uvicon-empty-order":"e66b","uvicon-empty-list":"e672","uvicon-empty-search":"e677","uvicon-empty-permission":"e67d","uvicon-empty-news":"e67e","uvicon-empty-history":"e685","uvicon-empty-coupon":"e69b","uvicon-empty-page":"e60e","uvicon-empty-wifi-off":"e6cc","uvicon-reload":"e627","uvicon-order":"e695","uvicon-server-man":"e601","uvicon-search":"e632","uvicon-more-dot-fill":"e66f","uvicon-scan":"e631","uvicon-map":"e665","uvicon-map-fill":"e6a8","uvicon-tags":"e621","uvicon-tags-fill":"e613","uvicon-eye":"e664","uvicon-eye-fill":"e697","uvicon-eye-off":"e69c","uvicon-eye-off-outline":"e688","uvicon-mic":"e66d","uvicon-mic-off":"e691","uvicon-calendar":"e65c","uvicon-trash":"e623","uvicon-trash-fill":"e6ce","uvicon-play-left":"e6bf","uvicon-play-right":"e6b3","uvicon-minus":"e614","uvicon-plus":"e625","uvicon-info-circle":"e69f","uvicon-info-circle-fill":"e6a7","uvicon-question-circle":"e622","uvicon-question-circle-fill":"e6bc","uvicon-close":"e65a","uvicon-checkmark":"e64a","uvicon-checkmark-circle":"e643","uvicon-checkmark-circle-fill":"e668","uvicon-setting":"e602","uvicon-setting-fill":"e6d0","uvicon-heart":"e6a2","uvicon-heart-fill":"e68b","uvicon-camera":"e642","uvicon-camera-fill":"e650","uvicon-more-circle":"e69e","uvicon-more-circle-fill":"e684","uvicon-chat":"e656","uvicon-chat-fill":"e63f","uvicon-bag":"e647","uvicon-error-circle":"e66e","uvicon-error-circle-fill":"e655","uvicon-close-circle":"e64e","uvicon-close-circle-fill":"e666","uvicon-share":"e629","uvicon-share-fill":"e6bb","uvicon-share-square":"e6c4","uvicon-shopping-cart":"e6cb","uvicon-shopping-cart-fill":"e630","uvicon-bell":"e651","uvicon-bell-fill":"e604","uvicon-list":"e690","uvicon-list-dot":"e6a9","uvicon-zhifubao-circle-fill":"e617","uvicon-weixin-circle-fill":"e6cd","uvicon-weixin-fill":"e620","uvicon-qq-fill":"e608","uvicon-qq-circle-fill":"e6b9","uvicon-moments-circel-fill":"e6c2","uvicon-moments":"e6a0","uvicon-car":"e64f","uvicon-car-fill":"e648","uvicon-warning-fill":"e6c7","uvicon-warning":"e6c1","uvicon-clock-fill":"e64b","uvicon-clock":"e66c","uvicon-edit-pen":"e65d","uvicon-edit-pen-fill":"e679","uvicon-email":"e673","uvicon-email-fill":"e683","uvicon-minus-circle":"e6a5","uvicon-plus-circle":"e603","uvicon-plus-circle-fill":"e611","uvicon-file-text":"e687","uvicon-file-text-fill":"e67f","uvicon-pushpin":"e6d1","uvicon-pushpin-fill":"e6b6","uvicon-grid":"e68c","uvicon-grid-fill":"e698","uvicon-play-circle":"e6af","uvicon-play-circle-fill":"e62a","uvicon-pause-circle-fill":"e60c","uvicon-pause":"e61c","uvicon-pause-circle":"e696","uvicon-gift-fill":"e6b0","uvicon-gift":"e680","uvicon-kefu-ermai":"e660","uvicon-server-fill":"e610","uvicon-coupon-fill":"e64c","uvicon-coupon":"e65f","uvicon-integral":"e693","uvicon-integral-fill":"e6b1","uvicon-home-fill":"e68e","uvicon-home":"e67b","uvicon-account":"e63a","uvicon-account-fill":"e653","uvicon-thumb-down-fill":"e628","uvicon-thumb-down":"e60a","uvicon-thumb-up":"e612","uvicon-thumb-up-fill":"e62c","uvicon-lock-fill":"e6a6","uvicon-lock-open":"e68d","uvicon-lock-opened-fill":"e6a1","uvicon-lock":"e69d","uvicon-red-packet":"e6c3","uvicon-photo-fill":"e6b4","uvicon-photo":"e60d","uvicon-volume-off-fill":"e6c8","uvicon-volume-off":"e6bd","uvicon-volume-fill":"e624","uvicon-volume":"e605","uvicon-download":"e670","uvicon-arrow-up-fill":"e636","uvicon-arrow-down-fill":"e638","uvicon-play-left-fill":"e6ae","uvicon-play-right-fill":"e6ad","uvicon-arrow-downward":"e634","uvicon-arrow-leftward":"e63b","uvicon-arrow-rightward":"e644","uvicon-arrow-upward":"e641","uvicon-arrow-down":"e63e","uvicon-arrow-right":"e63c","uvicon-arrow-left":"e646","uvicon-arrow-up":"e633","uvicon-skip-back-left":"e6c5","uvicon-skip-forward-right":"e61f","uvicon-arrow-left-double":"e637","uvicon-man":"e675","uvicon-woman":"e626","uvicon-en":"e6b8","uvicon-twitte":"e607","uvicon-twitter-circle-fill":"e6cf"};const oe=ee({name:"uv-icon",emits:["click"],mixins:[q,W,{props:{name:{type:String,default:""},color:{type:String,default:"#606266"},size:{type:[String,Number],default:"16px"},bold:{type:Boolean,default:!1},index:{type:[String,Number],default:null},hoverClass:{type:String,default:""},customPrefix:{type:String,default:"uvicon"},label:{type:[String,Number],default:""},labelPos:{type:String,default:"right"},labelSize:{type:[String,Number],default:"15px"},labelColor:{type:String,default:"#606266"},space:{type:[String,Number],default:"3px"},imgMode:{type:String,default:"aspectFit"},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},top:{type:[String,Number],default:0},stop:{type:Boolean,default:!1},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.icon}}],data:()=>({colorType:["primary","success","info","error","warning"]}),computed:{uClasses(){let e=[];return e.push(this.customPrefix),e.push(this.customPrefix+"-"+this.name),this.color&&this.colorType.includes(this.color)&&e.push("uv-icon__icon--"+this.color),e},iconStyle(){let e={};return e={fontSize:this.$uv.addUnit(this.size),lineHeight:this.$uv.addUnit(this.size),fontWeight:this.bold?"bold":"normal",top:this.$uv.addUnit(this.top)},this.color&&!this.colorType.includes(this.color)&&(e.color=this.color),e},isImg(){const e=this.name.indexOf("data:")>-1&&this.name.indexOf("base64")>-1;return-1!==this.name.indexOf("/")||e},imgStyle(){let e={};return e.width=this.width?this.$uv.addUnit(this.width):this.$uv.addUnit(this.size),e.height=this.height?this.$uv.addUnit(this.height):this.$uv.addUnit(this.size),e},icon(){const e=ie["uvicon-"+this.name];return e?unescape(`%u${e}`):["uvicon"].indexOf(this.customPrefix)>-1?this.name:""}},methods:{clickHandler(e){this.$emit("click",this.index),this.stop&&this.preventEvent(e)}}},[["render",function(e,t,i,o,a,s){const n=g,l=b,r=w;return c(),d(r,{class:f(["uv-icon",["uv-icon--"+e.labelPos]]),onClick:s.clickHandler},{default:p((()=>[s.isImg?(c(),d(n,{key:0,class:"uv-icon__img",src:e.name,mode:e.imgMode,style:h([s.imgStyle,e.$uv.addStyle(e.customStyle)])},null,8,["src","mode","style"])):(c(),d(l,{key:1,class:f(["uv-icon__icon",s.uClasses]),style:h([s.iconStyle,e.$uv.addStyle(e.customStyle)]),"hover-class":e.hoverClass},{default:p((()=>[m(v(s.icon),1)])),_:1},8,["class","style","hover-class"])),y(' 这里进行空字符串判断，如果仅仅是v-if="label"，可能会出现传递0的时候，结果也无法显示 '),""!==e.label?(c(),d(l,{key:2,class:"uv-icon__label",style:h({color:e.labelColor,fontSize:e.$uv.addUnit(e.labelSize),marginLeft:"right"==e.labelPos?e.$uv.addUnit(e.space):0,marginTop:"bottom"==e.labelPos?e.$uv.addUnit(e.space):0,marginRight:"left"==e.labelPos?e.$uv.addUnit(e.space):0,marginBottom:"top"==e.labelPos?e.$uv.addUnit(e.space):0})},{default:p((()=>[m(v(e.label),1)])),_:1},8,["style"])):y("v-if",!0)])),_:1},8,["onClick","class"])}],["__scopeId","data-v-2421641b"]]);function ae(e,t=!0){if((e=String(e).toLowerCase())&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e)){if(4===e.length){let t="#";for(let i=1;i<4;i+=1)t+=e.slice(i,i+1).concat(e.slice(i,i+1));e=t}const i=[];for(let t=1;t<7;t+=2)i.push(parseInt(`0x${e.slice(t,t+2)}`));return t?`rgb(${i[0]},${i[1]},${i[2]})`:i}if(/^(rgb|RGB)/.test(e)){return e.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",").map((e=>Number(e)))}return e}function se(e){const t=e;if(/^(rgb|RGB)/.test(t)){const e=t.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",");let i="#";for(let t=0;t<e.length;t++){let o=Number(e[t]).toString(16);o=1==String(o).length?`0${o}`:o,"0"===o&&(o+=o),i+=o}return 7!==i.length&&(i=t),i}if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t))return t;{const e=t.replace(/#/,"").split("");if(6===e.length)return t;if(3===e.length){let t="#";for(let i=0;i<e.length;i+=1)t+=e[i]+e[i];return t}}}const ne=ee({name:"uv-loading-icon",mixins:[q,W,{props:{show:{type:Boolean,default:!0},color:{type:String,default:"#909193"},textColor:{type:String,default:"#909193"},vertical:{type:Boolean,default:!1},mode:{type:String,default:"spinner"},size:{type:[String,Number],default:24},textSize:{type:[String,Number],default:15},textStyle:{type:Object,default:()=>({})},text:{type:[String,Number],default:""},timingFunction:{type:String,default:"linear"},duration:{type:[String,Number],default:1200},inactiveColor:{type:String,default:""},...null==(o=null==(i=uni.$uv)?void 0:i.props)?void 0:o.loadingIcon}}],data:()=>({array12:Array.from({length:12}),aniAngel:360,webviewHide:!1,loading:!1}),computed:{otherBorderColor(){const e=function(e="rgb(0, 0, 0)",t="rgb(255, 255, 255)",i=10){const o=ae(e,!1),a=o[0],s=o[1],n=o[2],l=ae(t,!1),r=(l[0]-a)/i,u=(l[1]-s)/i,c=(l[2]-n)/i,d=[];for(let p=0;p<i;p++){let o=se(`rgb(${Math.round(r*p+a)},${Math.round(u*p+s)},${Math.round(c*p+n)})`);0===p&&(o=se(e)),p===i-1&&(o=se(t)),d.push(o)}return d}(this.color,"#ffffff",100)[80];return"circle"===this.mode?this.inactiveColor?this.inactiveColor:e:"transparent"}},watch:{show(e){}},mounted(){this.init()},methods:{init(){setTimeout((()=>{}),20)},addEventListenerToWebview(){const e=_(),t=e[e.length-1].$getAppWebview();t.addEventListener("hide",(()=>{this.webviewHide=!0})),t.addEventListener("show",(()=>{this.webviewHide=!1}))}}},[["render",function(e,t,i,o,a,s){const n=w,l=b;return e.show?(c(),d(n,{key:0,class:f(["uv-loading-icon",[e.vertical&&"uv-loading-icon--vertical"]]),style:h([e.$uv.addStyle(e.customStyle)])},{default:p((()=>[a.webviewHide?y("v-if",!0):(c(),d(n,{key:0,class:f(["uv-loading-icon__spinner",[`uv-loading-icon__spinner--${e.mode}`]]),ref:"ani",style:h({color:e.color,width:e.$uv.addUnit(e.size),height:e.$uv.addUnit(e.size),borderTopColor:e.color,borderBottomColor:s.otherBorderColor,borderLeftColor:s.otherBorderColor,borderRightColor:s.otherBorderColor,"animation-duration":`${e.duration}ms`,"animation-timing-function":"semicircle"===e.mode||"circle"===e.mode?e.timingFunction:""})},{default:p((()=>["spinner"===e.mode?(c(!0),k(S,{key:0},x(a.array12,((e,t)=>(c(),d(n,{key:t,class:"uv-loading-icon__dot"})))),128)):y("v-if",!0)])),_:1},8,["class","style"])),e.text?(c(),d(l,{key:1,class:"uv-loading-icon__text",style:h([{fontSize:e.$uv.addUnit(e.textSize),color:e.textColor},e.$uv.addStyle(e.textStyle)])},{default:p((()=>[m(v(e.text),1)])),_:1},8,["style"])):y("v-if",!0)])),_:1},8,["style","class"])):y("v-if",!0)}],["__scopeId","data-v-da8711c2"]]);class le{constructor(e,t){this.options=e,this.animation=$({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let i=this.currentStepAnimates[this.next],o={};if(o=i||{styles:{},config:{}},re.includes(e)){o.styles.transform||(o.styles.transform="");let i="";"rotate"===e&&(i="deg"),o.styles.transform+=`${e}(${t+i}) `}else o.styles[e]=`${t}`;this.currentStepAnimates[this.next]=o}_animateRun(e={},t={}){let i=this.$.$refs.ani.ref;if(i)return new Promise(((o,a)=>{nvueAnimation.transition(i,{styles:e,...t},(e=>{o()}))}))}_nvueNextAnimate(e,t=0,i){let o=e[t];if(o){let{styles:a,config:s}=o;this._animateRun(a,s).then((()=>{t+=1,this._nvueNextAnimate(e,t,i)}))}else this.currentStepAnimates={},"function"==typeof i&&i(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const re=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function ue(e,t){if(t)return clearTimeout(t.timer),new le(e,t)}re.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{le.prototype[e]=function(...t){return this.animation[e](...t),this}}));const ce=ee({name:"uv-transition",mixins:[q,W],emits:["click","change"],props:{show:{type:Boolean,default:!1},mode:{type:[Array,String,null],default:()=>"fade"},duration:{type:[String,Number],default:300},timingFunction:{type:String,default:"ease-out"},customClass:{type:String,default:""},cellChild:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{transformStyles(){const e={transform:this.transform,opacity:this.opacity,...this.$uv.addStyle(this.customStyle),"transition-duration":this.duration/1e3+"s"};return this.$uv.addStyle(e,"string")}},created(){this.config={duration:this.duration,timingFunction:this.timingFunction,transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=ue(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,t={}){if(this.animation){for(let t in e)try{"object"==typeof e[t]?this.animation[t](...e[t]):this.animation[t](e[t])}catch(i){console.error(`方法 ${t} 不存在`)}return this.animation.step(t),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=ue(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.opacity=1,this.$emit("change",{detail:this.isShow}),this.transform=""}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},i=(e,i)=>{"fade"===i?t.opacity=this.animationType(e)[i]:t.transform+=this.animationType(e)[i]+" "};return"string"==typeof this.mode?i(e,this.mode):this.mode.forEach((t=>{i(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let i=null;"fade"===t?i=e?0:1:(i=e?"-100%":"0","zoom-in"===t&&(i=e?.8:1),"zoom-out"===t&&(i=e?1.2:1),"slide-right"===t&&(i=e?"100%":"0"),"slide-bottom"===t&&(i=e?"100%":"0")),this.animation[this.animationMode()[t]](i)};return"string"==typeof this.mode?t(e,this.mode):this.mode.forEach((i=>{t(e,i)})),this.animation},animationType:e=>({fade:e?1:0,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(e,t,i,o,a,s){const n=w;return a.isShow?(c(),d(n,{key:0,ref:"ani",animation:a.animationData,class:f(i.customClass),style:h(s.transformStyles),onClick:s.onClick},{default:p((()=>[C(e.$slots,"default")])),_:3},8,["animation","class","style","onClick"])):y("v-if",!0)}]]);const de=ee({name:"uv-overlay",emits:["click"],mixins:[q,W,{props:{show:{type:Boolean,default:!1},zIndex:{type:[String,Number],default:10070},duration:{type:[String,Number],default:300},opacity:{type:[String,Number],default:.5},...null==(s=null==(a=uni.$uv)?void 0:a.props)?void 0:s.overlay}}],watch:{show(e){document.querySelector("body").style.overflow=e?"hidden":""}},computed:{overlayStyle(){const e={position:"fixed",top:0,left:0,right:0,zIndex:this.zIndex,bottom:0,"background-color":`rgba(0, 0, 0, ${this.opacity})`};return this.$uv.deepMerge(e,this.$uv.addStyle(this.customStyle))}},methods:{clickHandler(){this.$emit("click")},clear(){}}},[["render",function(e,t,i,o,a,s){const n=I(z("uv-transition"),ce);return c(),d(n,{show:e.show,mode:"fade","custom-class":"uv-overlay",duration:e.duration,"custom-style":s.overlayStyle,onClick:s.clickHandler,onTouchmove:T(s.clear,["stop","prevent"])},{default:p((()=>[C(e.$slots,"default",{},void 0,!0)])),_:3},8,["show","duration","custom-style","onClick","onTouchmove"])}],["__scopeId","data-v-15cc9084"]]);const pe=ee({name:"uv-status-bar",mixins:[q,W,{props:{bgColor:{type:String,default:"transparent"}}}],data:()=>({}),computed:{style(){const e={};return e.height=this.$uv.addUnit(this.$uv.sys().statusBarHeight,"px"),this.bgColor&&(this.bgColor.indexOf("gradient")>-1?e.backgroundImage=this.bgColor:e.background=this.bgColor),this.$uv.deepMerge(e,this.$uv.addStyle(this.customStyle))}}},[["render",function(e,t,i,o,a,s){const n=w;return c(),d(n,{style:h([s.style]),class:"uv-status-bar"},{default:p((()=>[C(e.$slots,"default",{},void 0,!0)])),_:3},8,["style"])}],["__scopeId","data-v-1f55ed6c"]]);const he=ee({name:"uv-safe-bottom",mixins:[q,W],data:()=>({safeAreaBottomHeight:0,isNvue:!1}),computed:{style(){return this.$uv.deepMerge({},this.$uv.addStyle(this.customStyle))}},mounted(){}},[["render",function(e,t,i,o,a,s){const n=w;return c(),d(n,{class:f(["uv-safe-bottom",[!a.isNvue&&"uv-safe-area-inset-bottom"]]),style:h([s.style])},null,8,["style","class"])}],["__scopeId","data-v-f58b4803"]]);const fe=ee({name:"uv-popup",components:{keypress:{name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted(){const e={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(t=>{if(this.disable)return;const i=Object.keys(e).find((i=>{const o=t.key,a=e[i];return a===o||Array.isArray(a)&&a.includes(o)}));i&&setTimeout((()=>{this.$emit(i,{})}),0)}))},render:()=>{}}},mixins:[q,W],emits:["change","maskClick"],props:{mode:{type:String,default:"center"},duration:{type:[String,Number],default:300},zIndex:{type:[String,Number],default:997},bgColor:{type:String,default:"#ffffff"},safeArea:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0},overlayOpacity:{type:[Number,String],default:.4},overlayStyle:{type:[Object,String],default:""},safeAreaInsetBottom:{type:Boolean,default:!0},safeAreaInsetTop:{type:Boolean,default:!1},closeable:{type:Boolean,default:!1},closeIconPos:{type:String,default:"top-right"},zoom:{type:Boolean,default:!0},round:{type:[Number,String],default:0},...null==(l=null==(n=uni.$uv)?void 0:n.props)?void 0:l.popup},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.mode]](!0)},immediate:!0},showPopup(e){document.getElementsByTagName("body")[0].style.overflow=e?"hidden":"visible"}},data(){return{ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},transitionStyle:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupClass:this.isDesktop?"fixforpc-top":"top",direction:""}},computed:{isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.bgColor||"none"===this.bgColor||this.$uv.getPx(this.round)>0?"transparent":this.bgColor},contentStyle(){const e={};if(this.bgColor&&(e.backgroundColor=this.bg),this.round){const t=this.$uv.addUnit(this.round),i=this.direction?this.direction:this.mode;e.backgroundColor=this.bgColor,"top"===i?(e.borderBottomLeftRadius=t,e.borderBottomRightRadius=t):"bottom"===i?(e.borderTopLeftRadius=t,e.borderTopRightRadius=t):"center"===i&&(e.borderRadius=t)}return this.$uv.deepMerge(e,this.$uv.addStyle(this.customStyle))}},unmounted(){this.setH5Visible()},created(){this.messageChild=null,this.clearPropagation=!1},methods:{setH5Visible(){document.getElementsByTagName("body")[0].style.overflow="visible"},closeMask(){this.maskShow=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;if(e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)?this.direction=e:e=this.mode,!this.config[e])return this.$uv.error(`缺少类型：${e}`);this[this.config[e]](),this.$emit("change",{show:!0,type:e})},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.mode}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.closeOnClickOverlay&&this.close())},top(e){this.popupClass=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transitionStyle={position:"fixed",zIndex:this.zIndex,left:0,right:0,backgroundColor:this.bg},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.mode&&this.messageChild.timerClose()})))},bottom(e){this.popupClass="bottom",this.ani=["slide-bottom"],this.transitionStyle={position:"fixed",zIndex:this.zIndex,left:0,right:0,bottom:0,backgroundColor:this.bg},e||(this.showPopup=!0,this.showTrans=!0)},center(e){this.popupClass="center",this.ani=this.zoom?["zoom-in","fade"]:["fade"],this.transitionStyle={position:"fixed",zIndex:this.zIndex,display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},e||(this.showPopup=!0,this.showTrans=!0)},left(e){this.popupClass="left",this.ani=["slide-left"],this.transitionStyle={position:"fixed",zIndex:this.zIndex,left:0,bottom:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)},right(e){this.popupClass="right",this.ani=["slide-right"],this.transitionStyle={position:"fixed",zIndex:this.zIndex,bottom:0,right:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},e||(this.showPopup=!0,this.showTrans=!0)}}},[["render",function(e,t,i,o,a,s){const n=I(z("uv-overlay"),de),l=I(z("uv-status-bar"),pe),r=I(z("uv-safe-bottom"),he),u=I(z("uv-icon"),oe),m=w,v=I(z("uv-transition"),ce),g=B("keypress");return a.showPopup?(c(),d(m,{key:0,class:f(["uv-popup",[a.popupClass,s.isDesktop?"fixforpc-z-index":""]]),style:h([{zIndex:i.zIndex}])},{default:p((()=>[P(m,{onTouchstart:s.touchstart},{default:p((()=>[y(" 遮罩层 "),a.maskShow&&i.overlay?(c(),d(n,{key:"1",show:a.showTrans,duration:i.duration,"custom-style":i.overlayStyle,opacity:i.overlayOpacity,zIndex:i.zIndex,onClick:s.onTap},null,8,["show","duration","custom-style","opacity","zIndex","onClick"])):y("v-if",!0),P(v,{key:"2",mode:a.ani,name:"content","custom-style":a.transitionStyle,duration:i.duration,show:a.showTrans,onClick:s.onTap},{default:p((()=>[P(m,{class:f(["uv-popup__content",[a.popupClass]]),style:h([s.contentStyle]),onClick:s.clear},{default:p((()=>[i.safeAreaInsetTop?(c(),d(l,{key:0})):y("v-if",!0),C(e.$slots,"default",{},void 0,!0),i.safeAreaInsetBottom?(c(),d(r,{key:1})):y("v-if",!0),i.closeable?(c(),d(m,{key:2,onClick:T(s.close,["stop"]),class:f(["uv-popup__content__close",["uv-popup__content__close--"+i.closeIconPos]]),"hover-class":"uv-popup__content__close--hover","hover-stay-time":"150"},{default:p((()=>[P(u,{name:"close",color:"#909399",size:"18",bold:""})])),_:1},8,["onClick","class"])):y("v-if",!0)])),_:3},8,["style","class","onClick"])])),_:3},8,["mode","custom-style","duration","show","onClick"])])),_:3},8,["onTouchstart"]),a.maskShow?(c(),d(g,{key:0,onEsc:s.onTap},null,8,["onEsc"])):y("v-if",!0)])),_:3},8,["class","style"])):y("v-if",!0)}],["__scopeId","data-v-1350f58f"]]);const me=ee({props:{src:{type:String,default:""},autoplay:{type:Boolean,default:!0}},data:()=>({videoSrc:"",show:!1}),computed:{getSec(){return this.src||this.videoSrc}},methods:{open(e){this.videoSrc=e,this.$refs.popup.open()},close(){this.$refs.popup.close()},change(e){this.show=e.show}}},[["render",function(e,t,i,o,a,s){const n=A,l=w,r=I(z("uv-popup"),fe);return c(),d(r,{ref:"popup",onChange:s.change},{default:p((()=>[a.show?(c(),d(l,{key:0,class:"video-view"},{default:p((()=>[P(n,{class:"video",src:s.getSec,autoplay:i.autoplay},null,8,["src","autoplay"])])),_:1})):y("v-if",!0)])),_:1},8,["onChange"])}],["__scopeId","data-v-0ff84edc"]]);function ve(e,t){return["[object Object]","[object File]"].includes(Object.prototype.toString.call(e))?Object.keys(e).reduce(((i,o)=>(t.includes(o)||(i[o]=e[o]),i)),{}):{}}function ye(e){return e.tempFiles.map((e=>({...ve(e,["path"]),url:e.path,size:e.size,name:e.name,type:e.type})))}function ge({accept:e,multiple:t,capture:i,compressed:o,maxDuration:a,sizeType:s,camera:n,maxCount:l}){return new Promise(((r,u)=>{switch(e){case"image":N({count:t?Math.min(l,9):1,sourceType:i,sizeType:s,success:e=>r(function(e){return e.tempFiles.map((e=>{const t={...ve(e,["path"]),type:"image",url:e.path,thumb:e.path,size:e.size,name:e.name};return t.name||(t.name=e.path.substring(e.path.lastIndexOf("/")+1)),t}))}(e)),fail:u});break;case"video":O({sourceType:i,compressed:o,maxDuration:a,camera:n,success:e=>r(function(e){return[{...ve(e,["tempFilePath","thumbTempFilePath","errMsg"]),type:"video",url:e.tempFilePath,thumb:e.thumbTempFilePath,size:e.size,name:e.name||e.path.substring(e.path.lastIndexOf("/")+1)}]}(e)),fail:u});break;case"file":D({count:t?l:1,type:e,success:e=>r(ye(e)),fail:u});break;default:D({count:t?l:1,type:"all",success:e=>r(ye(e)),fail:u})}}))}const be=ee({name:"uv-upload",emits:["error","beforeRead","oversize","afterRead","delete","clickPreview"],mixins:[q,W,{watch:{accept:{immediate:!0,handler(e){}}}},{props:{accept:{type:String,default:"image"},capture:{type:[String,Array],default:()=>["album","camera"]},compressed:{type:Boolean,default:!0},camera:{type:String,default:"back"},maxDuration:{type:Number,default:60},uploadIcon:{type:String,default:"camera-fill"},uploadIconColor:{type:String,default:"#D3D4D6"},useBeforeRead:{type:Boolean,default:!1},afterRead:{type:Function,default:null},beforeRead:{type:Function,default:null},previewFullImage:{type:Boolean,default:!0},previewFullVideo:{type:Boolean,default:!0},maxCount:{type:[String,Number],default:52},disabled:{type:Boolean,default:!1},imageMode:{type:String,default:"aspectFill"},name:{type:String,default:""},sizeType:{type:Array,default:()=>["original","compressed"]},multiple:{type:Boolean,default:!1},deletable:{type:Boolean,default:!0},maxSize:{type:[String,Number],default:Number.MAX_VALUE},fileList:{type:Array,default:()=>[]},uploadText:{type:String,default:""},width:{type:[String,Number],default:80},height:{type:[String,Number],default:80},previewImage:{type:Boolean,default:!0},...null==(u=null==(r=uni.$uv)?void 0:r.props)?void 0:u.upload}}],data:()=>({lists:[],isInCount:!0}),watch:{fileList:{deep:!0,immediate:!0,handler(){this.formatFileList()}},deletable(e){e||this.lists.map((e=>{e.deletable=this.deletable}))}},methods:{formatFileList(){const{fileList:e=[],maxCount:t}=this,i=e.map((e=>Object.assign(Object.assign({},e),{isImage:"image"===this.accept||G(e.url||e.thumb),isVideo:"video"===this.accept||Z(e.url||e.thumb),deletable:"boolean"==typeof e.deletable?e.deletable:this.deletable})));this.lists=i,this.isInCount=i.length<t},chooseFile(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((()=>{const{maxCount:e,multiple:t,lists:i,disabled:o}=this;if(o)return;let a;try{a=K(this.capture)?this.capture:this.capture.split(",")}catch(s){a=[]}ge(Object.assign({accept:this.accept,multiple:this.multiple,capture:a,compressed:this.compressed,maxDuration:this.maxDuration,sizeType:this.sizeType,camera:this.camera},{maxCount:e-i.length})).then((e=>{this.onBeforeRead(t?e:e[0])})).catch((e=>{this.$emit("error",e)}))}),100)},onBeforeRead(e){const{beforeRead:t,useBeforeRead:i}=this;let o=!0;J(t)&&(o=t(e,this.getDetail())),i&&(o=new Promise(((t,i)=>{this.$emit("beforeRead",Object.assign(Object.assign({file:e},this.getDetail()),{callback:e=>{e?t():i()}}))}))),o&&(Q(o)?o.then((t=>this.onAfterRead(t||e))):this.onAfterRead(e))},getDetail(e){return{name:this.name,index:null==e?this.fileList.length:e}},onAfterRead(e){const{maxSize:t,afterRead:i}=this;(Array.isArray(e)?e.some((e=>e.size>t)):e.size>t)?this.$emit("oversize",Object.assign({file:e},this.getDetail())):("function"==typeof i&&i(e,this.getDetail()),this.$emit("afterRead",Object.assign({file:e},this.getDetail())))},deleteItem(e){this.$emit("delete",Object.assign(Object.assign({},this.getDetail(e)),{file:this.fileList[e]}))},onPreviewImage(e,t){const i=this.$uv.deepClone(this.lists);i.map(((e,i)=>{i==t&&(e.current=!0)}));const o=i.filter((e=>e.isImage)).findIndex((e=>e.current));this.onClickPreview(e,t),e.isImage&&this.previewFullImage&&R({urls:this.lists.filter((e=>"image"===this.accept||G(e.url||e.thumb))).map((e=>e.url||e.thumb)),current:o,fail(){this.$uv.toast("预览图片失败")}})},onPreviewVideo(e,t){this.onClickPreview(e,t),this.previewFullVideo&&e.isVideo&&this.$refs.previewVideo.open(e.url)},onClickPreview(e,t){this.$emit("clickPreview",Object.assign(Object.assign({},e),this.getDetail(t)))}}},[["render",function(e,t,i,o,a,s){const n=g,l=I(z("uv-icon"),oe),r=b,u=w,_=I(z("uv-loading-icon"),ne),$=I(z("uv-preview-video"),me);return c(),d(u,{class:"uv-upload",style:h([e.$uv.addStyle(e.customStyle)])},{default:p((()=>[P(u,{class:"uv-upload__wrap"},{default:p((()=>[e.previewImage?(c(!0),k(S,{key:0},x(a.lists,((t,i)=>(c(),d(u,{class:"uv-upload__wrap__preview",key:i},{default:p((()=>[t.isImage||t.type&&"image"===t.type?(c(),d(n,{key:0,src:t.thumb||t.url,mode:e.imageMode,class:"uv-upload__wrap__preview__image",onClick:e=>s.onPreviewImage(t,i),style:h([{width:e.$uv.addUnit(e.width),height:e.$uv.addUnit(e.height)}])},null,8,["src","mode","onClick","style"])):(c(),d(u,{key:1,class:"uv-upload__wrap__preview__other",onClick:e=>s.onPreviewVideo(t,i),style:h([{width:e.$uv.addUnit(e.width),height:e.$uv.addUnit(e.height)}])},{default:p((()=>[P(l,{color:"#80CBF9",size:"26",name:t.isVideo||t.type&&"video"===t.type?"movie":"folder"},null,8,["name"]),P(r,{class:"uv-upload__wrap__preview__other__text"},{default:p((()=>[m(v(t.isVideo||t.type&&"video"===t.type?"视频":"文件"),1)])),_:2},1024)])),_:2},1032,["onClick","style"])),"uploading"===t.status||"failed"===t.status?(c(),d(u,{key:2,class:"uv-upload__status"},{default:p((()=>[P(u,{class:"uv-upload__status__icon"},{default:p((()=>["failed"===t.status?(c(),d(l,{key:0,name:"close-circle",color:"#ffffff",size:"25"})):(c(),d(_,{key:1,size:"22",mode:"circle"}))])),_:2},1024),t.message?(c(),d(r,{key:0,class:"uv-upload__status__message"},{default:p((()=>[m(v(t.message),1)])),_:2},1024)):y("v-if",!0)])),_:2},1024)):y("v-if",!0),"uploading"!==t.status&&(e.deletable||t.deletable)?(c(),d(u,{key:3,class:"uv-upload__deletable",onClick:T((e=>s.deleteItem(i)),["stop"])},{default:p((()=>[P(u,{class:"uv-upload__deletable__icon"},{default:p((()=>[P(l,{name:"close",color:"#ffffff",size:"10"})])),_:1})])),_:2},1032,["onClick"])):y("v-if",!0),"success"===t.status?(c(),d(u,{key:4,class:"uv-upload__success"},{default:p((()=>[P(u,{class:"uv-upload__success__icon"},{default:p((()=>[P(l,{name:"checkmark",color:"#ffffff",size:"12"})])),_:1})])),_:1})):y("v-if",!0)])),_:2},1024)))),128)):y("v-if",!0),a.isInCount?(c(),d(u,{key:1,onClick:s.chooseFile},{default:p((()=>[P(u,{class:f(["uv-upload__button",[e.disabled&&"uv-upload__button--disabled"]]),"hover-class":e.disabled?"":"uv-upload__button--hover","hover-stay-time":"150",onClick:T(s.chooseFile,["stop"]),style:h([{width:e.$uv.addUnit(e.width),height:e.$uv.addUnit(e.height)}])},{default:p((()=>[P(l,{name:e.uploadIcon,size:"26",color:e.uploadIconColor},null,8,["name","color"]),e.uploadText?(c(),d(r,{key:0,class:"uv-upload__button__text"},{default:p((()=>[m(v(e.uploadText),1)])),_:1})):y("v-if",!0)])),_:1},8,["hover-class","onClick","class","style"])])),_:1},8,["onClick"])):y("v-if",!0)])),_:1}),P($,{ref:"previewVideo"},null,512)])),_:1},8,["style"])}],["__scopeId","data-v-c5150532"]]),we=F({__name:"app-upload",props:{modelValue:null,accept:{default:"image"},capture:{default:()=>["album","camera"]},compressed:{type:Boolean,default:!0},camera:{default:"back"},maxDuration:{default:120},uploadIcon:{default:"camera-fill"},previewFullVideo:{type:Boolean,default:!0},previewFullImage:{type:Boolean,default:!0},maxCount:{default:1},maxUploadCount:{default:9},disabled:{type:Boolean,default:!1},imageMode:{default:"aspectFill"},width:{default:"180rpx"},height:{default:"180rpx"},header:{default:()=>({})},data:{default:()=>({})},multiple:{type:Boolean,default:!0},deletable:{type:Boolean,default:!0},returnType:{default:"string"},extname:null,previewImage:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(e,{expose:t,emit:i}){const o=e,a=U([]),s=e=>{a.value.splice(e.index,1),h()},n=L((()=>"object"==o.returnType||"string"==o.returnType?1:o.maxCount)),l=L((()=>{let e=o.extname;if(!e)switch(o.accept){case"image":e="jpg,png,gif,jpeg";break;case"video":e="wmv,avi,mpg,mpeg,3gp,mov,mp4,flv,rmvb,mkv";break;default:e="*"}return te(e)?"*"==e?[]:e.split(","):Array.isArray(e)?e:[]})),r=async({file:e})=>{let t=0,i=0;const s=((e,t=[])=>{const i=[];return t.length?(e.forEach((e=>{const o=(e=>{const t=e.lastIndexOf("."),i=e.length;return{name:e.substring(0,t),ext:e.substring(t+1,i)}})(e.name).ext.toLowerCase();-1!==t.indexOf(o)&&i.push(e)})),i.length!==e.length&&j({title:`当前选择了${e.length}个文件 ，${e.length-i.length} 个文件格式不正确，已自动剔除`,icon:"none",duration:5e3}),i):e})(e,l.value),n=s.length;s.forEach((e=>{a.value.push({...e,status:"uploading",message:"上传中"})}));const r=async()=>{const e=t++,o=s[e],l=a.value.find((e=>e.url===o.url));try{const e=await u(o.url);l.status="success",l.url=e}catch(c){l.status="failed",l.message="上传失败"}if(i++,i===n)return console.log(a.value),void h();t<n&&r()};for(let a=0;a<Math.min(n,o.maxUploadCount);a++)r()},u=async e=>{let t=o.accept;"all"==t&&(t="file");return(await Y.uploadFile({url:`/upload/${t}`,filePath:e,name:"file",header:o.header,formData:o.data})).uri},h=()=>{let e="";switch(o.returnType){case"string":{const[t]=a.value;e="success"===(null==t?void 0:t.status)?t.url:"";break}case"object":{const[t]=a.value;e="success"===(null==t?void 0:t.status)?{url:t.url,name:t.name}:{};break}case"object-array":e=a.value.filter((e=>"success"===e.status)).map((e=>({url:e.url,name:e.name})));break;case"string-array":e=a.value.filter((e=>"success"===e.status)).map((e=>e.url));break}i("update:modelValue",e)},f=e=>{if(!e.url)return;const t=a.value.some((t=>t.url==e.url));console.log(a.value),t||(e.status="success",a.value.push({...e}))};E((()=>o.modelValue),(e=>{if(te(e)){if(!e)return void(a.value=[]);a.value=[{url:e}]}else if(M(e)){if(!e.length)return void(a.value=[]);e.forEach((e=>{te(e)?f({url:e}):f(e)}))}else if(V(e)){if(!e.url)return void(a.value=[]);f(e)}}),{immediate:!0});return t({clear:()=>{a.value=[]}}),(e,t)=>{const i=I(z("uv-upload"),be);return c(),d(i,H(o,{useBeforeRead:!0,fileList:a.value,maxCount:X(n),onAfterRead:r,onDelete:s}),{default:p((()=>[C(e.$slots,"default"),m(" 111 ")])),_:3},16,["fileList","maxCount"])}}});export{we as _};
