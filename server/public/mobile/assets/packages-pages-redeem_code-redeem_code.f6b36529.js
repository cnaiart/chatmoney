import{_ as e}from"./page-meta.d2ccf398.js";import{d as a,u as l,s,M as t,o as u,k as p,b as o,w as r,e as d,c as n,F as c,f as i,t as f,g as m,r as _,a as x,j as y,a6 as v,h as g,cH as b,cI as k}from"./index-9f08b835.js";import{_ as j}from"./u-input.6dc4a2b4.js";import{_ as h}from"./u-empty.765dbffc.js";import{_ as w}from"./u-popup.6c89de8e.js";import{_ as C}from"./tabbar.vue_vue_type_script_setup_true_lang.da8cbb67.js";import{u as V}from"./useCopy.7659937f.js";import{u as F}from"./useLockFn.cde70c0d.js";import{F as L}from"./floating-menu.a8f47c3e.js";import{_ as I}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.f0423eb2.js";import"./emitter.1571a5d9.js";import"./u-badge.508fc5b2.js";const U=I(a({__name:"redeem_code",setup(a){const I=l(),U=s(""),$=s(!1),B=s({content:"",failure_time:"",id:"",sn:"",type:"",type_desc:"",valid_time:""}),H=t((()=>I.getCardCodeConfig)),{isLock:M,lockFn:Q}=F((async()=>{try{const e=await b({sn:U.value});$.value=!0,B.value=e}catch(e){U.value="",console.log("查询卡密失败=>",e)}})),{isLock:S,lockFn:q}=F((async()=>{try{await k({sn:U.value}),$.value=!1,uni.$u.toast("兑换成功"),U.value=""}catch(e){console.log("兑换卡密失败=>",e)}}));return(a,l)=>{const s=_(x("page-meta"),e),t=y,b=_(x("u-input"),j),k=v,F=_(x("u-empty"),h),I=g,z=_(x("u-popup"),w),A=_(x("tabbar"),C);return u(),p(c,null,[o(s,{"page-style":a.$theme.pageStyle},null,8,["page-style"]),o(t,{class:"redeem-code p-[24rpx]"},{default:r((()=>[d(H).is_open?(u(),n(t,{key:0,class:"px-[30rpx] py-[50rpx] bg-white rounded-[16rpx]"},{default:r((()=>[d(H).is_show?(u(),p(c,{key:0},[o(t,null,{default:r((()=>[i("购买链接")])),_:1}),o(t,{class:"flex justify-between pb-6"},{default:r((()=>[o(t,{class:"line-clamp-1 leading-[40rpx] w-[520rpx]"},{default:r((()=>[i(f(d(H).buy_site),1)])),_:1}),o(t,{class:"flex-none text-primary",onClick:l[0]||(l[0]=e=>(e=>{const{copy:a}=V();a(e)})(d(H).buy_site))},{default:r((()=>[i(" 复制 ")])),_:1})])),_:1})],64)):m("v-if",!0),o(t,{class:"py-[10rpx] px-[20rpx] bg-[#f5f5f5] rounded"},{default:r((()=>[o(b,{modelValue:U.value,"onUpdate:modelValue":l[1]||(l[1]=e=>U.value=e),placeholder:"请输入卡密编号"},null,8,["modelValue"])])),_:1}),o(t,{class:"w-full mt-[30px]"},{default:r((()=>[o(k,{class:"entry-btn",loading:d(M),onClick:d(Q)},{default:r((()=>[i(" 查询 ")])),_:1},8,["loading","onClick"])])),_:1})])),_:1})):(u(),n(t,{key:1,class:"py-[400rpx]"},{default:r((()=>[o(F,{text:"功能未开启"})])),_:1})),o(z,{modelValue:$.value,"onUpdate:modelValue":l[2]||(l[2]=e=>$.value=e),mode:"center","border-radius":"24"},{default:r((()=>[o(t,{class:"w-[690rpx] px-[24rpx]"},{default:r((()=>[o(t,{class:"p-[30rpx] text-lg text-center font-medium"},{default:r((()=>[i(" 查询结果 ")])),_:1}),o(t,{class:"min-h-[200rpx] px-[20rpx]"},{default:r((()=>[o(t,{class:"flex mt-[30rpx]"},{default:r((()=>[o(I,null,{default:r((()=>[i("卡密类型：")])),_:1}),o(I,{class:"ml-[20rpx]"},{default:r((()=>[i(f(B.value.type_desc),1)])),_:1})])),_:1}),o(t,{class:"flex mt-[30rpx]"},{default:r((()=>[o(I,null,{default:r((()=>[i("卡密面额：")])),_:1}),o(I,{class:"ml-[20rpx]"},{default:r((()=>[i(f(B.value.content),1)])),_:1})])),_:1}),o(t,{class:"flex mt-[30rpx]"},{default:r((()=>[o(I,{class:"flex-none"},{default:r((()=>[i("兑换时间：")])),_:1}),o(I,{class:"ml-[20rpx]"},{default:r((()=>[i(f(B.value.failure_time),1)])),_:1})])),_:1}),B.value.valid_time?(u(),n(t,{key:0,class:"flex mt-[30rpx]"},{default:r((()=>[o(I,{class:"flex-none"},{default:r((()=>[i("有效期至：")])),_:1}),o(I,{class:"ml-[20rpx]"},{default:r((()=>[i(f(B.value.valid_time),1)])),_:1})])),_:1})):m("v-if",!0)])),_:1}),o(t,{class:"py-[50rpx] px-[16rpx] bg-white"},{default:r((()=>[o(k,{class:"entry-btn",loading:d(S),onClick:d(q)},{default:r((()=>[i(" 立即兑换 ")])),_:1},8,["loading","onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),m("    底部导航    "),o(A),m("    悬浮菜单    "),o(L)])),_:1})],64)}}}),[["__scopeId","data-v-d415da56"]]);export{U as default};
