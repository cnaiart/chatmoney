import{J as R,K as U,Y as j,C as N,D as P,t as q,F as L}from"./element-plus.9458fb52.js";import{a as S,e as T,g as I}from"./draw_prompt_category.649d4000.js";import{P as J}from"./index.9f63869e.js";import"./index.d9c09296.js";import{d as K,s as f,r as m,_ as G,o as v,c as O,T as t,K as o,u,Q as g,J as Q,P as Y,a as C}from"./@vue.7946e41b.js";const z={class:"edit-popup"},H=C("div",{class:"form-tips"},"\u9ED8\u8BA4\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u6392\u8D8A\u524D\u9762",-1),ae=K({__name:"edit",emits:["success"],setup(M,{expose:E,emit:B}){const V=B,c=f(),i=f(),p=m(""),_=m([]),b=G({multiple:!1,checkStrictly:!0,label:"name",value:"id",children:"children",emitPath:!1}),e=m({id:"",name:"",pid:"",model:"mj_goapi",has_parent:0,sort:0,status:"",image:""}),F={name:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}],pid:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u5206\u7C7B",trigger:["blur"]}],has_parent:[{required:!0,message:"\u8BF7\u9009\u62E9\u7236\u7EA7\u5206\u7C7B",trigger:["blur"]}]},h=async()=>{var l,a;try{await((l=c.value)==null?void 0:l.validate()),e.value.id==""?await S(e.value):e.value.id!=""&&await T(e.value),(a=i.value)==null||a.close(),V("success")}catch(n){return n}},w=(l,a)=>{var n;l=="add"?(e.value={id:"",name:"",pid:0,model:"mj_goapi",has_parent:0,sort:"0",status:1},p.value="\u65B0\u589E\u5206\u7C7B"):l=="edit"&&(Object.keys(e.value).map(r=>{var d;e.value[r]=(d=a[r])!=null?d:0}),e.value.pid&&(e.value.has_parent=1),p.value="\u7F16\u8F91\u5206\u7C7B"),(n=i.value)==null||n.open(),y()},y=async()=>{try{const l=await I({model:"mj_goapi"});l.forEach(a=>{e.value.id==a.id&&(a.disabled=!0)}),_.value=l}catch(l){console.log(l)}};return E({open:w}),(l,a)=>{const n=N,r=P,d=R,D=U,A=j,k=q,x=L;return v(),O("div",z,[t(J,{ref_key:"popupRef",ref:i,title:u(p),async:!0,width:"550px",onConfirm:h},{default:o(()=>[t(x,{class:"ls-form",ref_key:"formRef",ref:c,rules:F,model:u(e),"label-width":"90px"},{default:o(()=>[t(r,{label:"\u5206\u7C7B\u540D\u79F0",prop:"name"},{default:o(()=>[t(n,{class:"ls-input",modelValue:u(e).name,"onUpdate:modelValue":a[0]||(a[0]=s=>u(e).name=s),placeholder:"\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),t(r,{label:"\u7236\u7EA7\u5206\u7C7B",prop:"has_parent"},{default:o(()=>[t(D,{modelValue:u(e).has_parent,"onUpdate:modelValue":a[1]||(a[1]=s=>u(e).has_parent=s)},{default:o(()=>[t(d,{label:0},{default:o(()=>[g("\u65E0\u7236\u7EA7\u5206\u7C7B")]),_:1}),t(d,{label:1},{default:o(()=>[g("\u6709\u7236\u7EA7\u5206\u7C7B")]),_:1})]),_:1},8,["modelValue"])]),_:1}),u(e).has_parent?(v(),Q(r,{key:0,prop:"pid"},{default:o(()=>[t(A,{class:"w-80",modelValue:u(e).pid,"onUpdate:modelValue":a[2]||(a[2]=s=>u(e).pid=s),options:u(_),props:u(b),clearable:!0,filterable:!0},null,8,["modelValue","options","props"])]),_:1})):Y("",!0),t(r,{label:"\u6392\u5E8F"},{default:o(()=>[C("div",null,[t(n,{class:"ls-input",modelValue:u(e).sort,"onUpdate:modelValue":a[3]||(a[3]=s=>u(e).sort=s)},null,8,["modelValue"]),H])]),_:1}),t(r,{label:"\u72B6\u6001"},{default:o(()=>[t(k,{modelValue:u(e).status,"onUpdate:modelValue":a[4]||(a[4]=s=>u(e).status=s),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])])}}});export{ae as _};
