import{_ as R}from"./index.vue.403e5f16.js";import{E as T}from"./el-upload.397b9616.js";import{E as $}from"./el-scrollbar.f4d658ff.js";import{i as j,f as q,v as z}from"./entry.df16adda.js";import"./el-progress.598034ee.js";import{r as C,a as U,b as J,s as K}from"./fileReader.15642605.js";import{isSameFile as M}from"./hook.d7b4f5cd.js";import{k as O,a as g,s as P,r as W,i as Y,I as c,J as l,W as Z,u as a,a2 as m,a0 as y,K as s,ae as G,a4 as r,Z as I,ap as S,Y as H,_ as X,an as ee,ao as te}from"./swiper-vue.397ea2eb.js";import{_ as se}from"./_plugin-vue_export-helper.c27b6911.js";import"./cloneDeep.8862a013.js";import"./_baseClone.000a3762.js";import"./_getTag.af7a9d71.js";import"./isEqual.b93d80e7.js";import"./___vite-browser-external.34bf2328.js";const ae=d=>(ee("data-v-7bb18fa3"),d=d(),te(),d),oe={class:"h-full flex flex-col"},ne={class:"py-[16px]"},ce={class:"el-upload__text"},le=ae(()=>s("em",null," 选择文件 ",-1)),ie={class:"el-upload__text"},re={key:0,class:"grid grid-cols-2 gap-4 flex-1 min-h-[500px]"},de={style:{"border-right":"1px solid #eeeeee"}},pe={class:"mt-4 max-w-[500px]"},_e=["onClick"],me={class:"ml-2"},ue={class:"closeIcon ml-auto opacity-0 transition duration-300 flex items-center"},he={class:"flex flex-col"},fe={class:"text-lg"},ve={class:"flex-auto mt-2 h-[100px]"},ge={class:"bg-white px-4 rounded"},xe={class:"ml-2 text-[#000]"},we={class:"mt-2"},be=O({__name:"QASplit",props:{modelValue:{}},emits:["update:modelValue"],setup(d,{emit:V}){const o=j(d,"modelValue",V),x=[".txt",".doc",".docx",".pdf",".md"].join(", "),u=g([]),w=P(),v=g(!1),p=g(-1),E=W([]),F=Y("knowDetail"),D=async({raw:e})=>{var n;try{if(e){v.value=!0,await M(e,u.value);const t=await A(e);if(!t)throw"解析结果为空，已自动忽略";const _=L(t);o.value.push({name:e.name,path:"",data:_}),console.log(o.value),u.value.push(e),b(u.value.length-1)}}catch(t){q.msgError(t)}finally{v.value=!1,(n=w.value)==null||n.clearFiles()}},A=async e=>{const n=e.name.substring(e.name.lastIndexOf(".")+1);let t="";switch(n){case"md":case"txt":t=await C(e);break;case"pdf":t=await J(e);break;case"doc":case"docx":t=await U(e);break;default:t=await C(e);break}return t},b=e=>{p.value=e,E.length=0},L=e=>{const n=[];return K(e,F.length).forEach(_=>{n.push({q:_,a:""})}),n},N=e=>{o.value.splice(e,1),u.value.splice(e,1)};return(e,n)=>{var k;const t=R,_=T,B=$,Q=z;return c(),l("div",oe,[Z((c(),l("div",ne,[m(_,{ref_key:"uploadRef",ref:w,drag:"","on-change":D,"auto-upload":!1,"show-file-list":!1,accept:a(x)},{default:y(()=>[s("div",ce,[m(t,{name:"el-icon-Upload"}),G(" 拖拽文件至此，或点击"),le]),s("div",ie,"支持 "+r(a(x))+" 文件",1)]),_:1},8,["accept"])])),[[Q,a(v)]]),a(o).length>0?(c(),l("div",re,[s("div",de,[s("div",pe,[(c(!0),l(I,null,S(a(o),(h,i)=>(c(),l("div",{key:i,class:X(["fileItem flex items-center p-2 rounded-lg mt-1 hover:cursor-pointer hover:bg-page transition duration-300",{"bg-page":a(p)==i}]),onClick:f=>b(i)},[m(t,{name:"el-icon-Folder",size:16,color:"#ffc94d"}),s("div",me,r(h.name),1),s("div",ue,[m(t,{name:"el-icon-DeleteFilled",onClick:f=>N(i)},null,8,["onClick"])])],10,_e))),128))])]),s("div",he,[s("div",fe," 分段预览（"+r((k=a(o)[a(p)])==null?void 0:k.data.length)+"组） ",1),s("div",ve,[m(B,{height:"100%"},{default:y(()=>{var h;return[(c(!0),l(I,null,S((h=a(o)[a(p)])==null?void 0:h.data,(i,f)=>(c(),l("div",{class:"bg-page rounded p-[10px] mt-2",key:f},[s("span",ge,"#"+r(f+1),1),s("span",xe,r(a(o)[a(p)].name),1),s("div",we,r(i.q),1)]))),128))]}),_:1})])])])):H("",!0)])}}});const je=se(be,[["__scopeId","data-v-7bb18fa3"]]);export{je as default};
