import{_ as L}from"./index.vue.403e5f16.js";import{i as R,j as $,f as j,E as z,v as M}from"./entry.df16adda.js";import{E as T}from"./el-upload.397b9616.js";import{E as U}from"./el-scrollbar.f4d658ff.js";import"./el-progress.598034ee.js";import{k as J,a as v,s as K,I as c,J as i,K as e,W as O,u as a,a2 as _,a0 as f,ae as W,a4 as r,a3 as X,Z as C,ap as I,Y,_ as Z,an as G,ao as H}from"./swiper-vue.397ea2eb.js";import{c as P,d as Q}from"./fileReader.15642605.js";import{isSameFile as ee}from"./hook.d7b4f5cd.js";import{_ as se}from"./_plugin-vue_export-helper.c27b6911.js";import"./cloneDeep.8862a013.js";import"./_baseClone.000a3762.js";import"./_getTag.af7a9d71.js";import"./isEqual.b93d80e7.js";import"./___vite-browser-external.34bf2328.js";const x=p=>(G("data-v-56940f2a"),p=p(),H(),p),te={class:"h-full flex flex-col"},ae={class:"py-[16px]"},oe={class:"el-upload__text"},le=x(()=>e("em",null," 选择文件 ",-1)),ne={class:"el-upload__text"},ce={class:"el-upload__text"},ie=x(()=>e("a",{href:"/static/xlsxTemplate.xlsx",target:"_blank"},"点击下载模版",-1)),re=x(()=>e("div",{class:"el-upload__tip"}," 先完成填写后再上传，问题总数建议不要超过1000条，否则上传会卡顿 ",-1)),de=x(()=>e("div",{class:"el-upload__tip"}," 导入前会进行去重，如果问题和答案完全相同，则不会被导入，所以最终导入的内容可能会比文件的内容少。但是，对于带有换行的内容，目前无法去重。 ",-1)),_e={key:0,class:"grid grid-cols-2 gap-4 flex-1 min-h-[500px]"},pe={style:{"border-right":"1px solid #eeeeee"}},ue={class:"mt-4 max-w-[500px]"},me=["onClick"],he={class:"ml-2"},ve={class:"closeIcon ml-auto opacity-0 transition duration-300 flex items-center"},fe={class:"flex flex-col"},xe={class:"text-lg"},ge={class:"flex-auto mt-2 h-[100px]"},we={class:"bg-white px-4 rounded"},ke={class:"ml-2 text-[#000]"},ye={class:"mt-2"},be=J({__name:"cvs",props:{modelValue:{}},emits:["update:modelValue"],setup(p,{expose:E,emit:F}){const o=R(p,"modelValue",F),w=[".csv",".xlsx"].join(", "),d=v([]),k=K(),g=v(!1),u=v(-1);v([{question:"什么是知识库",answer:"知识库是指一个集中存储和管理知识的系统或平..."},{question:"如何创建知识库",answer:"1.确定目标和范围：明确知识库的目标和用途，确定..."}]);const V=async({raw:s})=>{var l;try{if(s){g.value=!0,await ee(s,d.value);const t=await S(s);if(!t||!t.length)throw"解析结果为空，已自动忽略";if(!$(t))throw"解析失败";s.data=t,o.value.push({name:s.name,path:"",data:t}),d.value.push(s),console.log(d.value[0].name),y(d.value.length-1)}}catch(t){j.msgError(t)}finally{g.value=!1,(l=k.value)==null||l.clearFiles()}},S=async s=>{const l=s.name.substring(s.name.lastIndexOf(".")+1);let t="";switch(l){case"csv":t=await Q(s);break;case"xlsx":t=await P(s);break}return t},y=s=>{u.value=s},q=s=>{o.value.splice(s,1),d.value.splice(s,1)};return E({clearFiles:()=>{d.value=[]}}),(s,l)=>{var b;const t=L,B=z,N=T,A=U,D=M;return c(),i("div",null,[e("div",te,[O((c(),i("div",ae,[_(N,{ref_key:"uploadRef",ref:k,drag:"","on-change":V,"auto-upload":!1,"show-file-list":!1,accept:a(w)},{tip:f(()=>[re,de]),default:f(()=>[e("div",oe,[_(t,{name:"el-icon-Upload"}),W(" 拖拽文件至此，或点击"),le]),e("div",ne,"支持 "+r(a(w))+" 文件",1),e("div",ce,[_(B,{type:"primary",class:"ml-2",link:"",onClick:l[0]||(l[0]=X(()=>{},["stop"]))},{default:f(()=>[ie]),_:1})])]),_:1},8,["accept"])])),[[D,a(g)]]),a(o).length>0?(c(),i("div",_e,[e("div",pe,[e("div",ue,[(c(!0),i(C,null,I(a(o),(m,n)=>(c(),i("div",{key:n,class:Z(["fileItem flex items-center p-2 rounded-lg mt-1 hover:cursor-pointer hover:bg-page transition duration-300",{"bg-page":a(u)==n}]),onClick:h=>y(n)},[_(t,{name:"el-icon-Folder",size:16,color:"#ffc94d"}),e("div",he,r(m.name),1),e("div",ve,[_(t,{name:"el-icon-DeleteFilled",onClick:h=>q(n)},null,8,["onClick"])])],10,me))),128))])]),e("div",fe,[e("div",xe,"分段预览（"+r((b=a(o)[a(u)])==null?void 0:b.data.length)+"组）",1),e("div",ge,[_(A,{height:"100%"},{default:f(()=>{var m;return[(c(!0),i(C,null,I((m=a(o)[a(u)])==null?void 0:m.data,(n,h)=>(c(),i("div",{class:"bg-page rounded p-[10px] mt-2",key:h},[e("span",we,"#"+r(h+1),1),e("span",ke,r(a(o)[a(u)].name),1),e("div",ye,[e("div",null,"q:"+r(n.q),1),e("div",null,"a:"+r(n.a),1)])]))),128))]}),_:1})])])])):Y("",!0)])])}}});const Te=se(be,[["__scopeId","data-v-56940f2a"]]);export{Te as default};
