import{E as G,a as H}from"./el-tabs.bf76dc43.js";import{c as X,f as ee,g as te,E as ae,v as oe}from"./entry.df16adda.js";import{E as ne,a as le}from"./el-form-item.f85b8636.js";import{E as se,a as ie}from"./el-checkbox.033475fe.js";import{E as re}from"./el-select.b349f79d.js";import{_ as me}from"./index.vue.b9ae65fe.js";import{E as pe}from"./el-card.55a0e076.js";import{E as de}from"./el-scrollbar.f4d658ff.js";/* empty css                */import"./el-tag.7a8069da.js";/* empty css                 */import"./el-tooltip.4ed993c7.js";import"./el-popper.89e34564.js";import{k as ue,a as b,s as V,r as ce,E as _e,aq as fe,I as l,J as g,u as n,$ as i,a0 as a,K as f,a2 as o,Z as ve,ap as ke,ad as ye,ae as r,W as C,Y as m,e as be,n as K}from"./swiper-vue.397ea2eb.js";import{u as ge}from"./useDictOptions.e4ac7936.js";import{u as Ce,_ as xe}from"./index.vue.1307e7a7.js";import he from"./addData.4c5d2492.js";import Ee from"./resultPop.63521e4d.js";import we from"./importPop.a02f3b36.js";import{d as Te,e as Ve,g as $e}from"./split.f6195c48.js";import{k as De}from"./my_database.5da0ead6.js";import{_ as Pe}from"./tologin.vue.ee5b8f69.js";import{_ as Le}from"./_plugin-vue_export-helper.c27b6911.js";import"./strings.294b5976.js";import"./_baseClone.000a3762.js";import"./_getTag.af7a9d71.js";import"./index.6edb46f6.js";import"./isEqual.b93d80e7.js";import"./debounce.2369182b.js";import"./index.vue.403e5f16.js";import"./el-upload.397b9616.js";import"./el-progress.598034ee.js";import"./cloneDeep.8862a013.js";import"./index.34adc8c7.js";import"./el-dialog.64289190.js";import"./use-dialog.825901d5.js";import"./refs.2a024717.js";import"./fileReader.15642605.js";import"./___vite-browser-external.34bf2328.js";import"./hook.d7b4f5cd.js";import"./lodash.9425e068.js";import"./adjustDataPop.vue.72404620.js";import"./el-image-viewer.ad15677e.js";import"./throttle.92cc074e.js";import"./position.a44f3ead.js";const Re={class:"h-full"},Se={class:"px-[20px] py-[10px]"},Ke={class:"flex justify-between mt-4"},qe={class:"mt-4"},Ie={key:0,class:"text-danger text-xs"},Be={class:"flex justify-end mt-4"},Fe={key:1},Ne=ue({__name:"index",setup(Ue){const $=X(),p=b(!1),D=V(),P=V(),x=V(),u=ce({name:"",type:-1}),v=b({all:{name:"全部",id:-1},wait:{name:"等待拆分",id:0},ing:{name:"拆分中",id:1},ok:{name:"拆分成功",id:2},fail:{name:"拆分失败",id:3}}),h=b([]),q=s=>{h.value=s.map(t=>t.id)},I=async()=>{p.value=!0,await K(),D.value.open()},L=async s=>{await ee.confirm("确定要删除？"),await Te({ids:s}),k()},B=async s=>{p.value=!0,await K(),P.value.open({id:s})},E=b({}),F=s=>{var t;E.value=s,(t=x.value)==null||t.open()},N=async s=>{var t;await Ve({id:E.value.id,kb_ids:s.kb_ids}),(t=x.value)==null||t.close()},{optionsData:U}=ge({kbList:{api:De,transformData(s){return console.log(s),s}}}),{pager:c,getLists:k,resetPage:w,resetParams:j}=Ce({fetchFun:$e,params:u});return _e(()=>{k()}),(s,t)=>{const O=H,z=G,A=te,R=ne,d=ae,J=le,_=se,y=re,M=me,Q=ie,W=pe,Y=de,T=fe("perms"),Z=oe;return l(),g("div",Re,[n($).isLogin?(l(),i(Y,{key:0},{default:a(()=>[f("div",Se,[o(W,{shadow:"never",class:"!border-none"},{default:a(()=>[o(z,{modelValue:n(u).type,"onUpdate:modelValue":t[0]||(t[0]=e=>n(u).type=e),onTabChange:n(w)},{default:a(()=>[(l(!0),g(ve,null,ke(Object.keys(v.value),e=>(l(),i(O,{key:v.value[e].id,name:v.value[e].id,label:`${v.value[e].name}(${n(c).extend[e]||0})`},null,8,["name","label"]))),128))]),_:1},8,["modelValue","onTabChange"]),o(J,{ref:"formRef",class:"mb-[-16px] mt-4",model:n(u),inline:!0},{default:a(()=>[o(R,{label:"文件名"},{default:a(()=>[o(A,{modelValue:n(u).name,"onUpdate:modelValue":t[1]||(t[1]=e=>n(u).name=e),class:"!w-[280px]",placeholder:"请输入文件名关键词",clearable:"",onKeyup:ye(n(w),["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),o(R,null,{default:a(()=>[o(d,{type:"primary",onClick:n(w)},{default:a(()=>[r(" 查询 ")]),_:1},8,["onClick"]),o(d,{onClick:n(j)},{default:a(()=>[r(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"]),f("div",Ke,[o(d,{disabled:!h.value.length,onClick:t[2]||(t[2]=e=>L(h.value))},{default:a(()=>[r(" 批量删除 ")]),_:1},8,["disabled"]),o(d,{type:"primary",onClick:I},{default:a(()=>[r(" +新增拆分 ")]),_:1})]),f("div",qe,[C((l(),i(Q,{size:"large",data:n(c).lists,onSelectionChange:q},{default:a(()=>[o(_,{type:"selection",width:"55"}),o(_,{label:"文件名",prop:"name","min-width":"250"}),o(_,{label:"拆分数据",prop:"qa_count","min-width":"100"}),o(_,{label:"拆分状态","min-width":"150"},{default:a(({row:e})=>[f("div",null,[f("div",null,[e.status==2?(l(),i(y,{key:0,type:"success"},{default:a(()=>[r(" 拆分成功 ")]),_:1})):m("",!0),e.status==1?(l(),i(y,{key:1,type:"warning"},{default:a(()=>[r(" 拆分中 ")]),_:1})):m("",!0),e.status==0?(l(),i(y,{key:2,type:"warning"},{default:a(()=>[r(" 等待拆分 ")]),_:1})):m("",!0),e.status==3?(l(),i(y,{key:3,type:"danger"},{default:a(()=>[r(" 拆分失败 ")]),_:1})):m("",!0)]),e.status==3?(l(),g("div",Ie,[o(M,{teleported:"",content:`失败原因：${e.error}`},null,8,["content"])])):m("",!0)])]),_:1}),o(_,{label:"拆分时间",prop:"create_time","min-width":"150"}),o(_,{label:"操作","min-width":"230",fixed:"right"},{default:a(({row:e})=>[C((l(),i(d,{link:"",type:"primary",onClick:S=>B(e.id)},{default:a(()=>[r(" 拆分结果 ")]),_:2},1032,["onClick"])),[[T,["know.qa/results"]]]),e.status==2?C((l(),i(d,{key:0,type:"primary",link:"",onClick:S=>F(e)},{default:a(()=>[r(" 导入到数据 ")]),_:2},1032,["onClick"])),[[T,["know.qa/export"]]]):m("",!0),C((l(),i(d,{type:"danger",link:"",onClick:S=>L([e.id])},{default:a(()=>[r(" 删除 ")]),_:2},1032,["onClick"])),[[T,["know.qa/del"]]])]),_:1})]),_:1},8,["data"])),[[Z,n(c).loading]]),f("div",Be,[o(xe,{modelValue:n(c),"onUpdate:modelValue":t[3]||(t[3]=e=>be(c)?c.value=e:null),onChange:n(k)},null,8,["modelValue","onChange"])])])]),_:1})])]),_:1})):m("",!0),n($).isLogin?m("",!0):(l(),g("div",Fe,[o(Pe)])),p.value?(l(),i(he,{key:2,ref_key:"addDataPopRef",ref:D,onSuccess:t[4]||(t[4]=()=>{p.value=!1,n(k)()}),onClose:t[5]||(t[5]=e=>p.value=!1)},null,512)):m("",!0),p.value?(l(),i(Ee,{key:3,ref_key:"resultPopRef",ref:P,onClose:t[6]||(t[6]=e=>p.value=!1)},null,512)):m("",!0),o(we,{ref_key:"importToKbRef",ref:x,"kb-list":n(U).kbList,count:E.value.qa_count,onConfirm:N},null,8,["kb-list","count"])])}}});const Rt=Le(Ne,[["__scopeId","data-v-fa3e239a"]]);export{Rt as default};
