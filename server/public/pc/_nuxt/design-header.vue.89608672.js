import{_ as z}from"./index.vue.403e5f16.js";import{d as R,a as T,f as j,co as $,E as D,cp as O}from"./entry.df16adda.js";import{E as P}from"./el-page-header.84cac8c8.js";import{E as U}from"./el-image-viewer.ad15677e.js";import{_ as H}from"./nuxt-link.ee69c354.js";import{E as J}from"./el-dialog.64289190.js";import{u as y}from"./useLockFn.a803ddfa.js";import{u as K}from"./canvas.17c19c8a.js";import{k as Y,a as C,b as Z,j as A,I as i,J as c,a2 as s,a0 as l,K as o,ae as m,a4 as G,u as t,Z as x,Y as _,$ as M,e as Q}from"./swiper-vue.397ea2eb.js";const W={class:"bg-primary h-[60px] flex items-center text-white px-main"},X={class:"text-white text-base"},ee={class:"text-white"},te={class:"ml-auto"},oe={class:"flex flex-col items-center justify-center"},se={class:"w-[400px] h-[200px] relative text-white rounded-lg overflow-hidden"},ae={class:"loading absolute z-10 bg-[rgba(0,0,0,0.5)] inset-0 flex flex-col justify-center items-center"},ne=o("div",{class:"mt-[10px] text-lg"},"视频生成中",-1),ie=o("div",{class:"mt-[10px] text-lg"},"视频合成成功",-1),ce=o("div",{class:"mt-[10px] text-lg"},"视频合成失败",-1),le={class:"my-[20px] flex items-center"},re=o("span",{class:"cursor-pointer text-primary"}," 视频合成 ",-1),ke=Y({__name:"design-header",setup(de){const e=K(),f=R(),h=T(),n=C(!1),r=C(-1),w=()=>{f.push("/digital_human/aside/video_compositing")},{isLock:b,lockFn:E}=y(async()=>{await e.savaOrComposite(),f.replace({path:"",query:{...h.query,id:e.id}})}),{isLock:V,lockFn:L}=y(async()=>{await e.putImgCover(),await e.savaOrComposite(2),await v(),n.value=!0});let d=null;const v=async()=>{const{status:a}=await O({id:e.id});r.value=a,a==2&&(d=setTimeout(()=>{v()},30*1e3))};Z(n,a=>{console.log(a),a||d&&clearTimeout(d)}),A(()=>{d&&clearTimeout(d)});const S=async()=>{const{value:a}=await j.prompt("修改视频名称","",{inputValue:e.name});e.id&&await $({name:a,id:e.id}),e.name=a},B=()=>{e.voiceContent.text="",e.voiceContent.voice_url="",n.value=!1,e.id=void 0,f.replace({path:"",query:{...h.query,id:void 0}})};return(a,u)=>{const p=z,g=D,F=P,N=U,I=H,q=J;return i(),c("div",W,[s(F,{onBack:w},{content:l(()=>[o("span",X,[m(G(t(e).name)+" ",1),s(g,{link:"",text:"",onClick:S},{default:l(()=>[o("span",ee,[s(p,{name:"el-icon-EditPen"})])]),_:1})])]),_:1}),o("div",te,[s(g,{plain:"",style:{"--el-button-bg-color":"transparent","--el-button-text-color":"#fff"},loading:t(b),onClick:t(E)},{default:l(()=>[m(" 存为草稿 ")]),_:1},8,["loading","onClick"]),s(g,{onClick:t(L),loading:t(V)},{default:l(()=>[m(" 合成视频 ")]),_:1},8,["onClick","loading"])]),s(q,{modelValue:t(n),"onUpdate:modelValue":u[1]||(u[1]=k=>Q(n)?n.value=k:null),title:"视频生成",width:"500px","close-on-click-modal":!1,"show-close":!1},{default:l(()=>[o("div",oe,[o("div",se,[o("div",ae,[t(r)==2?(i(),c(x,{key:0},[s(p,{class:"el-icon is-loading",size:30,name:"el-icon-Loading"}),ne],64)):_("",!0),t(r)==3?(i(),c(x,{key:1},[s(p,{size:30,name:"el-icon-SuccessFilled"}),ie],64)):_("",!0),t(r)==4?(i(),c(x,{key:2},[s(p,{size:30,name:"el-icon-CircleCloseFilled"}),ce],64)):_("",!0)]),t(e).cover?(i(),M(N,{key:0,class:"w-full h-full",src:t(e).cover,fit:"contain"},null,8,["src"])):_("",!0)]),o("div",le,[m(" 可在前往 "),s(I,{to:"/digital_human/aside/video_compositing",replace:!0},{default:l(()=>[re]),_:1}),m(" 处查看 ，或留在当前页面 "),t(r)==4?(i(),c("span",{key:0,class:"cursor-pointer text-primary",onClick:u[0]||(u[0]=k=>n.value=!1)}," 重新合成视频 ")):(i(),c("span",{key:1,class:"cursor-pointer text-primary",onClick:B}," 继续创作 "))])])]),_:1},8,["modelValue"])])}}});export{ke as _};
