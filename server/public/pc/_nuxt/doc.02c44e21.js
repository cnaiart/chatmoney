import{_ as j}from"./index.vue.403e5f16.js";import{E as J}from"./el-upload.397b9616.js";import{E as K}from"./el-popper.89e34564.js";import{i as M,f as O,g as P,E as Q,v as W}from"./entry.df16adda.js";import{E as Y}from"./el-scrollbar.f4d658ff.js";import"./el-progress.598034ee.js";import"./el-tooltip.4ed993c7.js";import{s as Z,r as I,a as G,b as H}from"./fileReader.15642605.js";import{isSameFile as X}from"./hook.d7b4f5cd.js";import{k as ee,a as h,s as te,I as i,J as d,W as oe,u as s,a2 as l,a0 as g,K as t,ae as V,a4 as _,Z as F,ap as S,e as se,Y as ae,_ as le,an as ne,ao as ce}from"./swiper-vue.397ea2eb.js";import{_ as ie}from"./_plugin-vue_export-helper.c27b6911.js";import"./cloneDeep.8862a013.js";import"./_baseClone.000a3762.js";import"./_getTag.af7a9d71.js";import"./isEqual.b93d80e7.js";import"./___vite-browser-external.34bf2328.js";const D=m=>(ne("data-v-0c4754e8"),m=m(),ce(),m),de={class:"h-full flex flex-col min-h-0"},re={class:"py-[16px]"},pe={class:"el-upload__text"},_e=D(()=>t("em",null," 选择文件 ",-1)),me={class:"el-upload__text"},ue={key:0,class:"grid grid-cols-2 gap-4 flex-1 min-h-[500px]"},fe={style:{"border-right":"1px solid #eeeeee"}},he={class:"mt-4 max-w-[500px]"},ve=["onClick"],xe={class:"ml-2"},ge={class:"closeIcon ml-auto opacity-0 transition duration-300 flex items-center"},we={class:"mt-4"},ke={class:"flex"},ye=D(()=>t("div",null,"分段长度",-1)),be={class:"mt-2"},Ce={class:"flex flex-col"},Ee={class:"text-lg"},Ie={class:"flex-auto mt-2 h-[100px]"},Ve={class:"bg-white px-4 rounded"},Fe={class:"ml-2 text-[#000]"},Se={class:"mt-2"},De=ee({__name:"doc",props:{modelValue:{}},emits:["update:modelValue"],setup(m,{expose:L,emit:B}){const n=M(m,"modelValue",B),k=[".txt",".docx",".pdf",".md"].join(", "),c=h([]),y=te(),w=h(!1),u=h(-1);h("");const v=h(512),N=async({raw:e})=>{var a;try{if(e){w.value=!0,await X(e,c.value);const o=await R(e);if(!o)throw"解析结果为空，已自动忽略";n.value.push({name:e.name,path:"",data:[]}),e.data=o,c.value.push(e),C(c.value.length-1),b()}}catch(o){O.msgError(o)}finally{w.value=!1,(a=y.value)==null||a.clearFiles()}},b=()=>{n.value.forEach(e=>{e.data=[];const a=c.value.findIndex(f=>f.name==e.name);Z(c.value[a].data,v.value).forEach(f=>{e.data.push({q:f,a:""})})})},R=async e=>{const a=e.name.substring(e.name.lastIndexOf(".")+1);let o="";switch(a){case"md":case"txt":o=await I(e);break;case"pdf":o=await H(e);break;case"doc":case"docx":o=await G(e);break;default:o=await I(e);break}return o},T=e=>{n.value.splice(e,1),c.value.splice(e,1)},C=e=>{u.value=e};return L({clearFiles:()=>{c.value=[]}}),(e,a)=>{var E;const o=j,f=J,U=K,$=P,q=Q,z=Y,A=W;return i(),d("div",de,[oe((i(),d("div",re,[l(f,{ref_key:"uploadRef",ref:y,drag:"","on-change":N,"auto-upload":!1,"show-file-list":!1,accept:s(k)},{default:g(()=>[t("div",pe,[l(o,{name:"el-icon-Upload"}),V(" 拖拽文件至此，或点击"),_e]),t("div",me,"支持 "+_(s(k))+" 文件",1)]),_:1},8,["accept"])])),[[A,s(w)]]),s(n).length>0?(i(),d("div",ue,[t("div",fe,[t("div",he,[(i(!0),d(F,null,S(s(n),(r,p)=>(i(),d("div",{key:p,class:le(["fileItem flex items-center p-2 rounded-lg mt-1 hover:cursor-pointer hover:bg-page transition duration-300",{"bg-page":s(u)==p}]),onClick:x=>C(p)},[l(o,{name:"el-icon-Folder",size:16,color:"#ffc94d"}),t("div",xe,_(r.name),1),t("div",ge,[l(o,{name:"el-icon-DeleteFilled",onClick:x=>T(p)},null,8,["onClick"])])],10,ve))),128))]),t("div",we,[t("div",ke,[ye,l(U,{content:"按结束符号进行分段。我们建议您的文档应合理的使用标点符号，以确保每个完整的句子长度不要超过该值中文文档建议400~1000英文文档建议600~1200",placement:"top"},{default:g(()=>[t("span",null,[l(o,{name:"el-icon-QuestionFilled"})])]),_:1})]),l($,{class:"mt-2 !w-[300px]",modelValue:s(v),"onUpdate:modelValue":a[0]||(a[0]=r=>se(v)?v.value=r:null)},null,8,["modelValue"]),t("div",be,[l(q,{type:"primary",onClick:b},{default:g(()=>[V("重新预览")]),_:1})])])]),t("div",Ce,[t("div",Ee," 分段预览（"+_((E=s(n)[s(u)])==null?void 0:E.data.length)+"组） ",1),t("div",Ie,[l(z,{height:"100%"},{default:g(()=>{var r;return[(i(!0),d(F,null,S((r=s(n)[s(u)])==null?void 0:r.data,(p,x)=>(i(),d("div",{class:"bg-page rounded p-[10px] mt-2",key:x},[t("span",Ve,"#"+_(x+1),1),t("span",Fe,_(s(n)[s(u)].name),1),t("div",Se,_(p.q),1)]))),128))]}),_:1})])])])):ae("",!0)])}}});const Ze=ie(De,[["__scopeId","data-v-0c4754e8"]]);export{Ze as default};
