import{E as A}from"./el-upload.397b9616.js";import{E as D}from"./el-progress.598034ee.js";import{E as J}from"./el-dialog.64289190.js";import{f as V,cb as K}from"./entry.df16adda.js";import{k as T,a as u,s as Y,l as Z,b as z,I as p,J as v,a2 as h,ax as G,ap as k,a0 as _,S as H,T as S,u as n,e as w,$ as M,K as f,Z as Q,a4 as W,Y as X}from"./swiper-vue.397ea2eb.js";import{_ as ee}from"./_plugin-vue_export-helper.c27b6911.js";const te={class:"upload"},le={class:"file-list p-4"},ae={class:"flex-1"},se=["src"],oe=T({__name:"index",props:{files:{type:Array,default:()=>[]},type:{type:String,default:"image"},multiple:{type:Boolean,default:!0},limit:{type:Number,default:10},data:{type:Object,default:()=>({})},name:{type:String,default:"file"},header:{type:Object,default:()=>({})},showFileList:{type:Boolean,default:!1}},emits:["end","start","change","error","success","update:files"],setup(d,{emit:B}){const a=d,y=u(""),c=u(!1),C=e=>{y.value=e.url,c.value=!0},g=u(!1),r=B,b=Y(),i=u(!1),l=u([]),F=()=>{i.value=!0},x=e=>{r("change",e),l.value.length==0&&(g.value=!1,r("end"))},I=(e,t)=>{r("success",e),r("update:files",[...a.files,{url:e.uri,name:e.name}]);const s=l.value.indexOf(t);!a.showFileList&&l.value.splice(s,1),x(t)},L=e=>{const t=l.value.indexOf(e),s=a.files;s.splice(t,1),r("update:files",[...s])},P=(e,t)=>{var s;V.msgError(`${t.name}文件上传失败`),(s=b.value)==null||s.abort(t),i.value=!1,r("error",t),x(t)},R=()=>{V.msgError(`超出上传上限${a.limit}，请重新上传`)},U=()=>{l.value=[],i.value=!1},$=Z(()=>{switch(a.type){case"image":return".jpg,.png,.gif,.jpeg";case"video":return".wmv,.avi,.mpg,.mpeg,.3gp,.mov,.mp4,.flv,.rmvb,.mkv";case"audio":return;default:return"*"}}),j=e=>K(a.type,{file:e.file,name:a.name,header:a.header,data:a.data}),N=e=>{g.value=!0,r("start",e)};return z(()=>a.files,e=>{!l.value.length&&(e!=null&&e.length)&&(l.value=[...e])},{immediate:!0}),(e,t)=>{const s=A,O=D,E=J;return p(),v("div",te,[h(s,S({ref_key:"uploadRefs",ref:b,"file-list":n(l),"onUpdate:fileList":t[0]||(t[0]=o=>w(l)?l.value=o:null)},e.$attrs,{multiple:d.multiple,limit:d.limit,"show-file-list":d.showFileList,"on-progress":F,"on-success":I,"on-exceed":R,"on-error":P,accept:n($),"on-remove":L,"http-request":j,"before-upload":N,"on-preview":C}),G({_:2},[k(e.$slots,(o,m)=>({name:m,fn:_(q=>[H(e.$slots,m,S(q,{loading:n(g)}),void 0,!0)])}))]),1040,["file-list","multiple","limit","show-file-list","accept"]),!d.showFileList&&n(l).length?(p(),M(E,{key:0,modelValue:n(i),"onUpdate:modelValue":t[1]||(t[1]=o=>w(i)?i.value=o:null),title:"上传进度","close-on-click-modal":!1,width:"500px",modal:!1,onClose:U},{default:_(()=>[f("div",le,[(p(!0),v(Q,null,k(n(l),(o,m)=>(p(),v("div",{key:m,class:"mb-5"},[f("div",null,W(o.name),1),f("div",ae,[h(O,{percentage:parseInt(String(o.percentage))},null,8,["percentage"])])]))),128))])]),_:1},8,["modelValue"])):X("",!0),h(E,{modelValue:n(c),"onUpdate:modelValue":t[2]||(t[2]=o=>w(c)?c.value=o:null),width:"50vw"},{default:_(()=>[f("img",{"w-full":"",src:n(y),alt:"Preview Image"},null,8,se)]),_:1},8,["modelValue"])])}}});const me=ee(oe,[["__scopeId","data-v-1e31db6a"]]);export{me as _};
